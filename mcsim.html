<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GNU MCSim User&rsquo;s Manual</title>

<meta name="description" content="GNU MCSim User&rsquo;s Manual">
<meta name="keywords" content="GNU MCSim User&rsquo;s Manual">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="#Top" rel="start" title="Top">
<link href="#Concept-Index" rel="index" title="Concept Index">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Dir.html#Top" rel="up" title="(Dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">GNU MCSim User&rsquo;s Manual</h1>






<a name="Top"></a>
<div class="header">
<p>
Next: <a href="#Table-of-Contents" accesskey="n" rel="next">Table of Contents</a>, Previous: <a href="Dir.html#Top" accesskey="p" rel="prev">(Dir)</a>, Up: <a href="Dir.html#Top" accesskey="u" rel="up">(Dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<h1 class="node-heading">Top</h1>


<p>GNU MCSim manual, version 6.2.0
</p>
<p><em>GNU MCSim</em> is a general purpose modeling and simulation program
which can performs &quot;standard&quot; or &quot;Markov chain&quot; Monte Carlo
simulations. It allows you to specify a set of linear or nonlinear
algebraic equations or ordinary differential equations. They are
solved numerically using parameter values you choose or parameter
values sampled from statistical distributions. Simulation outputs can
be compared to experimental data for Bayesian parameter estimation
(model calibration).
</p>

<table class="menu" border="0" cellspacing="0">
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Table-of-Contents" accesskey="1">Table of Contents</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Reference Manual
</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Licenses" accesskey="2">Licenses</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">GNU MCSim is under GNU General Public License
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Overview" accesskey="3">Overview</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">the gist of it
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Installation" accesskey="4">Installation</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">for GNU/Linux, Unix and other platforms
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Working-Through-an-Example" accesskey="5">Working Through an Example</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">highly recommended!
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Writing-and-Compiling-Structural-Models" accesskey="6">Writing and Compiling Structural Models</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">syntax and compilation of models
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Running-Simulations" accesskey="7">Running Simulations</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">syntax of simulation specification files
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Common-Pitfalls" accesskey="8">Common Pitfalls</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">errors you will make one day or the other...
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#XMCSim" accesskey="9">XMCSim</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a graphical user&rsquo;s interface to GNU MCSim
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Bibliographic-References">Bibliographic References</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">examples of applications
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Appendices
</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Keywords-List">Keywords List</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a list of the reserved keywords
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Examples">Examples</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">examples of models and input files
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Index Table
</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Concept-Index">Concept Index</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="Table-of-Contents"></a>
<div class="header">
<p>
Next: <a href="#Licenses" accesskey="n" rel="next">Licenses</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<h4 class="node-heading">Table of Contents</h4>

<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">
<ul class="no-bullet">
<li><a name="toc-Software-and-Documentation-Licenses" href="#Licenses">1 Software and Documentation Licenses</a>
<ul class="no-bullet">
  <li><a name="toc-Software-license" href="#Software-license">1.1 Software license</a></li>
  <li><a name="toc-Documentation-license" href="#Documentation-license">1.2 Documentation license</a></li>
</ul></li>
<li><a name="toc-Overview-1" href="#Overview">2 Overview</a>
<ul class="no-bullet">
  <li><a name="toc-General-procedure" href="#General-procedure">2.1 General procedure</a></li>
  <li><a name="toc-Types-of-simulations" href="#Types-of-simulations">2.2 Types of simulations</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-5_002e4_002e0" href="#Major-changes-introduced-with-version-5_002e4_002e0">2.3 Major changes introduced with version 5.4.0</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-5_002e5_002e0" href="#Major-changes-introduced-with-version-5_002e5_002e0">2.4 Major changes introduced with version 5.5.0</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-5_002e6_002e0" href="#Major-changes-introduced-with-version-5_002e6_002e0">2.5 Major changes introduced with version 5.6.0</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-6_002e0_002e0" href="#Major-changes-introduced-with-version-6_002e0_002e0">2.6 Major changes introduced with version 6.0.0</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-6_002e1_002e0" href="#Major-changes-introduced-with-version-6_002e1_002e0">2.7 Major changes introduced with version 6.1.0</a></li>
  <li><a name="toc-Major-changes-introduced-with-version-6_002e2_002e0" href="#Major-changes-introduced-with-version-6_002e2_002e0">2.8 Major changes introduced with version 6.2.0</a></li>
</ul></li>
<li><a name="toc-Installation-1" href="#Installation">3 Installation</a>
<ul class="no-bullet">
  <li><a name="toc-System-requirements" href="#System-requirements">3.1 System requirements</a></li>
  <li><a name="toc-Distribution" href="#Distribution">3.2 Distribution</a></li>
  <li><a name="toc-Machine_002dspecific-installation" href="#Machine_002dspecific-installation">3.3 Machine-specific installation</a>
  <ul class="no-bullet">
    <li><a name="toc-Unix-and-GNU_002fLinux-operating-systems" href="#Unix-and-GNU_002fLinux-operating-systems">3.3.1 Unix and GNU/Linux operating systems</a></li>
    <li><a name="toc-Other-operating-systems" href="#Other-operating-systems">3.3.2 Other operating systems</a></li>
  </ul></li>
</ul></li>
<li><a name="toc-Working-Through-an-Example-1" href="#Working-Through-an-Example">4 Working Through an Example</a></li>
<li><a name="toc-Writing-and-Compiling-Structural-Models-1" href="#Writing-and-Compiling-Structural-Models">5 Writing and Compiling Structural Models</a>
<ul class="no-bullet">
  <li><a name="toc-Using-mod-to-preprocess-model-description-files" href="#Using-mod">5.1 Using <code>mod</code> to preprocess model description files</a></li>
  <li><a name="toc-Using-makemcsim-to-preprocess-and-compile-model-files" href="#Using-makemcsim">5.2 Using <code>makemcsim</code> to preprocess and compile model files</a></li>
  <li><a name="toc-Syntax-of-the-model-description-file" href="#Syntax-of-mod-files">5.3 Syntax of the model description file</a>
  <ul class="no-bullet">
    <li><a name="toc-General-syntax-1" href="#General-syntax">5.3.1 General syntax</a></li>
    <li><a name="toc-Declarations-of-global-variables-1" href="#Declarations-of-global-variables">5.3.2 Declarations of global variables</a></li>
    <li><a name="toc-Model-types-1" href="#Model-types">5.3.3 Model types</a></li>
    <li><a name="toc-Special-functions-1" href="#Special-functions">5.3.4 Special functions</a></li>
    <li><a name="toc-Input-functions-1" href="#Input-functions">5.3.5 Input functions</a></li>
    <li><a name="toc-In-line-functions-1" href="#In-line-functions">5.3.6 In line functions</a></li>
    <li><a name="toc-Model-initialization-1" href="#Model-initialization">5.3.7 Model initialization</a></li>
    <li><a name="toc-Dynamics-section-1" href="#Dynamics-section">5.3.8 Dynamics section</a></li>
    <li><a name="toc-Delay-differential-equations" href="#Delay-differentials">5.3.9 Delay differential equations</a></li>
    <li><a name="toc-Output-calculations-1" href="#Output-calculations">5.3.10 Output calculations</a></li>
    <li><a name="toc-Comments-on-style-1" href="#Comments-on-style">5.3.11 Comments on style</a></li>
  </ul></li>
  <li><a name="toc-Reading-SBML-models-and-applying-a-template" href="#Reading-SBML-models">5.4 Reading SBML models and applying a template</a></li>
  <li><a name="toc-Working-with-the-R-package-deSolve" href="#Working-with-deSolve">5.5 Working with the <em>R</em> package <em>deSolve</em></a></li>
</ul></li>
<li><a name="toc-Running-Simulations-1" href="#Running-Simulations">6 Running Simulations</a>
<ul class="no-bullet">
  <li><a name="toc-Using-the-compiled-program-1" href="#Using-the-compiled-program">6.1 Using the compiled program</a></li>
  <li><a name="toc-Syntax-of-the-simulation-definition-file" href="#Syntax-of-simulation-files">6.2 Syntax of the simulation definition file</a>
  <ul class="no-bullet">
    <li><a name="toc-General-input-file-syntax-1" href="#General-input-file-syntax">6.2.1 General input file syntax</a></li>
    <li><a name="toc-Input-functions-_0028revisited_0029" href="#Input-functions-revisited">6.2.2 Input functions (revisited)</a></li>
    <li><a name="toc-Global-specifications-1" href="#Global-specifications">6.2.3 Global specifications</a>
    <ul class="no-bullet">
      <li><a name="toc-OutputFile_0028_0029-specification-1" href="#OutputFile_0028_0029-specification"><code>OutputFile()</code> specification</a></li>
      <li><a name="toc-Integrate_0028_0029-specification-1" href="#Integrate_0028_0029-specification"><code>Integrate()</code> specification</a></li>
      <li><a name="toc-MonteCarlo_0028_0029-specification-1" href="#MonteCarlo_0028_0029-specification"><code>MonteCarlo()</code> specification</a></li>
      <li><a name="toc-MCMC_0028_0029-specification-1" href="#MCMC_0028_0029-specification"><code>MCMC()</code> specification</a></li>
      <li><a name="toc-SetPoints_0028_0029-specification-1" href="#SetPoints_0028_0029-specification"><code>SetPoints()</code> specification</a></li>
      <li><a name="toc-OptimalDesign_0028_0029-specification-1" href="#OptimalDesign_0028_0029-specification"><code>OptimalDesign()</code> specification</a></li>
      <li><a name="toc-Distrib_0028_0029-specification-1" href="#Distrib_0028_0029-specification"><code>Distrib()</code> specification</a></li>
      <li><a name="toc-SimType_0028_0029-specification-1" href="#SimType_0028_0029-specification"><code>SimType()</code> specification</a></li>
    </ul></li>
    <li><a name="toc-Specifying-basic-conditions-to-simulate-1" href="#Specifying-basic-conditions-to-simulate">6.2.4 Specifying basic conditions to simulate</a>
    <ul class="no-bullet">
      <li><a name="toc-Simulation-sections-1" href="#Simulation-sections"><code>Simulation</code> sections</a></li>
      <li><a name="toc-Events_0028_0029-specification-for-state-discontinuities" href="#Events_0028_0029-specification"><code>Events()</code> specification for state discontinuities</a></li>
      <li><a name="toc-StartTime_0028_0029-specification-1" href="#StartTime_0028_0029-specification"><code>StartTime()</code> specification</a></li>
      <li><a name="toc-Print_0028_0029-specification-1" href="#Print_0028_0029-specification"><code>Print()</code> specification</a></li>
      <li><a name="toc-PrintStep_0028_0029-specification-1" href="#PrintStep_0028_0029-specification"><code>PrintStep()</code> specification</a></li>
    </ul></li>
    <li><a name="toc-Setting_002dup-statistical-models-1" href="#Setting_002dup-statistical-models">6.2.5 Setting-up statistical models</a>
    <ul class="no-bullet">
      <li><a name="toc-Level-sections-1" href="#Level-sections"><code>Level</code> sections</a></li>
      <li><a name="toc-Data_0028_0029-specification-1" href="#Data_0028_0029-specification"><code>Data()</code> specification</a></li>
    </ul></li>
  </ul></li>
  <li><a name="toc-Analyzing-simulation-output-1" href="#Analyzing-simulation-output">6.3 Analyzing simulation output</a></li>
  <li><a name="toc-Error-handling-1" href="#Error-handling">6.4 Error handling</a></li>
</ul></li>
<li><a name="toc-Common-Pitfalls-1" href="#Common-Pitfalls">7 Common Pitfalls</a></li>
<li><a name="toc-XMCSim-1" href="#XMCSim">8 XMCSim</a></li>
<li><a name="toc-Bibliographic-References-1" href="#Bibliographic-References">Bibliographic References</a></li>
<li><a name="toc-Keywords-List-1" href="#Keywords-List">Appendix A Keywords List</a></li>
<li><a name="toc-Examples-1" href="#Examples">Appendix B Examples</a>
<ul class="no-bullet">
  <li><a name="toc-linear_002emodel-1" href="#linear_002emodel">B.1 <samp>linear.model</samp></a></li>
  <li><a name="toc-1cpt_002emodel_003a-A-example-model-description-file" href="#g_t1cpt_002emodel">B.2 <samp>1cpt.model</samp>: A example model description file</a></li>
  <li><a name="toc-perc_002emodel_003a-A-example-model-description-file" href="#perc_002emodel">B.3 <samp>perc.model</samp>: A example model description file</a></li>
  <li><a name="toc-perc_002elsodes_002ein-1" href="#perc_002elsodes_002ein">B.4 <samp>perc.lsodes.in</samp></a></li>
</ul></li>
<li><a name="toc-Concept-Index-1" href="#Concept-Index">Concept Index</a></li>

</ul>
</div>




<hr>
<a name="Licenses"></a>
<div class="header">
<p>
Next: <a href="#Overview" accesskey="n" rel="next">Overview</a>, Previous: <a href="#Table-of-Contents" accesskey="p" rel="prev">Table of Contents</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Software-and-Documentation-Licenses"></a>
<h2 class="chapter">1 Software and Documentation Licenses</h2>
<a name="index-Software-license"></a>
<a name="index-Documentation-license"></a>
<a name="index-Licenses"></a>


<a name="Software-license"></a>
<h3 class="section">1.1 Software license</h3>

<p>GNU MCSim is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 3 of the License, or (at your
option) any later version. This program is distributed in the hope
that it will be useful, but WITHOUT ANY WARRANTY; without even the
implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE. See the GNU General Public License for more details.
</p>

<a name="Documentation-license"></a>
<h3 class="section">1.2 Documentation license</h3>

<br>
<div align="center"><b>The GNU Free Documentation License</b>
</div>
<p>Version 1.2, November 2002
</p>
<div class="display">
<pre class="display">Copyright &copy; 2000,2001,2002 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

</pre></div>

<ol start="0">
<li> PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em>free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li> APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
<small>ASCII</small> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the
Title&rdquo; of such a section when you modify the Document means that it
remains a section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li> VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li> COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li> MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol type="A" start="1">
<li> Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li> List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li> State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li> Preserve all the copyright notices of the Document.

</li><li> Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li> Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li> Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li> Include an unaltered copy of this License.

</li><li> Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li> Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li> For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;,
Preserve the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li> Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li> Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li> Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li> Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li> COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled
&ldquo;Acknowledgements&rdquo;, and any sections Entitled &ldquo;Dedications&rdquo;.  You
must delete all sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li> COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li> AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li> TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li> TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.
</p>
</li><li> FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
</p></li></ol>



<hr>
<a name="Overview"></a>
<div class="header">
<p>
Next: <a href="#Installation" accesskey="n" rel="next">Installation</a>, Previous: <a href="#Licenses" accesskey="p" rel="prev">Licenses</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Overview-1"></a>
<h2 class="chapter">2 Overview</h2>
<a name="index-Overview"></a>


<p><em>GNU MCSim</em> is a simulation and statistical inference tool for
algebraic or differential equation systems. Other programs, such as
<em>GNU Octave</em>, have been created to the same end. Still, most
available tools are not optimal for performing computer intensive and
sophisticated Monte Carlo analyses. <em>GNU MCSim</em> was created
specifically to this end: to perform Monte Carlo analyses in an
optimized, and easy to maintain environment. The software consists in
two pieces, a model generator and a simulation engine:
</p>
<p>- The model generator, &quot;<em>mod</em>&quot;, was created to facilitate
structural model definition and maintenance, while keeping execution
time short. You code your model using a simplified syntax and
<code>mod</code> translates it in C.
</p>
<p>- The simulation engine is a set of routines which are linked to your
model during compilation to produce executable code. After that you
can run simulations of your model under a variety of conditions,
specify an associated statistical model, and perform
simulations.
</p>

<a name="General-procedure"></a>
<h3 class="section">2.1 General procedure</h3>

<p>Model building and simulation proceeds in four stages:
</p>
<ol>
<li> You create with any text editor (<i>e.g.</i>, <code>emacs</code>) a model
description file. The reference section on <code>mod</code>, later in this
manual gives you the syntax to use (see <a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a>). This syntax allows you to describe the model variables,
parameters, equations, inputs and outputs in a C-like fashion without
having you to actually know how to write a C program.

</li><li> You instruct the model generator, <code>mod</code>, to preprocess your
structural model description file. <code>Mod</code> creates a C file, called
<samp>model.c</samp>.

</li><li> You compile and link the newly created <samp>model.c</samp> file together
with a library containing the other C routines (or with the other C
files of the <samp>mcsim/sim</samp> directory). <em>GNU MCSim</em> C code is
standard, so you should be able to compile it with any standard C
compiler, for example GNU <code>gcc</code>. After compiling and linking, an
executable simulation program is created, specific of your particular
model. These preprocessing and compilation steps can be performed in
Unix with a single shell command <code>makemcsim</code> (in which case, the
<samp>model.c</samp> is created only temporarily and erased afterward). This
produces the most efficient code for your particular machine.

</li><li> You then write any number of simulation specification files and run
them with the compiled <code>mcsim</code> program. These simulation files
describe the kind of simulation to run (simple simulations, Monte
Carlo etc.), various settings for the integration algorithm if needed,
and a description of one or several simulation conditions (eventually
with a statistical model and data to fit) (see <a href="#Running-Simulations">Running Simulations</a>). The simulation output is written to standard ASCII
files.
</li></ol>

<p>Little or no knowledge of computer programming is required, unless you
want to tailor the program to special needs, beyond what is described
in this manual (in which case you may want to contact us).
</p>
<p>Under Unix, a graphical user interface written in Tcl/Tk, <em>XMCSim</em>
(called by the command <code>xmcsim</code>), is also provided. This
menu-driven interface automatizes the compilation and running tasks. It
also offers a convenient interface to 2-D and 3-D plotting of the
simulation results.
</p>

<a name="Types-of-simulations"></a>
<h3 class="section">2.2 Types of simulations</h3>

<p>Five types of simulations are available:
</p>
<ul>
<li> <a name="index-Default"></a>
A simple simulation will solve (eventually integrate) the equations you
specified, using the default parameter values eventually overridden in
the simulation specification file. User-requested outputs are sent to
an output file of your choice.

</li><li> <a name="index-Monte-Carlo-simulations"></a>
&quot;<em>Monte Carlo</em>&quot; simulations will perform repeated (stochastic)
simulations across a randomly sampled region of the model parameter
space (see <a href="#MonteCarlo_0028_0029-specification">MonteCarlo() specification</a>).

</li><li> <a name="index-MCMC-simulations"></a>
<a name="index-Markov_002dchain-Monte-Carlo-simulations"></a>
A Markov-chain Monte Carlo (<em>MCMC</em>) simulation performs a series of
simulations along a Markov chain in the model parameter space
(see <a href="#MCMC_0028_0029-specification">MCMC() specification</a>). In MCMC simulations the random choice of
a new parameter value is influenced by the current value. They can be
used to obtain the Bayesian posterior distribution of the model
parameters, given a statistical model, prior parameter distributions
(that you need to specify) and data for which a likelihood function can
be computed. The program handles hierarchical (<i>e.g.</i>, random effects
and mixed effects) statistical models (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).

</li><li> <a name="index-SetPoints-simulations"></a>
A &quot;<em>SetPoints</em>&quot; simulation solves the model for a series of
specified parameter sets, listed in a separate ASCII file
(see <a href="#SetPoints_0028_0029-specification">SetPoints() specification</a>). You can create these parameter
sets yourself (on a regular grid, for example) or use the output of a
previous Monte Carlo or MCMC simulation.

</li><li> <a name="index-Experimental-design-optimization"></a>
An &quot;<em>OptimalDesign</em>&quot; procedure optimizes the number and location
of observation times for experimental conditions, in order to minimize
the variance of a parameter or an output you specify, given a
structural model, a statistical model, and prior distributions for
their parameters (see <a href="#OptimalDesign_0028_0029-specification">OptimalDesign() specification</a>).

</li></ul>


<a name="Major-changes-introduced-with-version-5_002e4_002e0"></a>
<h3 class="section">2.3 Major changes introduced with version 5.4.0</h3>
<a name="index-Major-changes-in-version-5_002e4_002e0"></a>

<ul>
<li> GNU MCSim is now distributed under version 3 of the GNU General Public
License.

</li><li> The installation scripts have been rewritten using GNU
<code>autoconf</code>, <code>automake</code> and <code>libtool</code>. This
<em>should</em> make <em>GNU MCSim</em> easier to install and more
portable.

</li><li> Systems Biology Markup Language (SBML) models are read by libSBML
if it is installed.

</li><li> Tempered MCMC (useful for hard, multimodal posterior densities, for
rapid and guaranteed convergence, and for model choice) and stochastic
optimizations are offered as options of the <code>MCMC()</code>
specification.

</li></ul>


<a name="Major-changes-introduced-with-version-5_002e5_002e0"></a>
<h3 class="section">2.4 Major changes introduced with version 5.5.0</h3>
<a name="index-Major-changes-in-version-5_002e5_002e0"></a>

<ul>
<li> The installation scripts have been regenerated using GNU
<code>autoconf</code> version 2.69 which fixes a potential security problem in the
installation.

</li><li> The <code>mod</code> utility can now generate C model files suitable for use
with the R package <code>deSolve</code>. Use <code>mod -R</code> for that.

</li></ul>


<a name="Major-changes-introduced-with-version-5_002e6_002e0"></a>
<h3 class="section">2.5 Major changes introduced with version 5.6.0</h3>
<a name="index-Major-changes-in-version-5_002e6_002e0"></a>

<ul>
<li> The keyword <code>End</code> is now mandatory at the end of every
model. This is not backward compatible (you will need to modify your
older models accordingly).

</li><li> The <code>StartTime()</code> specification can now accept a symbolic
parameter. That allows you to treat the initial time as a random
variable in error-in-variable problems (when the initial time is an
unknown).

</li><li> The <code>PrintStep()</code> specification can read a list of variables to
print (as <code>Print()</code> does).

</li><li> In MCMC simulation, the jump kernel is now output in a file with the
<var>.kernel</var> extension. If the simulations are restarted in a
continuation mode and if a kernel file with the same name as the restart
file (with an added <var>.kernel</var> extension) is present, the jump kernel
will restored to its saved value.

</li><li> Delay differential equations can now be coded and solved using the
<code>CalDelay</code> function.

</li><li> Discontinuities in state variables can now be forced to happen at
predefined times through the <code>Events()</code> specification.

</li></ul>


<a name="Major-changes-introduced-with-version-6_002e0_002e0"></a>
<h3 class="section">2.6 Major changes introduced with version 6.0.0</h3>
<a name="index-Major-changes-in-version-6_002e0_002e0"></a>

<p>In <code>mod</code>:
</p>
<ul>
<li> You can now specify the Jacobian matrix of the model&rsquo;s
derivatives with respect to state variables in a <code>Jacobian</code>
section. It will then be used by the <code>Lsodes</code> integrator instead
of numerical differentiation, see <a href="#Syntax-of-mod-files">Syntax of mod files</a>.

</li><li> The standard C function <code>fmax</code> and <code>fmin</code> can be
used in your models, see <a href="#Standard-functions">Standard functions</a>.

</li></ul>

<p>In <code>sim</code>:
</p>
<ul>
<li> The vector notation (see <a href="#Vectors">Vectors</a>) can now be used in
input simulation files.

</li><li> If you use the GNU Scientific Library (<code>libgsl</code>), the
very long-period &ldquo;Mersenne twister&rdquo; random number generator is now
used, see <a href="#Random-Generator">Random Generator</a>. Otherwise the Park and Miller
generator is used, as before.

</li><li> A new input function, <code>PerTransit</code>, is available to
simulate delayed gut absorption, for example
(see <a href="#PerTransit">PerTransit</a>).

</li><li> The Sundials library <code>Cvodes</code> integrator
<a href="https://computation.llnl.gov/projects/sundials">https://computation.llnl.gov/projects/sundials</a> can be called in
a <code>Integrate</code> specification, see <a href="#Integrate_0028_0029-specification">Integrate() specification</a>.

</li><li> Specifications for tempered MCMC simulations have been
extended to include thermodynamic integration and allow infinite
temperature (<i>i.e.</i>, perk 0), see <a href="#Tempered-MCMC">Tempered MCMC</a>.

</li><li> Two new distributions, <code>Normal_cv</code> and
<code>TruncNormal_cv</code>, can be used to draw normal random variates with
specified mean and coefficient of variation, see <a href="#Normal_005fcv">Normal_cv</a>.

</li><li> Symbols (denoting previously defined variables) can be
used to specify times and magnitudes in <code>Events</code> (see <a href="#Events_0028_0029-specification">Events() specification</a>).

</li><li> The <code>Prediction()</code> specification can be used as a synonym for
<code>Print()</code>, see <a href="#Print_0028_0029-specification">Print() specification</a>.

</li><li> Minor bugs were fixed (see the
<a href="http://savannah.gnu.org/projects/mcsim">http://savannah.gnu.org/projects/mcsim</a> repository for
details).

</li></ul>


<a name="Major-changes-introduced-with-version-6_002e1_002e0"></a>
<h3 class="section">2.7 Major changes introduced with version 6.1.0</h3>
<a name="index-Major-changes-in-version-6_002e1_002e0"></a>

<p>In <code>sim</code>:
</p>
<ul>
<li> In the case of posterior tempered MCMC (<var>simTypeFlag</var> equal to 3)
or thermodynamic integration (<var>simTypeFlag</var> equal to 4), the
inverse temperature (perk) scale is determined automatically (unless
you specific your own scale). The scale optimization is rather
efficient and often reaches perk 0, which offers garanteed convergence
with only one chain and estimation of the target posterior&rsquo;s
normalization constant (hence Bayes factors for model choice).

</li><li> <code>UserSpecifiedLL</code> can be used to specify an arbitrary data
likelihood.

</li></ul>


<a name="Major-changes-introduced-with-version-6_002e2_002e0"></a>
<h3 class="section">2.8 Major changes introduced with version 6.2.0</h3>
<a name="index-Major-changes-in-version-6_002e2_002e0"></a>

<p>In <code>mod</code>:
</p>
<ul>
<li> You can use C preprocessor directives (<em>i.e.</em>, <code>#include</code>)
in <code>Inline()</code> statements. That you allows you, for example, to
use GSL code in such statements or import large C code sections in
your models.

</li><li> The function <code>NegativeBinomialRandom()</code> is available to generate
corresponding random variates in your models.

</li></ul>


<p>In <code>sim</code>:
</p>
<ul>
<li> GNU MCSim can now run Monte Carlo, SetPoints and MCMC simulations
(monitoring their convergence in real time) in parallel on
multiprocessor architectures if a MPI library (Open MPI or MPICH, for
example) is installed.

</li><li> The negative binomial distribution is available for use in
statistical models.

</li><li> The efficiency of the truncated normal and log-normal samplers has
been improved by using C. Robert 1995 algorithm
(see <a href="#Bibliographic-References">Bibliographic References</a>).

</li><li> New options for the Cvodes integrator are available.

</li></ul>



<hr>
<a name="Installation"></a>
<div class="header">
<p>
Next: <a href="#Working-Through-an-Example" accesskey="n" rel="next">Working Through an Example</a>, Previous: <a href="#Overview" accesskey="p" rel="prev">Overview</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Installation-1"></a>
<h2 class="chapter">3 Installation</h2>
<a name="index-Installation"></a>

<a name="System-requirements"></a>
<h3 class="section">3.1 System requirements</h3>

<p><em>GNU MCSim</em> is written in ANSI-standard C language. We are
distributing the source code and you should be able to compile it for
any system, provided you have an ANSI C compliant compiler.
</p>
<p>Starting with version 5.0.0 <em>GNU MCSim</em> is using a few routines
from the GNU Scientific Library (<code>libgsl</code>). We recommend that you
install version 1.5 (or higher) of the shared GSL library, gslcblas
library, and GSL include files on your system. Otherwise, some
features (the <code>TruncInvGamma</code> density, and the âMersenne twisterâ
random number generator, see <a href="#Random-Generator">Random Generator</a>) will not be
available (you&rsquo;ll get a error message if you are trying to use
them.)
</p>
<p>Version 5.4.0 and higher of <em>GNU MCSim</em> can take advantage of
(<code>libSBML</code>) to read SBML models. If you choose to install libSBML
on your system, we recommend that you use version 3.3.2 (or higher) of
libSBML. LibSBML needs an XML parser library (either Expat, Xerces, or
libxml2). The Expat library has worked well for us under Linux.
</p>
<p>Version 6.2.0 and higher of <em>GNU MCSim</em> can take advantage of
(<code>MPI</code>), the message passing protocol, to parallelize
Monte Carlo, Setpoints, or MCMC simulations on multiprocessor
architectures. You will need to have a MPI library installed on your
system.
</p>
<p>On any system we recommend the GNU <code>gcc</code> compiler (freeware). The
automated installation script checks for the availability on your
system of the tools needed for compilation and proper running of the
software. It should warn you of missing component and eventually adapt
the installation to your needs (for example by installing the package
locally if you do not have superuser&rsquo;s priviledges).
</p>
<p>To run the graphical user interface <em>XMCsim</em>, you need a
GNU/Linux or Unix system with &quot;XWindows&quot;, &quot;Tcl/Tk&quot; and &quot;wish&quot;
installed.
</p>
<a name="Distribution"></a>
<h3 class="section">3.2 Distribution</h3>

<p><em>GNU MCSim</em> source code is available on Internet through:
</p>
<p>- <a href="http://savannah.gnu.org/projects/mcsim">http://savannah.gnu.org/projects/mcsim</a>.
</p>
<p>Packaged distributions are available at:
</p>
<p>- <a href="http://ftp.gnu.org/gnu/mcsim">http://ftp.gnu.org/gnu/mcsim</a>,
</p>
<p>- <a href="http://www.gnu.org/software/mcsim">http://www.gnu.org/software/mcsim</a>,
</p>
<p>and mirror sites of the GNU project.
</p>

<p>Three mailing lists are available for <em>GNU MCSim</em> users:
</p>

<p>General <i>info</i> on <em>GNU MCSim</em> is broadcasted through:
</p>
<p>- <a href="http://lists.gnu.org/archive/html/info-mcsim">http://lists.gnu.org/archive/html/info-mcsim</a>
</p>
<p>You can subscribe to the info list by going to:
</p>
<p>- <a href="http://lists.gnu.org/mailman/listinfo/info-mcsim">http://lists.gnu.org/mailman/listinfo/info-mcsim</a>.
</p>

<p>You can request <i>help</i> from us, and from other <em>GNU MCSim</em> users,
by sending email to:
</p>
<p>- <a href="mailto:help-mcsim@gnu.org">help-mcsim@gnu.org</a>
</p>
<p>(see <a href="http://lists.gnu.org/mailman/listinfo/help-mcsim">http://lists.gnu.org/mailman/listinfo/help-mcsim</a> for
subscribing).
</p>
<p>Help archives are found at:
</p>
<p>- <a href="http://news.gmane.org/gmane.comp.gnu.mcsim">http://news.gmane.org/gmane.comp.gnu.mcsim</a>,
</p>
<p>- <a href="http://lists.gnu.org/archive/html/help-mcsim">http://lists.gnu.org/archive/html/help-mcsim</a>.
</p>

<p>You can report <i>bugs</i> to us, by sending email to:
</p>
<p>- <a href="mailto:bug-mcsim@gnu.org">bug-mcsim@gnu.org</a>
</p>
<p>(<a href="http://lists.gnu.org/mailman/listinfo/bug-mcsim">http://lists.gnu.org/mailman/listinfo/bug-mcsim</a> for
subscribing).
</p>
<p>Bugs archives are located at:
</p>
<p>- <a href="http://news.gmane.org/gmane.comp.gnu.mcsim.bugs">http://news.gmane.org/gmane.comp.gnu.mcsim.bugs</a>,
</p>
<p>- <a href="http://lists.gnu.org/archive/html/bug-mcsim">http://lists.gnu.org/archive/html/bug-mcsim</a>.
</p>
<a name="Machine_002dspecific-installation"></a>
<h3 class="section">3.3 Machine-specific installation</h3>

<a name="Unix-and-GNU_002fLinux-operating-systems"></a>
<h4 class="subsection">3.3.1 Unix and GNU/Linux operating systems</h4>
<a name="index-Parallelization"></a>

<p>To install on a Unix or GNU/Linux machine, download (in binary mode)
the distributed archive file to your machine. Place it in a directory
where there is no existing <samp>mcsim</samp> subdirectory that could be
erased (make sure you check that). Decompress the archive with GNU
gunzip (<code>gunzip &lt;archive-name&gt;.tar.gz</code>). Untar the decompressed
archive with tar (<code>tar xf &lt;archive-name&gt;.tar</code>) (do <code>man tar</code>
for further help). Move to the <samp>mcsim</samp> directory just created and
issue the following commands:
</p>
<div class="example">
<pre class="example">./configure
make
make check
</pre></div>

<p>The first command above checks for the availability of the tools needed
for installation and proper running of the software. The second compiles
the <code>mod</code> program and the dynamic <code>libmcsim.so</code> library and
eventually compiles this manual in various formats. The third checks
whether the software is running and producing meaningful results in test
cases. In case of error messages, don&rsquo;t panic: check the actual
differences between the culprit output file and the file <samp>sim.out</samp>
produced by the checking. Small differences may occur from different
machine precision. This can happen for random numbers, in which case the
Markov chain simulations (MCMC) can diverge greatly after a
while.
</p>
<p>If you are logged in as &quot;root&quot; or have sufficient access rights, you
can then install the software in common directories in <samp>/usr</samp> by
typing at the shell prompt:
</p>
<div class="example">
<pre class="example">make install
</pre></div>

<p>If this system-wide installation is successful the executable files
<code>mod</code>, <code>makemcsim</code>, <code>xmcsim</code> are installed in
<samp>/usr/local/bin</samp>. The library <code>libmcsim</code> is placed in
<samp>/usr/local/lib</samp>. A copy of the <samp>mcsim</samp> source directory
(with the <samp>mod</samp>, <samp>sim</samp>, <samp>doc</samp>, <samp>examples</samp>, and
<samp>xmcsim</samp> subdirectories) is placed in <samp>/usr/local/share</samp>. If
you have the GNU <code>info</code> system available, an <code>mcsim</code> node is
added to the main <code>info</code> menu, so that <code>info mcsim</code> will
show you this manual. Finally, a symbolic link to
<samp>/usr/local/share/mcsim/doc</samp>, which contains the documentation
files and this manual (if it was generated), is created as
<samp>/usr/share/doc/mcsim</samp>.
</p>
<p>If you do not have the necessary access rights and want to install
<em>GNU MCSim</em> in a directory such as <samp>/home/me</samp>, type:
</p>
<div class="example">
<pre class="example">./configure prefix=/home/me
</pre></div>

<p>This will copy or move <samp>mod</samp>, <samp>makemcsim</samp>, and <samp>xmcsim</samp>
in a <samp>/bin</samp> directory in the <samp>/home/me</samp> directory, creating
it if necessary. The library <code>libmcsim.so</code> will be moved to the
<samp>/home/me/lib</samp> directory, <i>etc</i>.
</p>
<p>If MPI is available on your system, parallelization of Monte Carlo
runs will be enabled by default. To force the <samp>configure</samp> script
to ignore MPI, you should type:
</p>
<div class="example">
<pre class="example">./configure --with-mpi=no
</pre></div>

<p>See also the <samp>README</samp> and <samp>INSTALL</samp> text files located in
the top directory of the distribution.
</p>
<p>On certain platforms (Linux...), you will also need to do one of
the following:<br>
1) run &rsquo;ldconfig&rsquo; (see the man page if this is unfamiliar)<br>
2) set the LD_LIBRARY_PATH (or equivalent) environment variable to
contain the path &quot;/usr/local/lib&quot; or whatever you set so that programs can
find the libSBML library at run-time.
</p>
<a name="Other-operating-systems"></a>
<h4 class="subsection">3.3.2 Other operating systems</h4>

<p>Under other operating systems (Windows, etc.) or if everything else
fails you should be able to both uncompress and untar the archive with
widely distributed archiving tools. Refer to the documentation of your C
compiler to create an executable <samp>mod</samp> file from the source code
files (getopt.c, lex.c, lexerr.c, lexfn.c, mod.c, modd.c, modi.c,
modiSBML.c, modiSBML2.c, modo.c, strutil.c) provided in the <samp>mod</samp>
directory. If you want to process SBML models it is best to install the
libSBML library first. You would then compile mod with the HAVE_LIBSBML
flag defined (option <code>-DHAVE_LIBSBML</code>) and link with the library
(using the <code>-lsbml</code> directive).  Place then the executable
<samp>mod</samp> on your command path.
</p>
<p>The <samp>sim</samp> directory contains all the source files (delays.c,
getopt.c, lex.c, lexerr.c, lexfn.c, list.c, lsodes1.c, lsodes2.c,
matutil.c, matutilo.c, mh.c, modelu.c, optdsign.c, random.c, sim.c,
simi.c, siminit.c, simmonte.c, simo.c, strutil.c, yourcode.c) to create
a dynamic library or a set of objects to link with the <samp>model.c</samp>
files generated by <code>mod</code> after processing your models. Compilation
also requires reference to the <samp>config.h</samp> file sitting in the main
folder (one level above the <samp>sim</samp> directory). The -I.. option
should make the compiler aware of the correct location of
<samp>config.h</samp>. Alternatively, <samp>config.h</samp> can be copied into the
<samp>sim</samp> directory to make the package complete (apart of model.c).
</p>
<p>The final product should be an executable able to run your
model. Linking with the GNU Scientific Library (<code>gsl</code>) is
recommended (but not mandatory. In that case, define the
<code>HAVE_LIBGSL</code> flag and link with the <code>-lgsl</code> and
<code>-lgslcblas</code> (in that order).
</p>
<p>You are now ready to use <em>GNU MCSim</em>. We recommend that you go
through the next section of this manual, which walks you through an
example of model building and running.
</p>


<hr>
<a name="Working-Through-an-Example"></a>
<div class="header">
<p>
Next: <a href="#Writing-and-Compiling-Structural-Models" accesskey="n" rel="next">Writing and Compiling Structural Models</a>, Previous: <a href="#Installation" accesskey="p" rel="prev">Installation</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Working-Through-an-Example-1"></a>
<h2 class="chapter">4 Working Through an Example</h2>
<a name="index-Working-Through-an-Example"></a>


<p>Several models and simulation specification files are provided with
the package as examples (they are in the <samp>examples</samp> directory.
You can try any of them. The linear regression model is particularly
simple, but to be more complete we will try here a nonlinear implicit
model, specified through differential equations.
</p>
<p>Pharmacokinetics models describe the transport and transformation of
chemical compounds in the body. These models often include nonlinear
first-order differential equations. The following example is taken
from our own work on the kinetics of tetrachloroethylene (a solvent)
in the human body (Bois et al., 1996; Bois et al., 1990)
(see <a href="#Bibliographic-References">Bibliographic References</a>).
</p>
<p>Go to the <samp>mcsim/examples/perc</samp> directory (installed either
locally or by default in <samp>usr/share</samp> under Unix or
GNU/Linux). Open the file <samp>perc.model</samp> with any text editor
(<i>e.g.</i>, <code>emacs</code> or <code>vi</code> under Unix). This file is an
example of a model definition file. It is also printed at in Appendix
the end of this manual (see <a href="#perc_002emodel">perc.model</a>). You can use it as a
template for your own model, but you should leave it unchanged for
now. In that file, the pound signs (<kbd>#</kbd>) indicate the start of
comments. Notice that the file defines:
</p>
<ul>
<li> state variables for the model (for which differentials are
defined), for example:

<div class="example">
<pre class="example">States = {Q_fat,   # Quantity of PERC in the fat (mg)
          Q_wp,    #   ...   in the well-perfused compartment (mg)
          Q_pp,    #   ...   in the poorly-perfused compartment (mg)
          Q_liv,   #   ...   in the liver (mg)
          Q_exh,   #   ...   exhaled (mg)
          Q_met}   # Quantity of metabolite formed (mg)
</pre></div>

</li><li> output variables (obtainable at any time as analytical functions
of the states, inputs and parameters), for example:

<div class="example">
<pre class="example">Outputs = {C_liv,           # mg/l in the liver
           C_alv,           # ... in the alveolar air
           C_exh,           # ... in the exhaled air
           C_ven,           # ... in the venous blood
           Pct_metabolized, # % of the dose metabolized
           C_exh_ug}        # ug/l in the exhaled air
</pre></div>

</li><li> input variables (independent of the others variables, and
eventually varying with time), for example:

<div class="example">
<pre class="example">Inputs = {C_inh,   # Concentration inhaled (ppm)
          Q_ing};  # Quantity ingested (mg)
</pre></div>

</li><li> model parameters (independent of time), such as:

<div class="example">
<pre class="example">LeanBodyWt = 55; # lean body weight (kg)
</pre></div>

</li><li> model initialization and parameters&rsquo; scaling (the parameters used in
the dynamic equations can be made functions of other parameters: for
example volumes can be computed from masses and densities,
etc.),

</li><li> system&rsquo;s dynamics (differential or algebraic equations defining the
model <i>per se</i>),

</li><li> equations to compute the output variables.

</li></ul>

<p>This model definition file as a simple syntax, easy to master. It
needs to be turned into a C program file before compilation and
linking to the other routines (integration, file management etc.) of
<em>GNU MCSim</em>. You will use <code>mod</code> for that. First, quit the editor
and return to the operating system.
</p>
<p>To start <code>mod</code> under Unix just type <code>mod perc.model</code>. After a
few seconds, with no error messages if the model definition is
syntactically correct, <code>mod</code> announces that the <samp>model.c</samp> file
has been created. It should operate similarly under other operating
systems. 
</p>
<p>The next step is to compile and link together the various C files that
will constitute the simulation program for your particular model. Note
that each time you want to change an equation in your model you will
have to change the model definition file and repeat the steps
above. However, changing just parameter values or state initial values
does not require recompilation since that can be done through
simulation specification files. 
</p>
<ul>
<li> Under Unix, the simplest is to use the <code>makemcsim</code> script. Just
type <code>makemcsim</code> and compilation will be done automatically
(see <a href="#Using-makemcsim">Using makemcsim</a>). An executable <samp>mcsim.perc</samp> is
created. You can rename it if you wish. 

</li><li> Under other operating systems, you should use the command <code>make</code> or
its equivalent to compile and link together the <samp>model.c</samp> file
created by <code>mod</code> and the other C files of the <samp>sim</samp> directory
(see <a href="#Installation">Installation</a>). That should create an application (you should
give it a name specific to the model you are developing, <i>e.g.</i>,
<samp>mcsim.perc</samp>). Refer to your compiler manual for details on how to
use your programming environment. Your executable <samp>mcsim.perc</samp>
program is now ready to perform simulations. 

</li></ul>

<p>To start your <em>GNU MCSim</em> program just type <code>mcsim.perc</code> (if you
gave it that name) under Unix. After an introductory banner (telling
in particular which model file the program has been compiled with),
you are prompted for an input file name: type in <kbd>perc.lsodes.in</kbd>
(see <a href="#perc_002elsodes_002ein">perc.lsodes.in</a>, to see this file in Appendix), then a space,
and then type in the output file name: <kbd>perc.lsodes.out</kbd>. After a
few seconds or less (depending on your machine) the program announces
that it has finished and that the output file is
<samp>perc.lsodes.out</samp>.  You can open the output file with any text
editor or word processor, you can edit it for input in graphic
programs <i>etc</i>.
</p>
<p>You can try the various demonstration models provided in the
<samp>examples</samp> directory and observe the output you obtain. You can
then start programming you own models and doing simulations. The next
sections of this manual reference the syntax for model definition and
simulation specifications. 
</p>


<hr>
<a name="Writing-and-Compiling-Structural-Models"></a>
<div class="header">
<p>
Next: <a href="#Running-Simulations" accesskey="n" rel="next">Running Simulations</a>, Previous: <a href="#Working-Through-an-Example" accesskey="p" rel="prev">Working Through an Example</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Writing-and-Compiling-Structural-Models-1"></a>
<h2 class="chapter">5 Writing and Compiling Structural Models</h2>
<a name="index-Writing-and-Compiling-structural-models"></a>
<a name="index-Defining-models"></a>
<a name="index-Model-definition-files"></a>
<a name="index-Structural-models"></a>


<p>The model generator, &quot;<em>mod</em>&quot;, was created to facilitate structural
model definition and maintenance, while keeping short execution time
through compilation. This chapter explains how to use <code>mod</code>, and
how to code your models using a simplified syntax that <code>mod</code> can
translate in C (creating thereby a <samp>model.c</samp> file).
</p>
<p>After compiling and linking of the newly created <samp>model.c</samp> file
together with the other C files of the <samp>mcsim/sim</samp> directory (or
after linking with a dynamic library <samp>libmcsim.so</samp>), an executable
simulation program is created, specific of your particular model. These
preprocessing and compilation steps can be performed in Unix with a
single shell command <code>makemcsim</code> (in which case, the <samp>model.c</samp>
is created only temporarily and erased after that).
</p>
<a name="index-Examples"></a>
<p>Several examples of model simulation files are included in the
<samp>mcsim/examples</samp> directory. Some of them are reproduced in Appendix
(see <a href="#Examples">Examples</a>).
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Using-mod" accesskey="1">Using mod</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to preprocess a model definition file
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Using-makemcsim" accesskey="2">Using makemcsim</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a simple command to preprocess and compile a model
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Syntax-of-mod-files" accesskey="3">Syntax of mod files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to write a model definition file
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Reading-SBML-models" accesskey="4">Reading SBML models</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to specify a list of SBML models and template model
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Working-with-deSolve" accesskey="5">Working with deSolve</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to use an MCSim model compiler for R deSolve
</td></tr>
</table>



<hr>
<a name="Using-mod"></a>
<div class="header">
<p>
Next: <a href="#Using-makemcsim" accesskey="n" rel="next">Using makemcsim</a>, Up: <a href="#Writing-and-Compiling-Structural-Models" accesskey="u" rel="up">Writing and Compiling Structural Models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-mod-to-preprocess-model-description-files"></a>
<h3 class="section">5.1 Using <code>mod</code> to preprocess model description files</h3>
<a name="index-mod-usage"></a>


<p>The <code>mod</code> program is a stand-alone facility. It takes a model
description file in the &quot;user-friendly&quot; format described below
(see <a href="#Syntax-of-mod-files">Syntax of mod files</a>) and creates a C language file
<samp>model.c</samp> which you will compile and link to produce the
simulation program. <code>Mod</code> allows the user to define equations for
the model, assign default values to parameters or default initial
values to model variables, and to initialize them using additional
algebraic equations. <code>Mod</code> lets the user create and modify models
without having to maintain C code. Under Unix or GNU/Linux, the
command line syntax for the mod program is:
</p>
<div class="example">
<pre class="example">mod [input-file [output-file]]
</pre></div>

<p>where the brackets indicate that the input and output filenames are
optional. If the input filename is not specified, the program will
prompt for both. If only the input filename is specified, the output
is written by default to the file <samp>model.c</samp>. Unless you feel like
doing some makefile programming, we recommend using this default since
the makefile for <em>GNU MCSim</em> assumes the C language model file to
have this name. You have to have prepared a text file containing a
description of the model following the syntax described in the
following (see <a href="#Syntax-of-mod-files">Syntax of mod files</a>).
</p>
<p>The following options are available:
</p><ul>
<li> -h, -H    gives a short online help.

</li><li> -R        generate a C file of the format requested for use by the
          <code>deSolve</code> package of the <code>R</code> software for statistical
          analysis; <code>deSolve</code> implements differential equations solvers
          with interesting capabilities.

</li></ul>

<p>Most error messages given by <code>mod</code> are self-explanatory. Where
appropriate, they also give the line number in the model file where
the error occurred. Beware, however, of cascades of errors generated
as a consequence of a first one; so don&rsquo;t panic: start by fixing the
first one and rerun <code>mod</code>. Note that when using the -R option,
care has to be taken to adopt the <code>deSolve</code> code conventions (see
the <code>deSolve</code> manual on R CRAN). If you get really stuck you can
send a message to the help mailing list (see <a href="#Installation">Installation</a>) or to
the authors of this manual.
</p>


<hr>
<a name="Using-makemcsim"></a>
<div class="header">
<p>
Next: <a href="#Syntax-of-mod-files" accesskey="n" rel="next">Syntax of mod files</a>, Previous: <a href="#Using-mod" accesskey="p" rel="prev">Using mod</a>, Up: <a href="#Writing-and-Compiling-Structural-Models" accesskey="u" rel="up">Writing and Compiling Structural Models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-makemcsim-to-preprocess-and-compile-model-files"></a>
<h3 class="section">5.2 Using <code>makemcsim</code> to preprocess and compile model files</h3>
<a name="index-makemcsim-script"></a>


<p><code>makemcsim</code> is a Unix <code>sh</code> shell script that further
facilitates preprocessing and compilation. You run <code>makemcsim</code>
by entering it at the command prompt:
</p>
<div class="example">
<pre class="example">makemcsim [model-file]
</pre></div>

<p>where the brackets indicate that the model filename is optional. If a
model filename is not specified, the first file having extension
<samp>.model</samp> (by alphabetical order) is used. Makemcsim calls
<code>mod</code> if the model file has changed since last compilation,
compiles the <samp>model.c</samp> generated, links it to the shared
<samp>libmcsim.so</samp> library to create an executable
<samp>mcsim.&lt;root-model-name&gt;</samp>. The extension <samp>root-model-name</samp>
corresponds to your model filename (without its last extension if it has
one; <i>i.e.,</i>typically, without the <samp>.model</samp> extension). The
<samp>model.c</samp> file is deleted afterward; if you want to inspect it (for
example, if you got error messages from <code>mod</code>), run <code>mod</code> on
your model definition file.
</p>
<p>Three variants of <code>makemcsim</code> are also available:
</p>
<ul>
<li> <a name="index-makemcsimp-script"></a>
<a name="index-Parallelized-code"></a>
<a name="index-MPI"></a>
<code>makemcsimp</code>, which creates a parallelized standalone version to
run with a MPI wrapper, such as <code>mpirun</code> (no dynamic
<samp>libmcsim.so</samp> library loaded).

</li><li> <a name="index-makemcsims-script"></a>
<code>makemcsims</code>, which creates a standalone version of your model
(no dynamic <samp>libmcsim.so</samp> library loaded, no parallelization).

</li><li> <a name="index-makemcsimd-script"></a>
<code>makemcsimd</code>, which creates a non-parallelized standalone version
with debugging symbols included (so that you can use <code>gdb</code>, for
example, to check what the code actually does).

</li></ul>



<hr>
<a name="Syntax-of-mod-files"></a>
<div class="header">
<p>
Next: <a href="#Reading-SBML-models" accesskey="n" rel="next">Reading SBML models</a>, Previous: <a href="#Using-makemcsim" accesskey="p" rel="prev">Using makemcsim</a>, Up: <a href="#Writing-and-Compiling-Structural-Models" accesskey="u" rel="up">Writing and Compiling Structural Models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Syntax-of-the-model-description-file"></a>
<h3 class="section">5.3 Syntax of the model description file</h3>
<a name="index-mod-syntax"></a>
<a name="index-Syntax-for-mod"></a>


<p>The model description file is a text (ASCII) file that consists of
several sections, including global declarations, dynamics specifications
(with derivative calculations), model initialization (&quot;scaling&quot;), and
output computations. Here is a template for such a file (for further
examples see <a href="#Examples">Examples</a>):
</p>
<div class="example">
<pre class="example">

# Model description file (this is a comment)
&lt;Declarations of global variables&gt;
Initialize {
  &lt;Equations for initializing or scaling model parameters&gt;
}
Dynamics {
  &lt;Equations for computing derivatives of the state variables&gt;
}
Jacobian {
  &lt;Equation for the Jacobian of the state derivatives&gt;
}
CalcOutputs {
  &lt;Equations for computing output variables&gt;
}
End. # mandatory ending keyword

</pre></div>

<p><code>Initialize</code>, <code>Dynamics</code>, <code>Jacobian</code> and
<code>CalcOutputs</code> are reserved keywords and, if used, must appear as
shown, followed by the curly braces which delimit each section
(see <a href="#Model-initialization">Model initialization</a>; <a href="#Dynamics-section">Dynamics section</a>; <a href="#Output-calculations">Output calculations</a>). Please note that at least one of the sections
<code>Dynamics</code> or <code>CalcOutputs</code> should be defined, and that
<code>Dynamics</code> must be used if the model includes differential
equations. Finally the model definition file must have the <code>End</code>
keyword at the beggining of a line, eventually preceeded by white spaces
or tabs. Text after the <code>End</code> keyword is ignored.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#General-syntax" accesskey="1">General syntax</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Declarations-of-global-variables" accesskey="2">Declarations of global variables</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Model-types" accesskey="3">Model types</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Special-functions" accesskey="4">Special functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Input-functions" accesskey="5">Input functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#In-line-functions" accesskey="6">In line functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Model-initialization" accesskey="7">Model initialization</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Dynamics-section" accesskey="8">Dynamics section</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Delay-differentials" accesskey="9">Delay differentials</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Output-calculations">Output calculations</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Comments-on-style">Comments on style</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="General-syntax"></a>
<div class="header">
<p>
Next: <a href="#Declarations-of-global-variables" accesskey="n" rel="next">Declarations of global variables</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="General-syntax-1"></a>
<h4 class="subsection">5.3.1 General syntax</h4>


<p>The general syntax of the model description file is as follows:
</p>
<ul>
<li> <a name="index-Comments"></a>
<a name="index-_0027_0023_0027-sign"></a>
Comments begin with a pound sign (<kbd>#</kbd>) and continue to the end of
the line.

</li><li> <a name="index-Blank-lines"></a>
Blank lines are allowed and ignored.

</li><li> <a name="index-_0027_003b_0027-sign"></a>
<a name="index-Semi_002dcolon"></a>
All commands can span several lines and are terminated by a semi-colon
(<kbd>;</kbd>).

</li><li> <a name="index-Variable-names"></a>
Four types of variables are used: state variables, output variables,
input variables, and parameters (see <a href="#Declarations-of-global-variables">Declarations of global variables</a>).  The name of a variable should be a valid C identifier,
starting with a letter or underscore (<kbd>_</kbd>) and followed by any
number of alpha-numeric characters or underscores, up to a maximum of
80. Variable names are case sensitive. Note that the names <kbd>IFN</kbd>
and <kbd>IGS</kbd>, in capital letters, are reserved by the program and
should not be used as a parameter or variable name.

</li><li> <a name="index-Assignment"></a>
<a name="index-_0027_003d_0027-sign"></a>
<a name="index-Special-functions"></a>
<a name="index-Function_002c-special"></a>
<a name="index-Input-functions"></a>
<a name="index-Function_002c-input"></a>
Variable assignments have the following syntax:

<div class="example">
<pre class="example">&lt;variable-name&gt; '=' &lt;constant-value-or-expression&gt; ';'
</pre></div>

<a name="Standard-functions"></a>
<p>The equal sign is needed. The right-hand side expression can be a
valid C mathematical expression including numerical constants, already
defined variables, standard ANSI C mathematical functions (
<code>acos</code>, <code>asin</code>, <code>atan</code>, <code>atan2</code>, <code>ceil</code>,
<code>cos</code>, <code>cosh</code>, <code>exp</code>, <code>fabs</code>, <code>floor</code>,
<code>fmax</code>, <code>fmin</code>, <code>fmod</code>, <code>log</code>, <code>log10</code>,
<code>pow</code>, <code>sin</code>, <code>sinh</code>, <code>sqrt</code>, <code>tan</code>,
<code>tanh</code>), and <em>GNU MCSim</em>&rsquo;s &quot;<em>special functions</em>&quot;
(see <a href="#Special-functions">Special functions</a>) or &quot;<em>input functions</em>&quot; (see <a href="#Input-functions">Input functions</a>). Special functions can take already defined variables,
constant numerical values or expressions as parameters. Input
functions can only be used on the right hand side of assignments to
input variables.
</p>
<p>Colon conditional assignments have the following syntax:
<a name="index-Colon-conditional-assignment"></a>
<a name="index-_0027_003f_0027-sign"></a>
<a name="index-_0027_003a_0027-sign"></a>
<a name="index-Conditional-assignment"></a>
<a name="index-Logical-tests"></a>
<a name="index-Tests_002c-logical"></a>
</p>
<div class="example">
<pre class="example">&lt;variable-name&gt; = (&lt;test&gt; ? &lt;value-if-true&gt; : &lt;value-if-false&gt;);
</pre></div>

<p>For example:
</p>
<div class="example">
<pre class="example">Adjusted_Param = (Input_Var &gt; 0.0 ? Param * 1.1 : Param);
</pre></div>

<p>In this example, if &lsquo;<samp>Input_Var</samp>&rsquo; is greater than 0, the parameter
&lsquo;<samp>Adjusted_Param</samp>&rsquo; is computed as the product of &lsquo;<samp>Param</samp>&rsquo; by
&lsquo;<samp>1.1</samp>&rsquo;; otherwise &lsquo;<samp>Adjusted_Param</samp>&rsquo; is equal to
&lsquo;<samp>Param</samp>&rsquo;. Note that conditional assignments can be nested (<i>i.e.</i>,
&lt;value-if-true&gt; or &lt;value-if-false&gt; can themselves be a conditional
expression). The comparison operators allowed are the equality operator
<code>==</code>, and non-equality operators <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>,
<code>&lt;&gt;</code>, <code>&lt;=</code> and <code>&gt;=</code>.
<a name="index-Comparison-operators"></a>
<a name="index-_0027_003d_003d_0027-operator"></a>
<a name="index-_0027_0021_003d_0027-operator"></a>
<a name="index-_0027_003c_0027-operator"></a>
<a name="index-_0027_003e_0027-operator"></a>
<a name="index-_0027_003c_003e_0027-operator"></a>
<a name="index-_0027_003c_003d_0027-operator"></a>
<a name="index-_0027_003e_003d_0027-operator"></a>
</p>
<p>More complex conditions can also be specified, but the Boolean AND, OR
and NOT operations have not yet been implemented. You can use:
</p>
<p><code>(('A'*'B')&gt;0)</code> for AND
<code>(('A'+'B')&gt;0)</code> for OR
<code>('A'==0)</code> for NOT
</p>

</li><li> <a name="index-Vectors"></a>
<a name="index-Arrays"></a>
<a name="index-Square-brackets"></a>
<a name="index-_0027_005b_005d_0027-_0028square-brackets_0029-notation"></a>
<a name="index-_0027_002d_0027-_0028hyphen_0029-sign"></a>
<a name="Vectors"></a>Vectors: You can use vectors (arrays) in your model
code or simulation definition files to simplify it.

<p><i>Declaring vectors</i>: To declare a state variable, an input, an
output, or a parameter as a vector, use the one of the two following
syntaxes when you first define it:
</p>
<div class="example">
<pre class="example">&lt;variable-name&gt; '[' &lt;integer&gt; ']'
&lt;variable-name&gt; '[' &lt;integer&gt; '-' &lt;integer&gt; ']'
</pre></div>


<p>The variable name is immediately followed by an opening square bracket
(&rsquo;[&rsquo;). The array index bounds (which define the valid indices) can be
given as (long) positive or null integers separated by an hyphen (&rsquo;-&rsquo;)
(spaces are allowed). In this case the second integer must be higher the
first. They are followed by a closing bracket (&rsquo;]&rsquo;). The hyphen and
second integer are optional. If only one bound (integer) is given, only
the component with corresponding index is declared. Both syntaxes can be
mixed. For example:
</p>
<div class="example">
<pre class="example">States = {y[0-9]};
alpha[0-2] = 1;
beta[0] = 1;
beta[1] = 2;
beta[2-4];
</pre></div>

<p>The previous lines define a state variable &lsquo;<samp>y</samp>&rsquo; as a vector of
length 10, with valid indices ranging between 0 and 9, included. The
parameter vector &lsquo;<samp>alpha</samp>&rsquo; is defined with range 0 to 2, each
component being initialized to value 1. For parameter &lsquo;<samp>beta</samp>&rsquo;,
components 0, 1 and 2 to 4 are initialized separately (components 2 to 4
are initialized with default value 0).
</p>
<p><i>Accessing vectors&rsquo; components</i>: After declaration, vector&rsquo;s
components can be accessed individually using the square bracket
syntax:
</p>
<div class="example">
<pre class="example">&lt;variable-name&gt; '[' &lt;integer&gt; ']'
</pre></div>

<p>For example:
</p>
<div class="example">
<pre class="example">Outputs = {x[0-1]};
beta[0] = 0;
beta[1] = beta[0] + 1;
CalcOutputs {
  x[0] = beta[0] * t;
  x[1] = beta[1] * t;
}
</pre></div>

<p>In the above example, &lsquo;<samp>beta[0]</samp>&rsquo;, &lsquo;<samp>beta[1]</samp>&rsquo;, &lsquo;<samp>x[0]</samp>&rsquo;, and
&lsquo;<samp>x[1]</samp>&rsquo; are accessed individually. The variable &lsquo;<samp>t</samp>&rsquo; refers to
the implicit variable &rsquo;time&rsquo;.
</p>
<p><i>Vectorization of equations</i>: The equations specifying the model,
which consist in assignments, can be vectorized in the
<code>Initialize</code>, <code>Dynamics</code> and <code>CalcOutputs</code> sections
(but not in the global section) (see <a href="#Declarations-of-global-variables">Declarations of global variables</a>). Vectorization allows you to specify an operation for an
entire vector or parts of it. The following syntax should be
used:
<a name="index-Vectorization"></a>
</p>
<div class="example">
<pre class="example">&lt;var-name&gt;'['&lt;integer&gt;'-'&lt;integer&gt;']' = &lt;vectorized-expression&gt;;
</pre></div>

<p>On the right-hand side, the vectorized expression should be a valid C
mathematical expression including numerical constants, already defined
state, input, output, other (parameter) variables or vectors, and
standard ANSI C mathematical functions or special functions
(see <a href="#Special-functions">Special functions</a>). Here also, input functions (see <a href="#Input-functions">Input functions</a>) can only be used on the right hand side of assignments to
input variables. Vector indices on the right-hand side can take the
special form of &quot;<em>bracketed expressions</em>&quot;. Bracketed expressions can
be composed of integers, the 4 basic arithmetic operators (&rsquo;+&rsquo;, &rsquo;-&rsquo;,
&rsquo;*&rsquo;, &rsquo;/&rsquo;), parentheses and the index letter &rsquo;i&rsquo;. The running index &rsquo;i&rsquo;
points in turn to each component in the range specified on the left-hand
side (imagine that the range given on the left-hand side corresponds to
a &rsquo;for&rsquo; loop with index &rsquo;i&rsquo; running from the lower bound to the upper
bound). This is best understood by looking at some code. In the previous
example, the assignments to x[0] and x[1] obviously deserve
vectorization. This is achieved by the following statements:
</p>
<div class="example">
<pre class="example">CalcOutputs {
  x[0-1] = beta[i] * t;
}
</pre></div>

<p>Here, the index &rsquo;i&rsquo; refers to the values 0 and 1. Here is another
example:
</p>
<div class="example">
<pre class="example">Outputs{x[1-10]};
CalcOutputs {
  x[1] = 0;
  x[2-10] = x[i-1] + 1;
}
</pre></div>

<p>This is equivalent to:
</p>
<div class="example">
<pre class="example">Outputs{x[1-10]};
CalcOutputs {
  x[1] = 0;
  x[2] = x[1] + 1;
  ...
  x[10] = x[9] + 1;
}
</pre></div>

<p>and will assign value 1 to &lsquo;<samp>x[2]</samp>&rsquo;, 2 to &lsquo;<samp>x[3]</samp>&rsquo;, <i>etc</i>. On
the right-hand side, more complicated bracketed expressions like
&lsquo;<samp>[(2*i-1)/(i+3)]</samp>&rsquo; can be used. Another, working, example of vector
use is given in the <samp>mcsim/examples/pde2</samp> directory.
</p>
<p><i>Alternative &rsquo;underscore&rsquo; (&rsquo;_&rsquo;) syntax</i>: Individual vector components
can be declared and used (everywhere in the model file) with the
following syntax:
<a name="index-_0027_005f_0027-_0028underscore_0029-vector-notation"></a>
<a name="index-Underscore-syntax-for-vectors"></a>
</p>
<div class="example">
<pre class="example">&lt;variable-name&gt;'_'&lt;integer&gt;
</pre></div>

<p>The integer indicates which component of the vector is referred
to. For example &lsquo;<samp>x_1</samp>&rsquo; is strictly equivalent to
&lsquo;<samp>x[1]</samp>&rsquo;. Note!: No space are allowed between the variable name,
the underscore and the integer.
</p>
</li><li> <a name="index-End-keyword"></a>
The <code>End</code> keyword must used to indicate model termination.

</li></ul>



<hr>
<a name="Declarations-of-global-variables"></a>
<div class="header">
<p>
Next: <a href="#Model-types" accesskey="n" rel="next">Model types</a>, Previous: <a href="#General-syntax" accesskey="p" rel="prev">General syntax</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Declarations-of-global-variables-1"></a>
<h4 class="subsection">5.3.2 Declarations of global variables</h4>
<a name="index-Parameter-declaration"></a>


<p>Commands not specified within the delimiting braces of another section
are considered to be global declarations. In the global section, you
first declare the state, input, and output variables. There should be at
least one state or output variable in your model.
</p>
<ul>
<li> <a name="index-State-variables"></a>
States are variables for which a first-order differential equation is
defined in the <code>Dynamics</code> section (see <a href="#Dynamics-section">Dynamics section</a>)
(higher orders or partial differential equations are not
allowed).

</li><li> <a name="index-Input-variables"></a>
Inputs are variables independent of the others variables, and may
change with time (for example an exposure concentration to a
chemical).

</li><li> <a name="index-Output-variables"></a>
Outputs are dependent model variables, obtainable at any time as
analytical functions of the states, inputs or parameters. They must
receive assignments in either the <code>Dynamics</code> or
<code>CalcOutputs</code> sections. You should not assume that their past
values are accessible and correct: they have to be calculated in the
same section where they are used and before being used.

</li></ul>

<p>The format for declaring each of these variables is the same, and
consists of the keyword <code>States</code>, <code>Inputs</code> or <code>Outputs</code>
followed by an equal sign and a list of the variable names enclosed in
curly braces as shown here:
</p>
<div class="example">
<pre class="example">States =   {Qb_fat,  # Benzene in the fat
            Qb_bm,   # ...     in the bone marrow
            Qb_liv}; # ...     in the liver and others

Inputs =   {Q_gav,   # Gavage dose
            C_inh};  # Inhalation concentration

Outputs =  {Cb_exp,  # Concentration in expired air
            Cb_ven}; # ...           in venous blood
</pre></div>

<p>After being defined, states, inputs and outputs can then be given
initial values (constants or expressions). Inputs can also be assigned
input functions, described below (see <a href="#Input-functions">Input functions</a>). Some
examples of initialization are shown here:
</p>
<div class="example">
<pre class="example">Qb = 0.1; # Default initial value for state variable Qb

# Input variable assigned a periodic exponential input function
Q = PerExp(1, 60, 0, 1); # Magnitude of 1.0,
                         # period of 60 time units,
                         # T0 in period is 0,
                         # Rate constant is 1.0
</pre></div>

<p>If a state, input, or output variable is not explicitly given an initial
value, that value will be set to zero by default. Initial values are
reset to their specified value by the simulation program at the start of
each <code>Simulation</code> (see <a href="#Simulation-sections">Simulation sections</a>).
</p>
<p>All the other variables are &quot;<em>parameters</em>&quot;. Model parameters you
want to be able to change in simulation input files should be declared
in the global section. For example:
</p>
<div class="example">
<pre class="example">Wind_speed; # (m/s) Local wind speed
</pre></div>

<p>Parameters are by default assigned a value of zero. To assign a
different nominal values, use the assignment rules given above. For
example:
</p>
<div class="example">
<pre class="example">BodyWt = 65.0 + sqrt(15.0); # Weight of the subject (in kg)
</pre></div>

<p>All parameters and variables are computed in double precision
floating-point format. Initial values should not be such as to cause
computation errors in the model equations; this is likely to lead to
crashing of the program (so, for example, do not assign a default
value of zero to a parameter appearing alone in a denominator). Note
that the order of global declarations matters within the global
section itself (<i>i.e.</i>, parameters and variables should be defined
and initialized before being used in assignments of others), but not
with respect to other blocks. A parameter defined at the end of the
description file can be used in the <code>Dynamics</code> section which may
appear at the beginning of the file. Still, such an inverse order
should be avoided. For this reason, the format above, where global
declarations come first, is strongly suggested to avoid confusing
results. Note again that the name <code>IFN</code>, in capital letters, is
reserved by the program and should not be used as parameter or
variable name.  Finally, if a parameter is defined several times, only
the first definition is taken into account (a warning is issued,
beware of it).
</p>


<hr>
<a name="Model-types"></a>
<div class="header">
<p>
Next: <a href="#Special-functions" accesskey="n" rel="next">Special functions</a>, Previous: <a href="#Declarations-of-global-variables" accesskey="p" rel="prev">Declarations of global variables</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Model-types-1"></a>
<h4 class="subsection">5.3.3 Model types</h4>
<a name="index-Model-types"></a>
<a name="index-Structural-models-1"></a>
<a name="index-Algebraic-models"></a>
<a name="index-Models_002c-algebraic"></a>
<a name="index-Differential-models"></a>
<a name="index-Models_002c-differential"></a>
<a name="index-Discrete_002dtime-models"></a>
<a name="index-Models_002c-discrete_002dtime"></a>

<p>This section deals with structural models. Statistical models that you
setup for model calibration and data analysis are defined in the
simulation input files, through statistical distribution functions. They
are dealt with later in this manual (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).
</p>
<p><em>GNU MCSim</em> can easily deal with purely algebraic structural
models. You do not need to define state variables or a <code>Dynamics</code>
section for such models. Simply use input and output variables and
parameters and specify the model in the <code>CalcOutputs</code> section. You
can use the time variable <code>t</code> if that is natural for your model. If
your model does not use <code>t</code>, you will still need to specify &quot;output
times&quot; in <code>Print()</code> or <code>PrintStep()</code> statements to obtain
outputs: you can use arbitrary times. If you do not use <code>t</code> as
&quot;independent&quot; model variable, you will also need do define a
<code>Simulation</code> section (see <a href="#Simulation-sections">Simulation sections</a>) for each
combination of values for the independent variables of your model. This
may be clumsy if many values are to be used. In that case, you may want
to use the variable <code>t</code> to represent something else than
time.
</p>
<p>Ordinary differential models, with algebraic components, can be easily
setup with <em>GNU MCSim</em>. Use state variables and specify a
<code>Dynamics</code> section. Time, <code>t</code> is the integration variable,
but here again, <code>t</code> can be used to represent anything you
want. For partial differential equations some problems might be solved
by implementing line methods (see examples in
<samp>mcsim/examples/pde1</samp> and <samp>mcsim/examples/pde2</samp>)...
</p>
<p>You can use <em>GNU MCSim</em> for discrete-time dynamic models (or difference
models). That is a bit tricky. Assignments in the <code>CalcOutputs</code>
section are volatile (not memorized), so the model equations have to be
given in a <code>Dynamics</code> section. But the model variables should still
be declared as outputs, because they should not be updated by
integration. However, you need at least one true differential equation
in the <code>Dynamics</code> section, so you should declare a dummy state
variable (and assign to its derivative a constant value of zero). You
also want the calls to <code>Dynamics</code> to be precisely scheduled, so it
is best to use the <code>Euler</code> integration routine (see <a href="#Integrate_0028_0029-specification">Integrate() specification</a>) which uses a constant step. Since <code>Euler</code> may call
repeatedly <code>Dynamics</code> at any given time, you want to guard against
untimely updating... Altogether, we recommend that you examine the
example files in the <samp>mcsim/examples/discrete</samp> directory provided
with the source code for <em>GNU MCSim</em>.
</p>


<hr>
<a name="Special-functions"></a>
<div class="header">
<p>
Next: <a href="#Input-functions" accesskey="n" rel="next">Input functions</a>, Previous: <a href="#Model-types" accesskey="p" rel="prev">Model types</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Special-functions-1"></a>
<h4 class="subsection">5.3.4 Special functions</h4>
<a name="index-Special-functions-1"></a>
<a name="index-Functions_002c-special"></a>


<p>The following special functions (whose name is case-sensitive) are
available to the user for assignment of parameters and variables in the
model definition file:
</p>
<ul>
<li> <a name="index-BetaRandom_0028_0029-function"></a>
<a name="index-Function_002c-BetaRandom_0028_0029"></a>
<a name="index-Random-number_002c-beta"></a>
<code>BetaRandom(<var>alpha</var>, <var>beta</var>, <var>a</var>, <var>b</var>)</code>: returns a
Beta distributed variate on the interval [<var>a</var>,<var>b</var>] with shape
parameters <var>alpha</var> and <var>beta</var>;

</li><li> <a name="index-BinomialBetaRandom_0028_0029-function"></a>
<a name="index-Function_002c-BinomialBetaRandom_0028_0029"></a>
<a name="index-Random-number_002c-binomial_002dbeta"></a>
<code>BinomialBetaRandom(<var>E</var>, <var>alpha</var>, <var>beta</var>)</code>: return
random variate, of mathematical expectation <var>E</var>, drawn from a
binomial distribution with probability <var>p</var>, <var>p</var> being Beta
distributed with parameters <var>alpha</var> and <var>beta</var>;

</li><li> <a name="index-BinomialRandom_0028_0029-function"></a>
<a name="index-Function_002c-BinomialRandom_0028_0029"></a>
<a name="index-Random-number_002c-binomial"></a>
<code>BinomialRandom(<var>p</var>, <var>N</var>)</code>: returns a binomially
distributed random variate;

</li><li> <a name="index-CauchyRandom_0028_0029-function"></a>
<a name="index-Function_002c-CauchyRandom_0028_0029"></a>
<a name="index-Random-number_002c-Cauchy"></a>
<code>CauchyRandom(<var>s</var>)</code>: returns a Cauchy distributed
random variate with scale <var>s</var>;

</li><li> <a name="index-CDFNormal_0028_0029-function"></a>
<a name="index-Function_002c-CDFNormal_0028_0029"></a>
<a name="index-Normal-cumulative-density-function"></a>
<a name="index-Cumulative-density-function_002c-Normal"></a>
<code>CDFNormal(<var>x</var>)</code>: the normal cumulative density function;

</li><li> <a name="index-Chi2Random_0028_0029-function"></a>
<a name="index-Function_002c-Chi2Random_0028_0029"></a>
<a name="index-Random-number_002c-Chi_002dsquared"></a>
<code>Chi2Random(<var>dof</var>)</code>: returns a Chi-squared random variate with
<var>dof</var> degrees of freedom;

</li><li> <a name="index-erfc_0028_0029-function"></a>
<a name="index-Complementary-error-function"></a>
<a name="index-Error-function_002c-complementary"></a>
<a name="index-Function_002c-erfc_0028_0029"></a>
<code>erfc(<var>x</var>)</code>: the complementary error function;

</li><li> <a name="index-ExpRandom_0028_0029-function"></a>
<a name="index-Function_002c-ExpRandom_0028_0029"></a>
<a name="index-Random-number_002c-exponential"></a>
<code>ExpRandom(<var>beta</var>)</code>: returns an exponential variate with
inverse scale <var>beta</var>;

</li><li> <a name="index-GammaRandom_0028_0029-function"></a>
<a name="index-Function_002c-GammaRandom_0028_0029"></a>
<a name="index-Random-number_002c-gamma"></a>
<code>GammaRandom(<var>alpha</var>)</code>: returns a gamma distributed random
variate with shape parameter <var>alpha</var> and inverse scale equal to
1;

</li><li> <a name="index-GetSeed_0028_0029-function"></a>
<a name="index-Function_002c-GetSeed_0028_0029"></a>
<a name="index-Random-seed_002c-reading-its-value"></a>
<code>GetSeed()</code>: returns the current value of the random generator
seed (this function is not available if the GNU Scientific Library is
used; if called in that case, it exits with an error message);

</li><li> <a name="index-GGammaRandom_0028_0029-function"></a>
<a name="index-Function_002c-GGammaRandom_0028_0029"></a>
<a name="index-Random-number_002c-general_002dgamma"></a>
<code>GGammaRandom(<var>alpha</var>, <var>beta</var>)</code>: returns a gamma
distributed random variate with shape parameter <var>alpha</var> and
inverse scale <var>beta</var>;

</li><li> <a name="index-InvGGammaRandom_0028_0029-function"></a>
<a name="index-Function_002c-InvGGammaRandom_0028_0029"></a>
<a name="index-Random-number_002c-inverse_002dgamma"></a>
<code>InvGGammaRandom(<var>alpha</var>, <var>beta</var>)</code>: returns an inverse
gamma distributed random variate with shape parameter <var>alpha</var> and
scale parameter <var>beta</var>;

</li><li> <a name="index-lnDFNormal_0028_0029-function"></a>
<a name="index-Function_002c-lnDFNormal_0028_0029"></a>
<a name="index-Normal-density-function"></a>
<a name="index-Density-function_002c-Normal"></a>
<code>lnDFNormal(<var>x</var>, <var>mean</var>, <var>sd</var>)</code>: the natural logarithm
of the normal density function;

</li><li> <a name="index-lnGamma_0028_0029-function"></a>
<a name="index-Function_002c-lnGamma_0028_0029"></a>
<a name="index-Gamma-function"></a>
<code>lnGamma(<var>x</var>)</code>: the natural logarithm of the gamma function;

</li><li> <a name="index-LogNormalRandom_0028_0029-function"></a>
<a name="index-Function_002c-LogNormalRandom_0028_0029"></a>
<a name="index-Random-number_002c-lognormal"></a>
<code>LogNormalRandom(<var>mean</var>, <var>sd</var>)</code>: returns a lognormally
distributed variate with geometric mean <var>mean</var> and geometric
standard deviation <var>sd</var> (<i>i.e.</i>, the log of the returned variate
is normally distributed with mean
log(<var>mean</var>) and standard deviation log(<var>sd</var>));


</li><li> <a name="index-LogUniformRandom_0028_0029-function"></a>
<a name="index-Function_002c-LogUniformRandom_0028_0029"></a>
<a name="index-Random-number_002c-loguniform"></a>
<code>LogUniformRandom(<var>a</var>, <var>b</var>)</code>: returns variate log-uniformly
distributed on the interval [<var>a</var>,<var>b</var>];

</li><li> <a name="index-NegativeBinomialRandom_0028_0029-function"></a>
<a name="index-Function_002c-NegativeBinomialRandom_0028_0029"></a>
<a name="index-Random-number_002c-negative-binomial"></a>
<code>NegativeBinomialRandom(<var>r</var>, <var>p</var>)</code>: returns a negative
binomial random variable with prescribed number of failures, <var>r</var>,
until trials are stopped, and probability of failure, <var>p</var>,
for each trial
The probability mass function of this distribution for the number $k$ of
successes is equal to:
 C(k+r-1, k)*pow(p,r)*pow(1-p,k)


</li><li> <a name="index-NormalRandom_0028_0029-function"></a>
<a name="index-Function_002c-NormalRandom_0028_0029"></a>
<a name="index-Random-number_002c-normal"></a>
<code>NormalRandom(<var>mean</var>, <var>sd</var>)</code>: returns a normally
distributed random variable with prescribed mean and standard
deviation;

</li><li> <a name="index-PiecewiseRandom_0028_0029-function"></a>
<a name="index-Function_002c-PiecewiseRandom_0028_0029"></a>
<a name="index-Random-number_002c-piecewise"></a>
<code>PiecewiseRandom(<var>min</var>, <var>a</var>, <var>b</var>, <var>max</var>)</code>: the
distribution of the returned variate has the form of a truncated
triangle, with base from <var>min</var> to <var>max</var> and a plateau between
<var>a</var> and <var>b</var>. If
a = b,
the distribution is the triangular distribution;

</li><li> <a name="index-PoissonRandom_0028_0029-function"></a>
<a name="index-Function_002c-PoissonRandom_0028_0029"></a>
<a name="index-Random-number_002c-Poisson"></a>
<code>PoissonRandom(<var>mu</var>)</code>: returns a Poisson-distributed random
variate, of rate <var>mu</var>;

</li><li> <a name="index-SetSeed_0028_0029-function"></a>
<a name="index-Function_002c-SetSeed_0028_0029"></a>
<a name="index-Random-seed_002c-setting-its-value"></a>
<code>SetSeed(<var>seed</var>)</code>: sets the current value of the
pseudo-random generator seed to the specified <var>seed</var>. When using
the GNU Scientific Library, that <var>seed</var> can be any positive
integer (including zero). When using the native code, it can be any
positive real number (seeds between 1.0 and 2147483646.0 are used as
is, the others are rescaled within those bounds, and a warning is
issued);

</li><li> <a name="index-StudentTRandom_0028_0029-function"></a>
<a name="index-Function_002c-StudentTRandom_0028_0029"></a>
<a name="index-Random-number_002c-Student-t"></a>
<code>StudentTRandom(<var>dof</var>, <var>mean</var>, <var>sd</var>)</code>:
returns a Student <i>t</i> distributed random variate with <var>dof</var>
degrees of freedom and given <var>mean</var> and standard deviation;

</li><li> <a name="index-TruncInvGGammaRandom_0028_0029-function"></a>
<a name="index-Function_002c-TruncInvGGammaRandom_0028_0029"></a>
<a name="index-Random-number_002c-truncated-inverse_002dgamma"></a>
<code>TruncInvGGammaRandom(<var>alpha</var>, <var>beta</var>, <var>a</var>, <var>b</var>)</code>:
returns a truncated inverse gamma distributed random variate with shape
parameter <var>alpha</var> and scale <var>beta</var>, in the range
[<var>a</var>,<var>b</var>]. Explicit specification of <var>a</var>,<var>b</var> is
required;

</li><li> <a name="index-TruncLogNormalRandom_0028_0029-function"></a>
<a name="index-Function_002c-TruncLogNormalRandom_0028_0029"></a>
<a name="index-Random-number_002c-truncated-lognormal"></a>
<code>TruncLogNormalRandom(<var>mean</var>, <var>sd</var>, <var>a</var>, <var>b</var>)</code>:
returns a truncated lognormal variate with geometric mean <var>mean</var> and
geometric standard deviation <var>sd</var>, in the range
[<var>a</var>,<var>b</var>]. Explicit specification of <var>a</var>,<var>b</var> is
required;

</li><li> <a name="index-TruncNormalRandom_0028_0029-function"></a>
<a name="index-Function_002c-TruncNormalRandom_0028_0029"></a>
<a name="index-Random-number_002c-truncated-normal"></a>
<code>TruncNormalRandom(<var>mean</var>, <var>sd</var>, <var>a</var>, <var>b</var>)</code>:
returns a truncated normal variate with prescribed mean and standard
deviation, in the range [<var>a</var>,<var>b</var>]. Explicit specification of
<var>a</var>,<var>b</var> is required;

</li><li> <a name="index-UniformRandom_0028_0029-function"></a>
<a name="index-Function_002c-UniformRandom_0028_0029"></a>
<a name="index-Random-number_002c-uniform"></a>
<code>UniformRandom(<var>min</var>, <var>max</var>)</code>: returns a uniformly
distributed random variable, sampled between min and max.

</li></ul>

<a name="Random-Generator"></a><p>Note: If you have linked Graph_Sampler with
GNU Scientific Library (gls), all the above random number generating
functions use an extremely long period random number generator: the
âMersenne twisterâ generator (gsl_rng_mt19937). Otherwise, the random
generator used is that of Park and Miller (Barry, 1996; Park and
Miller, 1988; Vattulainen et al., 1994) (see <a href="#Bibliographic-References">Bibliographic References</a>). When using the GNU Scientific Library, the default
random generator seed value is 0. When using the native code, it is
314159265.3589793. Those default values can be overridden with the
function <code>SetSeed</code>.
</p>
<p>Note also that assignment of a random number generating function to a
state variable derivative will define a form of stochastic
differential equation. <em>GNU MCSim</em>&rsquo;s integration routines are not
particularly suited to the resolution of such equations. If you wish
to try it anyway, you may want to consider using the &quot;robust&quot; Euler
method (see <a href="#Integrate_0028_0029-specification">Integrate() specification</a>).
</p>


<hr>
<a name="Input-functions"></a>
<div class="header">
<p>
Next: <a href="#In-line-functions" accesskey="n" rel="next">In line functions</a>, Previous: <a href="#Special-functions" accesskey="p" rel="prev">Special functions</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Input-functions-1"></a>
<h4 class="subsection">5.3.5 Input functions</h4>
<a name="index-Input-functions-1"></a>
<a name="index-Functions_002c-input"></a>


<p>These functions can be used in special assignments, valid only for input
variables. Inputs can be initialized to a constant or to a standard
mathematical expression, or assigned one of the following input
functions:
</p>

<ul>
<li> <a name="index-PerDose_0028_0029-function"></a>
<a name="index-Function_002c-PerDose_0028_0029"></a>
<code>PerDose()</code> specifies a periodic input of constant
<var>&lt;magnitude&gt;</var>. The input begins exactly at <var>&lt;initial-time&gt;</var> in the
<var>&lt;period&gt;</var> and lasts for <var>&lt;exposure-time&gt;</var> time
units. Syntax:

<div class="example">
<pre class="example">&lt;input variable&gt; = PerDose(&lt;magnitude&gt;, &lt;period&gt;, &lt;initial-time&gt;,
                           &lt;exposure-time&gt;);
</pre></div>


</li><li> <a name="index-PerExp_0028_0029-function"></a>
<a name="index-Function_002c-PerExp_0028_0029"></a>
<code>PerExp()</code> specifies a periodic exponential input. At time
<var>&lt;initial-time&gt;</var> in the <var>&lt;period&gt;</var> the input rises
instantaneously to <var>&lt;magnitude&gt;</var> and begins to decay exponentially
with the constant <var>&lt;decay-constant&gt;</var>. Note that the input does not
accumulate across periods, it resets at each period
start. Syntax:

<div class="example">
<pre class="example">&lt;input variable&gt; = PerExp(&lt;magnitude&gt;, &lt;period&gt;, &lt;initial-time&gt;,
                          &lt;decay-constant&gt;);
</pre></div>


</li><li> <a name="index-PerTransit_0028_0029-function"></a>
<a name="index-Function_002c-PerTransit_0028_0029"></a>
<a name="PerTransit"></a><code>PerTransit()</code> models a delayed input mechanism in which a
substance has to go through a chain of (linear) transfer compartments
before being actually input (see Savic et al., 2007)
(see <a href="#Bibliographic-References">Bibliographic References</a>).
The actual input is computed as:

<div class="example">
<pre class="example">((K_tr * t)^n) * exp(-K_tr * t) / n!
</pre></div>

<p>where
<i>K_tr</i>
is the transit rate constant from compartment to compartment, and
<i>n</i> is the number of &ldquo;apparent&rdquo; transit compartments (a positive real
number). Factorial <i>n</i> is computed using Stirling&rsquo;s formula. This is
a popular absorption model in pharmacokinetics, where the number of
<i>n</i> and the transfer rate constant are estimated from data.
</p>
<p>The function <code>PerTransit()</code> has 5 arguments: a <var>&lt;magnitude&gt;</var>;
a <var>&lt;period&gt;</var> (for multiple dosing) at the beginning of which input
is reset. Note that the input does not accumulate across periods, it
resets at each period start; an <var>&lt;initial-time-in-period&gt;</var> in
<var>&lt;period&gt;</var> at which dosing actually starts; a
<var>&lt;transfer-rate-constant&gt;</var>, as defined above; a
<var>&lt;number-of-input-compartments&gt;</var>. Its syntax is:
</p>
<div class="example">
<pre class="example">&lt;input variable&gt; = PerTransit(&lt;magnitude&gt;, &lt;period&gt;,
                              &lt;initial-time-in-period&gt;,
                              &lt;transfer-rate-constant&gt;,
                              &lt;number-of-input-compartments&gt;);
</pre></div>

<p>An demonstration of its use is given in
<samp>mcsim/examples/test_transit_input</samp>.
</p>

</li><li> <a name="index-NDoses_0028_0029-function"></a>
<a name="index-Function_002c-NDoses_0028_0029"></a>
<code>NDoses()</code> specifies a number of stepwise inputs of variable
magnitude and their starting times. The first argument, <var>&lt;n&gt;</var>, is
the number of input steps and start times. Next come a list of
magnitudes and a list of corresponding initial times. Each list is
comma-separated. The duration of each input step is computed
automatically by difference between the listed times. Currently this
function can only be used in the simulation description file, and not
in the model description file (which simply implies that you cannot
use it as a default). Syntax:

<div class="example">
<pre class="example">&lt;input variable&gt; = NDoses(&lt;n&gt;, &lt;list-of-magnitudes&gt;,
                          &lt;list-of-initial-times&gt;);
</pre></div>

<p>Instead of lists of magnitudes and times, you can use vectors
specifying them, as in:
</p>
<div class="example">
<pre class="example">My_input = NDoses(10, My_magnitudes[1-10], My_initial_times[1-10]);
</pre></div>

<p>Note that the list or vector of times <em>must</em> begin at the
starting time of the simulation (typically time zero), even if the
magnitude at that first time is zero.
</p>

</li><li> <a name="index-Spikes_0028_0029-function"></a>
<a name="index-Function_002c-Spikes_0028_0029"></a>
<code>Spikes()</code> specifies a number of instantaneous inputs of variable
magnitude and their exact times of occurrence. However, a spike
occuring exactly at the final simulation time will be ignored (see
below the Note on discontinuity). The first argument, <var>&lt;n&gt;</var>, is
the number of inputs and input times. Next come a list of magnitudes
and a list of times. Each list is comma-separated. Currently this
function can only be used in the simulation description file, and not
in the model description file (which simply implies that you cannot
use it as a default). Syntax:

<div class="example">
<pre class="example">&lt;input variable&gt; = Spikes(&lt;n&gt;, &lt;list-of-magnitudes&gt;,
                          &lt;list-of-times&gt;);
</pre></div>

</li></ul>


<p>The arguments of input functions can either be constants or variables.
For example, if &lsquo;<samp>Mag</samp>&rsquo; and &lsquo;<samp>RateConst</samp>&rsquo; are defined model
parameters, then the input variable &lsquo;<samp>Q_in</samp>&rsquo; can be defined
as:
</p>
<div class="example">
<pre class="example">Q_in = PerExp(Mag, 60, 0, RateConst);
</pre></div>

<p>In this way the parameters of input functions can, for example, be
assigned statistical distributions in Monte Carlo simulations
(see <a href="#Distrib_0028_0029-specification">Distrib() specification</a>). Variable dependencies are resolved
before each simulation specified by a <code>Simulation</code> section
(equivalently <code>Experiment</code>) (see <a href="#Simulation-sections">Simulation sections</a>).
</p>
<p>For each of the periodic functions, a single exposure beginning at time
<var>initial-time</var> can be specified by giving an effectively infinite
period,
<i>e.g.</i> 1e10.
The first period starts at the initial time of the simulation.
</p>
<p><em>Note on discontinuities</em>: Magnitudes change exactly at the times
given. At a discontinuity, the time point belongs to the NEW time period
UNLESS we are at the final time.
</p>
<p>Input variables assigned input functions can be combined to give a lot
of flexibility (<i>e.g.</i>, an input variable can be declared as the sum
of others). Separate inputs can also be declared in the global section
of the model definition file and combined in the <code>Dynamics</code>
(see <a href="#Dynamics-section">Dynamics section</a>) and <code>CalcOutputs</code> (see <a href="#Output-calculations">Output calculations</a>) sections.
</p>


<hr>
<a name="In-line-functions"></a>
<div class="header">
<p>
Next: <a href="#Model-initialization" accesskey="n" rel="next">Model initialization</a>, Previous: <a href="#Input-functions" accesskey="p" rel="prev">Input functions</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="In-line-functions-1"></a>
<h4 class="subsection">5.3.6 In line functions</h4>
<a name="index-Inline_002c-in-line-functions"></a>
<a name="index-Function_002c-Inline_002c-in-line"></a>


<p><code>Inline()</code> functions can be placed in the various sections of a
model file to introduce standard C code (or whatever) in your
models. Text placed between the parentheses of an <code>Inline</code>
function will be passed <em>as is</em> to the C compiler. That text can
span several lines but its size should not exceed MAX_EQN (defined in
<samp>lex.h</samp>); In case it does, you can increase MAX_EQN (and
recompile <samp>mod</samp>...) or you can split you text between any number
of <code>Inline()</code> in a row. It is your responsibility to make sure
that the code passed can be compiled without errors!
</p>
<p>Example:
</p>
<div class="example">
<pre class="example">Inline( printf(&quot;hello/n&quot;); );
</pre></div>

<p>You can use C compiler (in fact preprocessor) directives, such
<code>#include</code> directives, inside <code>Inline</code> statements, provided
that you use the <code>\#</code> escape sequence instead of simply the
<code>#</code> character (otherwise it is confused with a <em>GNU MCSim</em>
comment and Hell breaks loose).
</p>
<p>Example:
</p>
<div class="example">
<pre class="example">Inline( \#include &lt;gsl/gsl_interp.h&gt; );
</pre></div>

<p>This can be useful to include large amounts of C code. Note also that
the inlined code is likely to be dependent on whether or not you are
using the <code>-R</code> option of <code>mod</code>.
</p>

<hr>
<a name="Model-initialization"></a>
<div class="header">
<p>
Next: <a href="#Dynamics-section" accesskey="n" rel="next">Dynamics section</a>, Previous: <a href="#In-line-functions" accesskey="p" rel="prev">In line functions</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Model-initialization-1"></a>
<h4 class="subsection">5.3.7 Model initialization</h4>
<a name="index-Initialize_002c-initialization-section_002c"></a>
<a name="index-Scale_002c-scaling-section"></a>
<a name="index-Parameter-scaling"></a>


<p>The model initialization section begins with the keyword
<code>Initialize</code> (the keyword <code>Scale</code> is obsolete but is still
understood) and is enclosed in curly braces. The equations given in this
section will define a function (subroutine) that will be called by
<em>GNU MCSim</em> after the assignments specified in each
<code>Simulation</code> section are done (see <a href="#Simulation-sections">Simulation sections</a>). They
are the last initializations performed. The model file in
<samp>mcsim/examples/perc</samp> gives an example of the use of
<code>Initialize</code> (see <a href="#perc_002emodel">perc.model</a>, in Appendix).
</p>
<p>All model variables and parameters, except inputs, can be changed in
this section. Modifications to state variables affect initial values
only. In this section, state variables, outputs and parameters (but not
input variables) can also appear at the the right-hand side of
equations. The integration variable can be accessed if referred to as
<code>t</code>
</p>
<p>Warning: Assignments to state variables in the <code>Initialize</code> section
override the same assignments made in input files.
</p>
<p>Additional parameters (to those declared in the global section) may be
used within the section. They will be declared as local temporary
variables and their scope will be limited to the <code>Initialize</code>
section (<i>i.e.</i>, their value and existence will be forgotten outside
the section).
</p>
<p>The <code>dt()</code> operator (see <a href="#Dynamics-section">Dynamics section</a>) cannot be
used in this section, since derivatives have not yet been computed when
the scaling function is called.
</p>


<hr>
<a name="Dynamics-section"></a>
<div class="header">
<p>
Next: <a href="#Delay-differentials" accesskey="n" rel="next">Delay differentials</a>, Previous: <a href="#Model-initialization" accesskey="p" rel="prev">Model initialization</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Dynamics-section-1"></a>
<h4 class="subsection">5.3.8 Dynamics section</h4>
<a name="index-Dynamics-section"></a>


<p>The dynamics specification section begins with the keyword
<code>Dynamics</code> and is enclosed in curly braces. The equations given in
this section will be called by the integration routines at each
integration step. <code>Dynamics</code> must be used if the model includes
differential equations.
</p>
<p>Additional parameters (to those declared in the global section) may be
used for any calculations within the section. They will be declared as
local temporary variables. (Note, for example, the use of
&lsquo;<samp>Cout_fat</samp>&rsquo; and &lsquo;<samp>Cout_wp</samp>&rsquo; in the <samp>perc.model</samp> example
file). Local variables are not accessible from the simulation program,
or from other sections of the model definition file, so don&rsquo;t try to
output them.
</p>
<p>Each state variable declared in the global section must have one
corresponding differential equation in the <code>Dynamics</code>
section. If a differential equation is missing, <code>mod</code> issues an
error message such as:
</p>
<div class="example">
<pre class="example">Error: State variable 'Q_foo' has no dynamics.
</pre></div>

<p>and no <samp>model.c</samp> file or executable program will be created.
</p>
<a name="index-Dt_0028_0029-operator"></a>
<a name="index-Derivative-specification"></a>
<p>The derivative of a state variable is defined using the <code>dt()</code>
operator, as shown here:
</p>
<div class="example">
<pre class="example">dt(state-variable) '=' constant-value-or-expression ';'
</pre></div>

<p>The right-hand side can be any valid C expression, including standard
math library calls and the special functions mentioned above
(see <a href="#Special-functions">Special functions</a>). Note that no syntactic check is performed
on the library function calls. Their correctness is your
responsibility.
</p>
<p>The <code>dt()</code> operator can also be used in the right-hand side of
equations in the dynamics section to refer to the value of a derivative
at that point in the calculations. For example:
</p>
<div class="example">
<pre class="example">dt(Qm_in) = Qmetabolized - dt(Qm_out);
</pre></div>

<a name="index-Integration-variable"></a>
<p>The integration variable (<i>e.g.</i>, time) can be accessed if referred
to as <code>t</code>, as in:
</p>
<div class="example">
<pre class="example">dt(Qm_in) = Qmetabolized - t;
</pre></div>

<p>Output variables can also be made a function of <code>t</code> in the
<code>Dynamics</code> section.
</p>
<p>Note that while state variables, input variables and model parameters
can be used on the right-hand side of equations, they cannot be assigned
values in the <code>Dynamics</code> section. If you need a parameter to
change with time, you can declare it as an output variable in the global
section. Assignments to states, inputs or parameters in this section
causes an error message like the following to be issued:
</p>
<div class="example">
<pre class="example">Error: line 48: 'YourParm' used in invalid context.
Parameters cannot be defined in Dynamics{} section.
</pre></div>

<p>Note also that, in <code>Dynamics</code>, output variables should be assigned
a value or equation before being used. You cannot assume that the value
computed during a previous call to the function is valid, because the
integrator may have taken too long a time step, for example. The
integrator keeps track of state variables only.
</p>


<hr>
<a name="Delay-differentials"></a>
<div class="header">
<p>
Next: <a href="#Output-calculations" accesskey="n" rel="next">Output calculations</a>, Previous: <a href="#Dynamics-section" accesskey="p" rel="prev">Dynamics section</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Delay-differential-equations"></a>
<h4 class="subsection">5.3.9 Delay differential equations</h4>
<a name="index-Delay-differential-equations"></a>

<p><em>GNU MCSim</em> can solve delay differential equations.
</p>
<p>Delay differential equations are equations that depend on <em>past</em>
values of the state variables, say at time <var>t-tau</var> instead of at
time <var>t</var>.
</p>
<p>This is done very easily in <em>GNU MCSim</em> models with the
<code>CalcDelay</code> funtion. Its syntax is:
</p>
<div class="example">
<pre class="example">  CalcDelay (&lt;variable&gt;, &lt;delay&gt;);
</pre></div>

<p>The <code>variable</code> must be a declared state or output
variable. <code>CalcDelay()</code> will return its past value (at time
<var>delay</var>). The <var>delay</var> specified must be either a declared
parameter or a constant floating point or integer value. For
example:
</p>
<div class="example">
<pre class="example">  tau = 100;
  dt (Q1) = k * CalcDelay(Q3, tau);
  dt (Q2) = k * CalcDelay(Q3, 10);
</pre></div>

<p>An example of a model using <code>CalcDelay()</code> and input file is given
in the <samp>example/delay_diff_eqns</samp> folder. Note that currently, the
<code>CalcDelay()</code> function cannot be used with the <code>-R</code> option for
<code>mod</code> (<em>i.e.</em>, for use with the deSolve R package).
</p>
<p><em>GNU MCSIm</em> stores required variables past values in a arrays of
size MAX_DELAY (equal by default to 1000). If the needed past recall
exceeds that capacity you will need to increase the value of MAX_DELAY
in the C file <samp>delays.c</samp> and recompile the library and your
model.
</p>


<hr>
<a name="Output-calculations"></a>
<div class="header">
<p>
Next: <a href="#Comments-on-style" accesskey="n" rel="next">Comments on style</a>, Previous: <a href="#Delay-differentials" accesskey="p" rel="prev">Delay differentials</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Output-calculations-1"></a>
<h4 class="subsection">5.3.10 Output calculations</h4>
<a name="index-CalcOutputs_002c-output-section"></a>
<a name="index-Output-specification"></a>


<p>The output calculation section begins with the keyword
<code>CalcOutputs</code> and is enclosed in curly braces. The equations
given in this section will be called by the simulation program at each
output time specified by a <code>Print()</code> or <code>PrintStep()</code>
statement (see <a href="#Print_0028_0029-specification">Print() specification</a>, and see <a href="#PrintStep_0028_0029-specification">PrintStep() specification</a>). In this way, output computations are done
efficiently, only when values are to be saved.
</p>
<p>Only variables that have been declared with the keyword <code>Outputs</code>,
or local temporary variables, can receive assignments in this
section. As in the <code>Dynamics</code> section, output variables should be
assigned a value or equation before being used. Assignments to other
types of variables cause an error message like the following to be
issued:
</p>
<div class="example">
<pre class="example">Error: line 56: 'Qb_fat' used in invalid context.
Only output and local variables can be defined in CalcOutputs section.
</pre></div>

<p>Any reference to an input or state variable will use the current value
(at the time of output). Note that <code>CalcOutputs</code> code is called
only on the correct state trajectory, but you cannot reuse past values
of outputs in your code, for example forming cumulative sums such as:
</p>
<div class="example">
<pre class="example">a = a + b;
</pre></div>

<p>The <code>dt()</code> operator can appear in the right-hand side
of equations, and refers to current values of the derivatives
(see <a href="#Dynamics-section">Dynamics section</a>). Like in the <code>Dynamics</code> section, the
integration variable can be accessed if referred to as <code>t</code>, as
in:
</p>
<div class="example">
<pre class="example">Qx_out = DQx * t;
</pre></div>



<hr>
<a name="Comments-on-style"></a>
<div class="header">
<p>
Previous: <a href="#Output-calculations" accesskey="p" rel="prev">Output calculations</a>, Up: <a href="#Syntax-of-mod-files" accesskey="u" rel="up">Syntax of mod files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Comments-on-style-1"></a>
<h4 class="subsection">5.3.11 Comments on style</h4>
<a name="index-Style"></a>


<p>For your model file to be readable and understandable, it is useful to
use a consistent notation style. The example file <samp>perc.model</samp>
tries to follow such a style (see <a href="#perc_002emodel">perc.model</a>). For example we
suggest that:
</p>
<ul>
<li> All variable names begin with a capital letter followed by meaningful
lower case subscripts.

</li><li> Where two subscripts are necessary, they can be separated by an
underscore, such as in &lsquo;<samp>Qb_fat</samp>&rsquo;.

</li><li> Where there is only one subscript an underscore can still be used to
increase readability as in &lsquo;<samp>Q_fat</samp>&rsquo;.

</li><li> Where two words are used in combination to name one item, they can be
separated visually by capitalizing each word, as in &lsquo;<samp>BodyWt</samp>&rsquo;.
</li></ul>


<p>These conventions are suggestions only. The key to have a consistent
notation that makes sense to you. Consistency is one of the best ways
to:
</p>
<ol>
<li> Increase readability, both for others and for yourself. If you
have to suspend work for a month or two and then come back to it, the
last thing you want is to have to decipher your own file.

</li><li> Decrease the likelihood of mistakes. If all of the equations are
coded with a consistent, logical convention, mistakes stand out more
readily.
</li></ol>

<p>Last, but not least, do use comments to annotate your code! Also: make
sure your comments are accurate and update them when you change your
code. In our experience, an enormous number of hours has been wasted in
trying to figure out inconsistencies that existed only because of
inaccurate comments (<i>e.g.</i>, erroneous comments about the reasons for
choice of default parameter values). That does not decrease the value of
good comments, however...
</p>


<hr>
<a name="Reading-SBML-models"></a>
<div class="header">
<p>
Next: <a href="#Working-with-deSolve" accesskey="n" rel="next">Working with deSolve</a>, Previous: <a href="#Syntax-of-mod-files" accesskey="p" rel="prev">Syntax of mod files</a>, Up: <a href="#Writing-and-Compiling-Structural-Models" accesskey="u" rel="up">Writing and Compiling Structural Models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Reading-SBML-models-and-applying-a-template"></a>
<h3 class="section">5.4 Reading SBML models and applying a template</h3>
<a name="index-SBML-models"></a>
<a name="index-Template-models"></a>


<p>To read models written in SBML, you simply need to create a text file
of the same format as an <em>MCsim</em> model definition file (comments
starting with <kbd>#</kbd>, file ending with <code>End</code>, <i>etc</i>.) In that
file, you specify a list of one or more SBML model files with the
keyword <code>SBMLModels</code> followed by an equal sign and a list of SBML
model file names (of maximum size MAX_FILENAMESIZE, 80 characters, as
defined in mod.h), enclosed in curly braces, as shown here:
</p>
<div class="example">
<pre class="example">#---------------------------------------------------------
# SBML_List.in
# Use it as &quot;mod SBML_List.in&quot;
#---------------------------------------------------------

SBMLModels = {useID, &quot;default&quot;, &quot;C_central.xml&quot;, &quot;C_periph.xml&quot;};

End.
</pre></div>

<p>The first two tokens, <code>useID</code> and <code>&quot;default&quot;</code>, at the very
beginning of the list, are optional (but if the appear they must both
appear).  The first indicates that species are recognized by &quot;IDs&quot; (at
the moment this the only possibility, hardly an option indeed, but in
the future we would like to be able also to use Names&quot;). The second
one gives the name of the default (external) compartment in your SBML
files. Here the default is named &quot;default&quot;, which works for
CellDesigner, but JDesigner, for example, uses &quot;compartment&quot;... The
list of files comes after, with the filenames being enclosed with
double quotes. There is no restriction about their extension (&quot;.xml&quot; is
just an example). They just have to be valid filenames.
</p>
<p>Give that file as input to <code>mod</code>, by typing in <code>mod
SBML_List.in</code> on your shell command line.  A <samp>model.c</samp> file is
produced, suitable for further compilation by <code>makemcsim</code>. SBML
model files are typically ASCII text files with a <i>xml</i> extension
(for examples see <samp>mcsim/sim/examples/SBML</samp>).  SBML Level 1 and
Level 2 are recognized (but some features of Level 2 are not yet
understood by <code>mod</code>, such as <code>functionDefinition</code>,
<code>unit</code>, <code>rateRule</code> and a few others.) Omitted reaction
stoichiometries are set to value 1 by default. Compartments are
ignored unless a model template for circulating species is given (see
below).
</p>
<p>If two or more of the SBML files define a same chemical species,
<code>mod</code> merges the models: namely, the rate equation for that
species will be the sum of the rate equations implied by each
model. In fact, <code>mod</code> constructs the rate equations from the
reaction descriptions given by the SBML format. State variables and
parameters keep the same name after merging, so they should be unique
from the start to each SBML model, to avoid confusion.
</p>
<p>To automatically extend SBML (level 2) models (<i>e.g.</i>, with
transport component terms, an example which will be used throughout
this part of the manual), a template model can be applied to all the
species defined in SBML which are placed in the default compartment
(conventionally called <code>compartment</code>), and outside of other
compartments whose names are specified by the template
itself. Specifically: the template model should define compartments
and differential equations terms for the transport of an unspecified
species between those compartments (the syntax for that will be
described below). For each species placed in SBML <em>outside</em> one
of the defined compartments, a differential equations is created for
each compartment using the template transport terms. The differentials
for the compartments found in both the template and the SBML models
will contain both transport and kinetic terms. With the exception of
the generic <code>compartment</code>, the SBML models merged can only use
the compartments defined by the template (compartment name recognition
is case-sensitive). Species placed in SBML <em>inside</em> one of the
defined compartments are not transported and stay local to that
compartment. Their differentials will contain only the reaction
kinetics terms defined by the SBML models. For simplicity, the default
initial values of the model state variables (species) specified by the
user are ignored and set to zero.
</p>
<p>Warning: At the moment, libSBML does not guarantee the type of operands
or their format for a division. While <code>5.4/2.3</code> will appear correctly
as a float division, <code>5.0/2.0</code> is likely to be translated in <code>5/2</code>
which is an integer division in C! It is probably best to use the multiplication
by the inverse in that case, but that forces you to check SBML models manually
for all divisions...
</p>
<p>There might be many applications of the template mechanism, and they
are left to the reader to imagine.
</p>
<p>The template model to use is specified with <code>PKTemplate</code> keyword,
followed by an equal sign and the file name of a template model file
(of maximum size MAX_FILENAMESIZE, 80 characters, as defined in
mod.h), enclosed in curly braces, like in:
</p>
<div class="example">
<pre class="example">#---------------------------------------------------------
# SBML_List.in
# Use it as &quot;mod SBML_List.in&quot;
#---------------------------------------------------------

PKTemplate = {&quot;input_f/2cpt_PBPK.model&quot;};

SBMLModels = {&quot;C_central.xml&quot;, &quot;C_periph.xml&quot;};

End.
</pre></div>

<a name="index-Compartment-keyword"></a>
<a name="index-Keyword_002c-Compartment"></a>
<a name="index-_0027_005f_0027-_0028underscore_0029-in-templates"></a>
<a name="index-Underscore-use-for-template-models"></a>
<p>The template structure is similar to that of other <em>GNU MCSim</em>
models, with two exceptions: First, the variables and parameters which
are supposed to apply to several chemical species defined in SBML are
preceeded with an underscore (<kbd>_</kbd>). Second, the compartments
allowed in SBML and for which the template is defined are declared
using the keyword <code>Compartment</code>, followed by an equal sign and a
list of the compartment names enclosed in curly braces.  Here is an
example of template file:
</p>
<div class="example">
<pre class="example">#---------------------------------------------------------
# Template for pharmacokinetic modeling
#---------------------------------------------------------

States = {_central, _periph};
Inputs = {_Dose_rate};
Outputs = {_Q_total};
Compartments = {central, peripheral};

# Species-dependent parameters
_PC = 2;
_K_urine;

# Species-independent parameters
V_central;
V_periph;

Initialize { _K_urine = _K_urine * 2; }

Dynamics {
  _Q_rate_c_p = 5 * (_central - _periph / _PC);

  # Central compartment quantity
  _pk_central  = (_Dose_rate - _Q_rate_c_p -
                  _K_urine * _central) / V_central;
  dt(_central) = _pk_central;

  # Peripheral compartment quantity
  _pk_periph  = _Q_rate_c_p / V_periph;
  dt(_periph) = _pk_periph;
 }

CalcOutputs { _Q_total = _central / V_central + _periph / V_periph; }

End.
</pre></div>

<p>With that template, each species, say <var>S1</var>, defined in SBML to be
outside of the <code>central</code> or <code>peripheral</code> compartments will
be cloned to form the state variables <var>S1_central</var> and
<var>S1_peripheral</var>. Those will have associated differential equations
using specific parameters <var>S1_PC</var> or unspecific ones like
V_central. The chemical reactions defined in SBML to take place inside
the central or peripheral compartments will be translated into
specific terms added to the <code>dt(_central)</code> and
<code>dt(_periph)</code> equations.
</p>
<p>Warning: the automatic creation of a model by merging SBML files with
a template may shuffle the order of the differential equation
declarations. Therefore you should not use an already defined
<code>dt()</code> term in a subsequent differential equation in the template
model.
</p>


<hr>
<a name="Working-with-deSolve"></a>
<div class="header">
<p>
Previous: <a href="#Reading-SBML-models" accesskey="p" rel="prev">Reading SBML models</a>, Up: <a href="#Writing-and-Compiling-Structural-Models" accesskey="u" rel="up">Writing and Compiling Structural Models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Working-with-the-R-package-deSolve"></a>
<h3 class="section">5.5 Working with the <em>R</em> package <em>deSolve</em></h3>
<a name="index-R-deSolve"></a>
<a name="index-Using-deSolve"></a>

<p><em>GNU MCSim</em> <samp>mod</samp> model generator can be passed the <code>-R</code>
option. For example:
</p>
<div class="example">
<pre class="example">  mod -R perc.model
</pre></div>

<p>In that case, the C code produced can be used by the <code>deSolve</code>
package of the <em>R</em> statistical software (see
http://www.r-project.org/) to perform simulations of your models. The
numerical integators provided by deSolve are improved implementations of
the lsode family of integrators used by <em>GNU MCSim</em>), and
<code>deSolve</code> provides a few more options than <em>GNU MCSim</em> (see
the <code>deSolve</code> user manuals). However, if you need raw speed (say,
for Markov chain Monte Carlo simulations) <em>GNU MCSim</em> is probably
the fastest option.
</p>
<p>In addition to producing a <samp>model.c</samp> file in C language, <samp>mod</samp>
called with the <code>-R</code> option also generates <samp>model_inits.R</samp>
file. That file can be loaded in <em>R</em> and provides the <em>R</em> two
functions <code>initParms</code>, <code>initStates</code> and the variable
<var>Outputs</var>,  which can be handy in <em>R</em> scripts:
</p>
<ul>
<li> <code>initParms()</code> without parameters reset the model parameters to
their default values. The <var>newparms</var> parameter takes a vector of named
parameters and values, assign the given values to the corresponding
model parameters and reset the others to their default values.

</li><li> <code>initStates()</code> with just the <var>parms</var> parameter reset the model
initial states to their default values. If the <var>newparms</var> parameter
is used it takes a vector of named states and values, assign the given
values as initial values to the corresponding model state variables and
reset the others to their default values.

</li><li> <var>Outputs</var> is simply an array of output variable names.

</li></ul>

<p>An example of R script using <code>GNU MCsim</code> to generate and run a
model is given in the <samp>example/R</samp> folder.
</p>


<hr>
<a name="Running-Simulations"></a>
<div class="header">
<p>
Next: <a href="#Common-Pitfalls" accesskey="n" rel="next">Common Pitfalls</a>, Previous: <a href="#Writing-and-Compiling-Structural-Models" accesskey="p" rel="prev">Writing and Compiling Structural Models</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Running-Simulations-1"></a>
<h2 class="chapter">6 Running Simulations</h2>
<a name="index-Specifying-simulations"></a>
<a name="index-Running-simulations"></a>
<a name="index-Simulation-definition-files"></a>


<p>After having your model processed by <code>mod</code> or <code>makemcsim</code>,
and obtained an executable <samp>mcsim_...</samp> file, you are ready to run
simulations. For this you need to write simulation files. This chapter
explains how to write such files with the proper syntax and how to run
the executable program.
</p>

<p>You may want to first give a look at the examples given in the
<samp>mcsim/examples</samp> directory. An example file <samp>perc.lsodes.in</samp>,
which works with the perchloroethylene model <samp>perc.model</samp>, is also
given in an Appendix to this manual (see <a href="#perc_002elsodes_002ein">perc.lsodes.in</a>).
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Using-the-compiled-program" accesskey="1">Using the compiled program</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to process a simulation file
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Syntax-of-simulation-files" accesskey="2">Syntax of simulation files</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">how to write a simulation file
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Analyzing-simulation-output" accesskey="3">Analyzing simulation output</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">beyond GNU MCSim...
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Error-handling" accesskey="4">Error handling</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="Using-the-compiled-program"></a>
<div class="header">
<p>
Next: <a href="#Syntax-of-simulation-files" accesskey="n" rel="next">Syntax of simulation files</a>, Up: <a href="#Running-Simulations" accesskey="u" rel="up">Running Simulations</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Using-the-compiled-program-1"></a>
<h3 class="section">6.1 Using the compiled program</h3>


<p><em>GNU MCSim</em> provides several types of simulations for the models you
create. Simulations are specified in a text file of format similar to
that of the model description file.
</p>
<p>Assume that your model <samp>a.model</samp> has been preprocessed and compiled
by <code>makemcsim</code> (see <a href="#Using-makemcsim">Using makemcsim</a>) to generate an executable
<samp>mcsim_a</samp> (if you have renamed the executable file, substitute
<samp>mcsim_my</samp> by the name of your executable in the following). In
Unix the command-line syntax to run that executable is simply:
</p>
<div class="example">
<pre class="example">mcsim_a [run-time options] [input-file [output-file]]
</pre></div>

<p>where the brackets indicate optional arguments. If no input and output
file names are specified, the program will prompt you for them. You
must provide an input file name. That file should describe the
simulations to perform and specify which outputs should be printed out
(see <a href="#Syntax-of-simulation-files">Syntax of simulation files</a>). If you just hit the return key
when prompted for the output name, the program will use the name you
have specified in the input file, if any, or a default name
(see <a href="#OutputFile_0028_0029-specification">OutputFile() specification</a>). If just one file name is given
on the command-line, the program will assume that it specifies the
input file. For the output filename, the program will then use the
name you have specified in the input file, if any, or a default
name.
</p>
<p>The following run-time options are available:
</p><ul>
<li> <code>-c</code> displays the Gelman-Rubin&rsquo;s MCMC convergence diagnostic as
simulated chains progress in parallel on different processors (if MPI
is used).

</li><li> <code>-D=print-hierarchy</code> or <code>-D print-hierarchy</code> prints out the
details of a multilevel statistical model for debugging (see <a href="#Level-sections">Level sections</a>).

</li><li> <code>-h</code> or <code>-H</code> display a short help on the program use.

</li><li> <code>-i=&lt;arg&gt;</code> or <code>-i &lt;arg&gt;</code>, where <code>arg</code> is an integer,
prints out the number of simulations done, every <code>&lt;arg&gt;</code>
iteration.

</li></ul>

<p><em>Note on parallelized code:</em> If your model has been preprocessed and
compiled by <code>makemcsimp</code> (see <a href="#Using-makemcsim">Using makemcsim</a>) to generate a
parallelization-enabled executable <samp>mcsim_a</samp>, you should run it
with a specific wrapper like <code>mpirun</code>:
</p>
<div class="example">
<pre class="example">mpirun -np 50 mcsim_a [run-time options] [input-file [output-file]]
</pre></div>

<p>The particular wrapper to use depends on the MPI library installed on
your system. In the case of Open MP <code>mpirun</code>, the number of
processors to use is specified by the <code>-np</code> option (50 processors
in the example above).
</p>
<p>When the program starts, it announces which model description file
was used to create it. While the input file is read or while
simulations are running, some informations will be printed on your
computer screen. They can help you check that the input file is
correctly interpreted and that the program runs as it
should. <em>GNU MCSim</em> can also post error messages, which should be
self-explanatory. Where appropriate, they show the line number in the
input file where the error occurred.  Beware, however, of cascades of
errors generated as a consequence of a first one; also errors may be
detected after the line in which they really occur and the line number
shown will be unhelpful; don&rsquo;t panic: start by fixing the first error
in the input file and rerun your executable. You should not need to
recompile your executable, unless you have changed the model
itself. If you get really stuck you can send a message to the mailing
list &quot;help-mcsim@prep.ai.mit.edu&quot; (see <a href="#Installation">Installation</a>) or to the
authors of this manual.
</p>
<p>The program ends (if everything is fine) by giving you the name of the
output file generated. If you want to run the program in batch mode (in
the background), you may want to redirect the screen output and error
messages; refer for this to the <code>man</code> pages for your shell.
</p>


<hr>
<a name="Syntax-of-simulation-files"></a>
<div class="header">
<p>
Next: <a href="#Analyzing-simulation-output" accesskey="n" rel="next">Analyzing simulation output</a>, Previous: <a href="#Using-the-compiled-program" accesskey="p" rel="prev">Using the compiled program</a>, Up: <a href="#Running-Simulations" accesskey="u" rel="up">Running Simulations</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Syntax-of-the-simulation-definition-file"></a>
<h3 class="section">6.2 Syntax of the simulation definition file</h3>
<a name="index-Simulation-file_002c-syntax"></a>
<a name="index-Syntax-of-simulation-files"></a>


<p>A simulation specification file is a text (ASCII) file that consists
of several sections, starting with global specifications and
assignments (valid throughout the file), followed by a number of
<code>Simulation</code> sections (see <a href="#Simulation-sections">Simulation sections</a>), eventually
enclosed in <code>Level</code> sections. (The keyword <code>Experiment</code> is
now obsolete but can still be used as a synonym for
<code>Simulation</code>.)
</p>
<p>It is important to note that all simulations are fundamentally
dynamic, and that time is the explicit independent variable. There can
be time-discontuities in your simulations if a input changes
instantaneously (see <a href="#Input-functions">Input functions</a>). At a discontinuity, the
time point belongs to the new time period unless we are at the final
time. Current simulation time can be accessed in your model using
variable <code>t</code>. It is possible to ignore time and write models
which do not consider it, but inputs and outputs of such models will
still refer to time. For example, you are required to specify at least
one output time to print results from your model, even though time is
inconsequent. In that case you can use an arbitrary time or sets of
times.
</p>
<p>Each <code>Simulation</code> section defines simulation conditions, from an
initial time (or whatever the dependent variable represents,
see <a href="#Model-types">Model types</a>) to a final time. Initial values of the model state
variables, parameter values, input variables time-course, and which
outputs are to be printed at which times, can all be changed in a given
<code>Simulation</code> section.
</p>
<p>In simple cases, the general layout of the file is therefore (see also
the example file in <a href="#perc_002elsodes_002ein">perc.lsodes.in</a>):
</p>
<div class="example">
<pre class="example">

# Input file (text after # are comments)
&lt;Global assignments and specifications&gt;
Simulation {
  &lt;Specifications for first simulation&gt;
}
Simulation {
  &lt;Specifications for second simulation&gt;
}
# Unlimited number of simulation specifications
End. # Mandatory End keyword. Everything after this line is ignored

</pre></div>


<p>For Markov chain Monte Carlo simulations (see <a href="#MCMC_0028_0029-specification">MCMC() specification</a>),
the general layout of the file must include <code>Level</code> sections.
<code>Level</code> sections are used to define a hierarchy of statistical
dependencies (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>). In that case, the
general layout of the file is:
</p>
<div class="example">
<pre class="example">

# Input file
&lt;Global assignments and specifications&gt;
Level {
  # Up to 10 levels of hierarchy
  Simulation {
    &lt;Specifications and data for first simulation&gt;
  }
  Simulation {
    &lt;Specifications and data for second simulation&gt;
  }
  # Unlimited number of simulation specifications
} # end Level
End. # Mandatory keyword.

</pre></div>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#General-input-file-syntax" accesskey="1">General input file syntax</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Input-functions-revisited" accesskey="2">Input functions revisited</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Global-specifications" accesskey="3">Global specifications</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Specifying-basic-conditions-to-simulate" accesskey="4">Specifying basic conditions to simulate</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Setting_002dup-statistical-models" accesskey="5">Setting-up statistical models</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Analyzing-simulation-output" accesskey="6">Analyzing simulation output</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Error-handling" accesskey="7">Error handling</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="General-input-file-syntax"></a>
<div class="header">
<p>
Next: <a href="#Input-functions-revisited" accesskey="n" rel="next">Input functions revisited</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="General-input-file-syntax-1"></a>
<h4 class="subsection">6.2.1 General input file syntax</h4>
<a name="index-General-input-file-syntax"></a>


<p>The general syntax of the file is the same as that of structural model
definition files (see <a href="#General-syntax">General syntax</a>) except that:
</p>
<ul>
<li> No new variable can be created (all variables must have been defined in
the model definition file). Assignments can only modify the value of
already defined model variables. This implies that parameters needed to
set up a statistical model must be declared in the model definition
file, even if the structural model does not use them.

</li><li> Assignments to state variables or parameters can only use constant
numerical values; mathematical expressions are not allowed.

</li><li> Input variables&rsquo; assignments can use any input function (including the
<code>NDoses()</code> and <code>Spikes()</code> functions), an <code>Events()</code>
specification (see <a href="#Events_0028_0029-specification">Events() specification</a>) or a constant numerical
values.

</li><li> Output variables cannot receive assignments.
</li></ul>

<p>Note that vectors (see <a href="#Vectors">Vectors</a>) can be used, as in:
</p>
<div class="example">
<pre class="example">Simulation {
  y[1-10] = 1.00;
  PrintStep (y[1-5],  0, 10, 0.5);
  Print     (y[6-10], 0, 5, 10);
}
</pre></div>

<p>At the program start, all model parameters are initialized to the
nominal values specified in the model description file. Next, after the
input file is read, modifications given in its global section (including
random sampling) are applied, then those specified at each <code>Level</code>,
and finally any modifications specified by the <code>Simulation</code>
sections. Computations specified in the <code>Initialize</code> section of the
model definition file are the last initialization statements
executed.
</p>
<p>Structural changes to the model (<i>e.g.</i>, addition of a state, input,
output or parameter) cannot be done here and must be done in the model
description file. The simulation specification file is read until a
mandatory <code>End</code> keyword is reached.
</p>


<hr>
<a name="Input-functions-revisited"></a>
<div class="header">
<p>
Next: <a href="#Global-specifications" accesskey="n" rel="next">Global specifications</a>, Previous: <a href="#General-input-file-syntax" accesskey="p" rel="prev">General input file syntax</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Input-functions-_0028revisited_0029"></a>
<h4 class="subsection">6.2.2 Input functions (revisited)</h4>
<a name="index-Input-functions-2"></a>
<a name="index-Functions_002c-input-1"></a>


<p>Input variables can be assigned all the input functions defined
previously (see <a href="#Input-functions">Input functions</a>). Briefly, these are:
</p>
<ul>
<li> <a name="index-PerDose_0028_0029-function-1"></a>
<a name="index-Function_002c-PerDose_0028_0029-1"></a>
<code>PerDose()</code>:

<div class="example">
<pre class="example">PerDose(&lt;magnitude&gt;, &lt;period&gt;, &lt;initial-time&gt;, &lt;exposure-time&gt;);
</pre></div>


</li><li> <a name="index-PerExp_0028_0029-function-1"></a>
<a name="index-Function_002c-PerExp_0028_0029-1"></a>
<code>PerExp()</code>:

<div class="example">
<pre class="example">PerExp(&lt;magnitude&gt;, &lt;period&gt;, &lt;initial-time&gt;, &lt;decay-constant&gt;);
</pre></div>


</li><li> <a name="index-PerTransit_0028_0029-function-1"></a>
<a name="index-Function_002c-PerTransit_0028_0029-1"></a>
<code>PerTransit()</code>:

<div class="example">
<pre class="example">PerTransit(&lt;magnitude&gt;, &lt;period&gt;, &lt;initial-time-in-period&gt;,
           &lt;decay-constant&gt;, &lt;number-of-input-compartments&gt;);
</pre></div>


</li><li> <a name="index-NDoses_0028_0029-function-1"></a>
<a name="index-Function_002c-NDoses_0028_0029-1"></a>
<code>NDoses()</code>:

<div class="example">
<pre class="example">NDoses(&lt;n&gt;, &lt;list-of-magnitudes&gt;, &lt;list-of-initial-times&gt;);
</pre></div>


</li><li> <a name="index-Spikes_0028_0029-function-1"></a>
<a name="index-Function_002c-Spikes_0028_0029-1"></a>
<code>Spikes()</code>:

<div class="example">
<pre class="example">Spikes(&lt;n&gt;, &lt;list-of-magnitudes&gt;, &lt;list-of-times&gt;);
</pre></div>

</li></ul>

<p>In addition, they can be assigned a <code>Events()</code> specification
(see <a href="#Events_0028_0029-specification">Events() specification</a>). Again, at a discontinuity, the time
point belongs to the new time period unless we are at the final
time.
</p>
<hr>
<a name="Global-specifications"></a>
<div class="header">
<p>
Next: <a href="#Specifying-basic-conditions-to-simulate" accesskey="n" rel="next">Specifying basic conditions to simulate</a>, Previous: <a href="#Input-functions-revisited" accesskey="p" rel="prev">Input functions revisited</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Global-specifications-1"></a>
<h4 class="subsection">6.2.3 Global specifications</h4>
<a name="index-Global-specifications"></a>
<a name="index-Specifications_002c-global"></a>


<p>In the global section you can modify, by assignment, the value of
already defined state or input model variables or parameters (you cannot
assign a value to an output variable). These assignments will be in
effect throughout the input file, unless they are overridden later in
the file. Here is an exemple of assignment (assuming that <code>x</code> and
<code>Pi</code> have been properly defined in the model definition
file):
</p>
<div class="example">
<pre class="example">x = 10; # set the initial value if x is a state variable
Pi = 3; # to stop worrying about little decimals...
</pre></div>

<p>In the global section, you can also give specifications relevant to all
<code>Simulation</code> or <code>Level</code> sections. These specifications are not
needed if you just want to perform simple simulations. They should also
not appear inside <code>Simulation</code> or <code>Level</code> sections (with the
notable exception of <code>Distrib()</code> specifications which can appear
inside <code>Level</code> sections). They are used to call for and define the
parameters of special computations (<i>e.g.</i>, the number of Monte Carlo
simulations to run, which sampling distributions to use for a given
parameter, the data likelihood, <i>etc</i>.) These specifications are the
following:
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#OutputFile_0028_0029-specification" accesskey="1">OutputFile() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Integrate_0028_0029-specification" accesskey="2">Integrate() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MonteCarlo_0028_0029-specification" accesskey="3">MonteCarlo() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#MCMC_0028_0029-specification" accesskey="4">MCMC() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SetPoints_0028_0029-specification" accesskey="5">SetPoints() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#OptimalDesign_0028_0029-specification" accesskey="6">OptimalDesign() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Distrib_0028_0029-specification" accesskey="7">Distrib() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#SimType_0028_0029-specification" accesskey="8">SimType() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="OutputFile_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#Integrate_0028_0029-specification" accesskey="n" rel="next">Integrate() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="OutputFile_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>OutputFile()</code> specification</h4>
<a name="index-OutputFile_0028_0029-specification"></a>
<a name="index-Specification_002c-OutputFile_0028_0029"></a>


<p>The <code>OutputFile()</code> specification allows you to specify a name for
the output file of basic simulations. If this specification is not given
the name <samp>sim.out</samp> is used if none has been supplied on the
command-line or during the initial dialog. The corresponding syntax
is:
</p>
<div class="example">
<pre class="example">OutputFile(&quot;&lt;OutputFilename&gt;&quot;);
</pre></div>

<p>where the character string <var>&lt;OutputFilename&gt;</var>, enclosed in double
quotes, should be a valid file name for your operating system.
</p>


<hr>
<a name="Integrate_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#MonteCarlo_0028_0029-specification" accesskey="n" rel="next">MonteCarlo() specification</a>, Previous: <a href="#OutputFile_0028_0029-specification" accesskey="p" rel="prev">OutputFile() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Integrate_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>Integrate()</code> specification</h4>
<a name="index-Integrate_0028_0029-specification"></a>
<a name="index-Specification_002c-Integrate_0028_0029"></a>
<a name="index-Lsodes-integrator"></a>
<a name="index-Integration-routine_002c-Lsodes"></a>
<a name="index-Cvodes-integrator"></a>
<a name="index-Integration-routine_002c-Cvodes"></a>
<a name="index-Euler-integrator"></a>
<a name="index-Integration-routine_002c-Euler"></a>


<p>The integrator settings can be changed with the <code>Integrate</code>
specification. Three integration routines can be used: <code>Lsodes</code>
(which originates from the SLAC Fortran library and is originally
based on Gear&rsquo;s routine) (Gear, 1971b; Gear, 1971a; Press et al.,
1989) (see <a href="#Bibliographic-References">Bibliographic References</a>), <code>Cvodes</code> (from the
Sundials library <a href="https://computation.llnl.gov/projects/sundials">https://computation.llnl.gov/projects/sundials</a>)
which may be more stable than <code>Lsodes</code> in difficult cases,
and <code>Euler</code> (Press et al., 1989).
</p>
<p>The syntax for <code>Lsodes</code> is:
</p>
<div class="example">
<pre class="example">Integrate(Lsodes, &lt;rtol&gt;, &lt;atol&gt;, &lt;method&gt;);
</pre></div>

<p>where <var>&lt;rtol&gt;</var> is a floating point scalar specifying the relative
error tolerance for each integration step. The floating point scalar
<var>&lt;atol&gt;</var> specifies the absolute error tolerance parameter. Those
tolerances are used for all state variables. The estimated local error
for a state variable <var>y</var> is controlled so as to be roughly less
(in magnitude) than
<var>rtol</var>*|<var>y</var>| + <var>atol</var>.
Thus the local error test passes if, for each state variable, either
the absolute error is less than <var>&lt;atol&gt;</var>, or the relative error is
less than <var>&lt;rtol&gt;</var>. Set <var>&lt;rtol&gt;</var> to zero for pure absolute
error control, and set <var>&lt;atol&gt;</var> to zero for pure relative error
control. Caution: actual (global) errors may exceed these local
tolerances, so choose them conservatively.
</p>
<p>The <var>&lt;method&gt;</var> flag should be 0 (zero) for non-stiff differential
systems and 1 or 2 for stiff systems. If you specify <var>&lt;method&gt;</var> 2
you should provide the Jacobian of your differential system (see the
&ldquo;Perc&rdquo; model in the example folder); otherwise the Jacobian will be
computed by numerical differentiation (which is about as fast if the
Jacobian is dense). You should try flag 0 or 1 and select the fastest
for equal accuracy of output, unless insight from your system leads you
to choose one of them <i>a priori</i>. In our experience, a good starting
point for <var>&lt;atol&gt;</var> and <var>&lt;rtol&gt;</var> is about
1e-6.
</p>

<p>The syntax for <code>Cvodes</code> is:
</p>
<div class="example">
<pre class="example">Integrate(Cvodes, &lt;rtol&gt;, &lt;atol&gt;, &lt;maxsteps&gt;, &lt;maxnef&gt;, &lt;maxcor&gt;,
          &lt;maxncf&gt;, &lt;nlscoef&gt;);
</pre></div>

<p><var>&lt;atol&gt;</var> and <var>&lt;rtol&gt;</var> have the same meaning as for
<code>Lsodes</code>, above.
</p>
<p>The <var>&lt;maxsteps&gt;</var> is an integer secifying the maximum number of
internal steps taken before exiting a Cvodes call; the default value
in Sundials is 500. <var>maxnef</var> is an integer specifying the maximum
number of error test failures accepted; the default value in Sundials
is 7. <var>maxcor</var> is an integer giving the maximum number of
nonlinear iterations attempted; the default value in Sundials is
3. <var>maxncf</var> is again an integer specifying the maximum number of
convergence failures accepted; the default value in Sundials is
10. Finally, <var>nlscoef</var> is a floating point scaler corresponding to
the coefficient of the nonlinear convergence test; the default value
in Sundials is 0.1:
</p>
<p>Example of use:
</p><div class="example">
<pre class="example">Integrate(Cvodes, 1E-6, 1E-6, 500, 7, 3, 10, 0.1);
</pre></div>


<p>The syntax for <code>Euler</code> is:
</p>
<div class="example">
<pre class="example">Integrate(Euler, &lt;time-step&gt;);
</pre></div>

<p>where <var>&lt;time-step&gt;</var> is a scalar specifying the constant time
increment for each integration step.
</p>
<p>Note: if the <code>Integrate()</code> specification is not used, the default
integration method is <code>Lsodes</code> with parameters
1e-5, 1e-7 and 1.
We recommend using <code>Lsodes</code>, since is it highly accurate and
efficient. <code>Euler</code> can be used for special applications
(<i>e.g.</i>, in system dynamics) where a constant time step and a simple
algorithm are needed.
</p>


<hr>
<a name="MonteCarlo_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#MCMC_0028_0029-specification" accesskey="n" rel="next">MCMC() specification</a>, Previous: <a href="#Integrate_0028_0029-specification" accesskey="p" rel="prev">Integrate() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="MonteCarlo_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>MonteCarlo()</code> specification</h4>
<a name="index-MonteCarlo_0028_0029-specification"></a>
<a name="index-Specification_002c-MonteCarlo_0028_0029"></a>
<a name="index-Monte-Carlo-simulations-1"></a>


<p>Monte Carlo simulations (Hammersley and Handscomb, 1964; Manteufel,
1996) (see <a href="#Bibliographic-References">Bibliographic References</a>) randomly sample parameter
values and run the model for each parameter set so generated. The
statistical distribution of the model outputs can be studied for
uncertainty analysis, sensitivity analysis <i>etc</i>. Such simulations
require the use of two specifications, <code>MonteCarlo()</code> and
<code>Distrib()</code>, which must appear in the global section of the file,
before the <code>Simulation</code> sections. They are ignored if they appear
inside a <code>Simulation</code> section.
</p>
<p>The <code>MonteCarlo</code> specification gives general information required
for the runs: the output file name, the number of runs to perform, and a
starting seed for the random number generator. Its syntax is:
</p>
<div class="example">
<pre class="example">MonteCarlo(&quot;&lt;OutputFilename&gt;&quot;, &lt;nRuns&gt;, &lt;RandomSeed&gt;);
</pre></div>

<p>The character string <var>&lt;OutputFilename&gt;</var>, enclosed in double
quotes, should be a valid filename for your operating system. If a
null-string &quot;&quot; is given, the default name <samp>simmc.out</samp> will be
used. The number of runs <var>&lt;nRuns&gt;</var> should be an integer, and is
only limited by either your storage space for the output file or the
largest (long) integer available on your machine. When using the GNU
Scientific Library, the seed <var>&lt;RandomSeed&gt;</var> of the pseudo-random
number generator can be any positive integer (including zero). When
using the native code, it can be any positive real number (seeds
between 1.0 and 2147483646.0 are used as is, the others are rescaled
silently within those bounds). Here is an example of use:
</p>
<div class="example">
<pre class="example">MonteCarlo(&quot;percsimmc.out&quot;, 50000, 9386);
</pre></div>

<p>The parameters&rsquo; sampling distributions are specified by a list of
<code>Distrib()</code> specifications, as explained in the following
(see <a href="#Distrib_0028_0029-specification">Distrib() specification</a>). The format of the output file of
Monte Carlo simulations is discussed later (see <a href="#Analyzing-simulation-output">Analyzing simulation output</a>).
</p>
<p><em>Note on parallelized code</em>: If your model has been preprocessed
and compiled by <code>makemcsimp</code> (see <a href="#Using-makemcsim">Using makemcsim</a>) to
generate a parallelization-enabled executable, the number of Monte
Carlo simulations requested will be split evenlly between the
recruited processors and computed in parallel. The number of
processors to use should specified on the calling command-line with
the <code>-np</code> option (see <a href="#Using-the-compiled-program">Using the compiled program</a>).
</p>

<hr>
<a name="MCMC_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#SetPoints_0028_0029-specification" accesskey="n" rel="next">SetPoints() specification</a>, Previous: <a href="#MonteCarlo_0028_0029-specification" accesskey="p" rel="prev">MonteCarlo() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="MCMC_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>MCMC()</code> specification</h4>
<a name="index-MCMC_0028_0029-specification"></a>
<a name="index-Specification_002c-MCMC_0028_0029"></a>
<a name="index-Markov_002dchain-Monte-Carlo-simulations-1"></a>
<a name="index-MCMC-simulations-1"></a>

<p>Markov chain Monte Carlo (<em>MCMC</em>) can be defined as stochastic
simulations following a Markov chain in a given parameter space. In
MCMC simulations, the random choice of a new parameter value is
influenced by the current value. They can be used to obtain a sample
of parameter values from complex distribution functions, eventually
intractable analytically. Such complex distribution functions are
typically encountered during Bayesian data analysis, under the guise
of posterior distributions of a model&rsquo;s parameters. The reader wishing
to use the MCMC capabilities of <em>GNU MCSim</em> is referred to the
published literature (for example, Bernardo and Smith, 1994; Gelman,
1992; Gelman et al., 1995; Gelman et al., 1996; Gilks et al., 1996;
Smith, 1991; Smith and Roberts, 1993) (see <a href="#Bibliographic-References">Bibliographic References</a>).
</p>
<p>MCMC simulation chains (which in <em>GNU MCSim</em> start from a sample from
the specified prior) need to reach &quot;<em>equilibrium</em>&quot;. Checking that
equilibrium is obtained is best achieved, in our opinion, by running
multiple independent chains (<i>cf.</i> Gelman and Rubin, 1992, and other
relevant statistical literature). <em>GNU MCSim</em> does not deal (yet)
with convergence issues.
</p>
<p>The Bayesian analysis of data with <em>GNU MCSim</em> requires you to
setup:
</p>
<ul class="no-bullet">
<li>- a <i>structural model</i> (see <a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a>),

</li><li>- a <i>statistical model</i> (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>),

</li><li>- <i>prior distributions</i> for the model parameters you want to sample and
&quot;<em>data likelihoods</em>&quot; (defining the probability of some observed
realizations of the modeled process, conditionally to the model)
(see <a href="#Distrib_0028_0029-specification">Distrib() specification</a>).

</li></ul>

<p>Setting-up a statistical model requires <code>Level</code> sections and
<code>Data()</code> specifications. Assigning priors and likelihoods is
achieved through the <code>Distrib()</code> statements (or its equivalents
<code>Density()</code> and <code>Likelihood()</code>). Please refer to the
corresponding sections of this manual, if you are not familiar with
them. The <code>MCMC()</code> statement, gives general directives for MCMC
simulations and has the following syntax:
</p>
<div class="example">
<pre class="example">MCMC(&quot;&lt;OutputFilename&gt;&quot;, &quot;&lt;RestartFilename&gt;&quot;, &quot;&lt;DataFilename&gt;&quot;,
     &lt;nRuns&gt;, &lt;simTypeFlag&gt;, &lt;printFrequency&gt;, &lt;itersToPrint&gt;,
     &lt;RandomSeed&gt;);
</pre></div>

<p>The character strings <var>&lt;OutputFilename&gt;</var>, <var>&lt;RestartFilename&gt;</var>,
and <var>&lt;DataFilename&gt;</var>, enclosed in double quotes, should be valid
file names for your operating system. If a null-string &quot;&quot; is given
instead of the output file name, the default name
<samp>MCMC.default.out</samp> will be used.
</p>
<p>If a restart file name is given, the first simulations will be read from
that file (which must be a text file). This allows you to continue a
simulated Markov chain where you left it, since an MCMC output file can
be used as a restart file with no change. Note that the first line of
the file (which typically contains column headers) is skipped. Also, the
number of lines in the file must be less than or equal to
<var>&lt;nRuns&gt;</var>. The first column of the file should be integers, and the
following columns (tab- or space-separated) should give the various
parameters, in the same order as specified in the list of
<code>Distrib()</code> specifications in the input file.
</p>
<p>If a data file name is given, the observed (data) values for the
simulated outputs will be read from that file (in ASCII format);
otherwise, <code>Data()</code> specifications (see <a href="#Data_0028_0029-specification">Data() specification</a>)
should be provided. We recommend that you use <code>Data()</code>
specifications rather that the data file, which is much more error
prone. The first line of the data file is skipped and can be used for
comments. The total number of data points should equal the total number
of outputs requested. The data values should be given on the second and
following lines, separated by white spaces or tabs. A data value of &quot;-1&quot;
will be treated as &quot;missing data&quot; and ignored in likelihood
calculations. The convention &quot;-1&quot; can be changed by changing
INPUT_MISSING_VALUE in the header file <samp>mc.h</samp> and recompiling the
entire library.
</p>
<p>The integer <var>&lt;nRuns&gt;</var> gives the total number of runs to be
performed (<em>i.e.</em>, the number of posterior samples to draw),
including the runs eventually read in the restart file.
</p>
<p><em>Note on parallelized code</em>: If your model has been preprocessed
and compiled by <code>makemcsimp</code> (see <a href="#Using-makemcsim">Using makemcsim</a>) to
generate a parallelization-enabled executable, <em>GNU MCSim</em> will
run, in parallel, as many simulated Markov chains (of length
<var>&lt;nRuns&gt;</var>) as there are available processors. The number of
processors to use (hence, of chains to run) should specified on the
calling command-line with the <code>-np</code> option (see <a href="#Using-the-compiled-program">Using the compiled program</a>). You can assess the chains&rsquo; convergence in real
time with the Gelman-Rubin&rsquo;s MCMC convergence diagnostic with the
run-time command line option <code>-c</code> (see <a href="#Using-the-compiled-program">Using the compiled program</a>)
</p>
<p>The next field, <var>&lt;simTypeFlag&gt;</var> should be between 0 and 4
(included):
</p>
<ul>
<li> It should be set at zero to start a chain of MCMC simulations. In that
case, parameters are updated by Metropolis steps, one at a
time.

</li><li> If <var>&lt;simTypeFlag&gt;</var> = 1, a restart file must also be specified. The
output file will contain codes for the level sequence, simulation
numbers, printing times, data values and the corresponding model
predictions, computed using the last parameter vector of the restart
file. This is useful to quickly check the model fit to the
data.

</li><li> If <var>&lt;simTypeFlag&gt;</var> is equal to 2, a restart file must also be
specified and that entire file is used to compute the parameters&rsquo;
covariance matrix. All parameters are then updated at once using a
multivariate normal kernel as proposal distribution of the Metropolis
steps. This may result in large improvement in speed. However, we
recommend that this option be used only when convergence is
approximately obtained (therefore, you should run MCMC simulations
with <var>&lt;simTypeFlag&gt;</var> set to 0 first, up to approximate
convergence, and then restart the chain with the flag at 2).

</li><li> <a name="index-InvTemperature_0028_0029-specification"></a>
<a name="index-Specification_002c-InvTemperature_0028_0029"></a>
<a name="index-Tempered-MCMC"></a>
<a name="Tempered-MCMC"></a>With <var>&lt;simTypeFlag&gt;</var> equal to 3 or 4,
component by component simulated tempering is performed (Geyer and
Thompson, 1995) (see <a href="#Bibliographic-References">Bibliographic References</a>). With option 3, the
whole posterior is tempered (as in Geyer and Thompson)
(see <a href="#Bibliographic-References">Bibliographic References</a>). With option 4, only the likelihood
is tempered (thermodynamic integration, as in Calderhead and Girolami
(2009). In those cases, a grid of inverse temperatures (perks) is
first determined automatically for you (diagnostic are printed out to
the file <samp>...out.perks</samp>), unless you define your own perks scale with the
<code>InvTemperature()</code> specification:

<div class="example">
<pre class="example">InvTemperature(&lt;nValues&gt;, &lt;value 1&gt;, &lt;...&gt;, &lt;value n&gt;);
</pre></div>

<p>The first number of the specification gives the number of perks to use
and is followed by a list of them. Those should be numbers in the
interval [0,infinity[. Values above 1 lead in fact to simulated
annealing (sharpening of the posterior distribution), suitable for
optimization (see Amzal et al. 2006) (see <a href="#Bibliographic-References">Bibliographic References</a>). For simulated tempering, including thermodynamic
integration, you should have perks lower or equal to 1. You usually
want to include the value 1 (since that perk corresponds to your
target distribution). At perk zero, the posterior distribution is
uniform for all parameters in the case of posterior tempering, or
equal to the prior in the case of likelihood tempering. Each time the
simulated Markov chain reaches perk zero is a regeneration time (Geyer
and Thompson, 1995). Samples obtained at perk 1 between regeneration
times are guaranteed to be from the posterior distribution, so that
only one chains needs to be run and convergence need not to be checked
(a significant advantage of simulated tempering). Simulated tempering
is also adapted to problems with multiple maxima of the posterior
distribution, in which standard samplers or Hamiltonian MCMC usually
get stuck in a local mode. See <a href="#Analyzing-simulation-output">Analyzing simulation output</a> for
the output format of tempered MCMC simulations.
</p>
</li><li> Finally with <var>&lt;simTypeFlag&gt;</var> set to 5, GNU MCSim does stochastic
optimization (an MCMC in which only, but all, jumps leading posterior
density improvement are accepted).

</li></ul>


<p>The integer <var>&lt;printFrequency&gt;</var> should be set to 1 if you want an
output at each iteration, to 2 if you want an output at every other
iteration etc. The parameter <var>&lt;itersToPrint&gt;</var> is the number of
final iterations for which output is required (<i>e.g.</i>, 1000 will
request output for the last 1000 iterations; to print all iterations
just set this parameter to the value of <var>&lt;nRuns&gt;</var>). Note that if
no restart file is used, the first iteration is always printed,
regardless of the value of <var>&lt;itersToPrint&gt;</var>. Finally, when using
the GNU Scientific Library, the seed <var>&lt;RandomSeed&gt;</var> of the
pseudo-random number generator can be any positive integer (including
zero). When using the native code, it can be any positive real number
(seeds between 1.0 and 2147483646.0 are used as is, the others are
rescaled silently within those bounds).
</p>
<p>In the case of component by component jumps (<var>&lt;simTypeFlag&gt;</var> set to
0), tempered or stochastic optimization (<var>&lt;simTypeFlag&gt;</var> set to 3 or
higher), the jump kernel is saved with the same name as the output file,
with a <var>.kernel</var> extension. If the simulations are restarted in a
continuation mode and if a kernel file with the same name as the restart
file (with an added <var>.kernel</var> extension) is present, the jump kernel
is restored.
</p>
<p>Finally, the format of the output file of MCMC simulations is quite
similar to that of straight Monte Carlo simulations and will discussed
in a later section (see <a href="#Analyzing-simulation-output">Analyzing simulation output</a>).
</p>


<hr>
<a name="SetPoints_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#OptimalDesign_0028_0029-specification" accesskey="n" rel="next">OptimalDesign() specification</a>, Previous: <a href="#MCMC_0028_0029-specification" accesskey="p" rel="prev">MCMC() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="SetPoints_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>SetPoints()</code> specification</h4>
<a name="index-SetPoints_0028_0029-specification"></a>
<a name="index-Specification_002c-SetPoints_0028_0029"></a>


<p>To impose a series of set points (<i>i.e.</i>, already tabulated values for
the parameters), the global section can include a <code>SetPoints()</code>
specification. It allows you to perform additional simulations with
previously Monte Carlo sampled parameter values, eventually filtered.
You can also generate parameters values in a systematic fashion, over a
grid for example, with another program, and use them as input to
<em>GNU MCSim</em>. Importance sampling, Latin hypercube sampling, grid
sampling, can be accommodated in this way.
</p>
<p>This command specifies an output filename, the name of a text file
containing the chosen parameter values, the number of simulations to
perform and a list of model parameters to read in. Parameters can mix
scalar and vector notations. It has the following syntax:
</p>
<div class="example">
<pre class="example">SetPoints(&quot;&lt;OutputFilename&gt;&quot;, &quot;&lt;SetPointsFilename&gt;&quot;, &lt;nRuns&gt;,
          &lt;parameter identifier&gt;, &lt;parameter identifier&gt;, ...);
</pre></div>

<p>If a null string is given for the output filename, the set points output
will be written to the same default output file used for Monte Carlo
analyses, <samp>simmc.out</samp>.
</p>
<p>The <var>SetPointsFilename</var> is required and must refer to an existing
file containing the parameter values to use. The first line of the set
points file is skipped and can contain column headers, for
example. Each of the other lines should contain an integer (<i>e.g.</i>,
the line number) followed by values of the various parameters in the
order indicated in the <code>SetPoints()</code> specification. If extra
fields are at the end of each line they are skipped. The first integer
field is needed but not used (this allows you to directly use Monte
Carlo output files for additional <code>SetPoints</code>
simulations).
</p>
<p>The variable <var>&lt;nRuns&gt;</var> should be less or equal to the number of
lines (minus one) in the set points file. If a zero is given, all
lines of the file are read. Finally, a comma-separated list of the
parameters or vectors to be read in the <var>SetPointsFilename</var> is
given. The format of the output file of set points simulations is
discussed below (see <a href="#Analyzing-simulation-output">Analyzing simulation output</a>).
</p>
<p>Following the <code>SetPoints()</code> specification, <code>Distrib()</code>
statements can be given for parameters not already in the list
(see <a href="#Distrib_0028_0029-specification">Distrib() specification</a>). These parameters will be sampled
accordingly before to performing each simulation. The shape parameters
of the distribution specifications can reference other parameters,
including those of the list.
</p>
<p><em>Note on parallelized code</em>: If your model has been preprocessed
and compiled by <code>makemcsimp</code> (see <a href="#Using-makemcsim">Using makemcsim</a>) to
generate a parallelization-enabled executable, the number of
<code>SetPoints</code> simulations requested will be split evenlly between
the recruited processors and computed in parallel. The number of
processors to use should specified on the calling command-line with
the <code>-np</code> option (see <a href="#Using-the-compiled-program">Using the compiled program</a>).
</p>


<hr>
<a name="OptimalDesign_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#Distrib_0028_0029-specification" accesskey="n" rel="next">Distrib() specification</a>, Previous: <a href="#SetPoints_0028_0029-specification" accesskey="p" rel="prev">SetPoints() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="OptimalDesign_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>OptimalDesign()</code> specification</h4>
<a name="index-OptimalDesign_0028_0029-specification"></a>
<a name="index-Specification_002c-OptimalDesign_0028_0029"></a>


<p>The &quot;<em>OptimalDesign</em>&quot; procedure optimizes the number and location of
observation times for experimental conditions you specify, in order to
minimize the variance of a parameter or an output you designate. It
requires a structural model (see <a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a>), a
statistical model in the form of a <code>likelihood()</code> function
(see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>), and a random set of parameter
vectors sampled from a prior distribution (using Monte Carlo or MCMC
simulations) (for example and details, see Bois et al., 1999)
(see <a href="#Bibliographic-References">Bibliographic References</a>). The statistical model used should be
quite simple and cannot not use <code>Level</code> sections (and hence cannot
be hierarchical).
</p>
<p>The <em>OptimalDesign</em> command has the following syntax:
</p>
<div class="example">
<pre class="example">OptimalDesign(&quot;&lt;OutputFilename&gt;&quot;, &quot;&lt;ParameterSampleFilename&gt;&quot;,
              &lt;nSamples&gt;, &lt;RandomSeed&gt;, &lt;Style&gt;,
              &lt;parameter identifier&gt;, &lt;parameter identifier&gt;, ...);
</pre></div>

<p>The character strings <var>&lt;OutputFilename&gt;</var>, and
<var>&lt;ParameterSampleFilename&gt;</var>, enclosed in double quotes, should be
valid file names for your operating system. If a null-string &quot;&quot; is given
instead of the output file name, the default name
<samp>simopt.default.out</samp> will be used.
</p>
<p>A parameter sample file name must be given (that file must be a text
file). The first line of the file (which typically contains column
headers) is skipped. The number of lines in the file must be less than
or equal to <var>&lt;nSamples&gt;</var>. The first column of the file should be
integers (typically row numbers), and the following columns (tab- or
space-separated) should be values of the various parameters in the
order indicated in the list at the end of the <code>OptimalDesign()</code>
specification. If extra fields are at the end of each line they are
skipped. The first integer field is needed but not used (this allows
you to directly use Monte Carlo output files for <code>OptimalDesign</code>
simulations).
</p>
<p>The integer <var>&lt;nSamples&gt;</var> indicates the number of lines to read
from the <var>&lt;ParameterSampleFilename&gt;</var> file.  When using the GNU
Scientific Library, the seed <var>&lt;RandomSeed&gt;</var> of the pseudo-random
number generator can be any positive integer (including zero). When
using the native code, it can be any positive real number (seeds
between 1.0 and 2147483646.0 are used as is, the others are rescaled
silently within those bounds). The directive <var>Style</var> should be
either the keyword <code>Forward</code> or the keyword
<code>Backward</code>. Forward optimization will start from no new data and
will add, sequentially, optimal observation times. Backward
optimization starts with the full set of observation times you propose
and delete the least informative ones, sequentially. We recommand that
you try both options. Finally, a comma-separated list of the
parameters to be read in the <var>ParameterSamplFilename</var> should be
given.
</p>
<p>The input file must then contain two sets of <code>Simulation</code>
definitions. You should look at the sample optimal design files
provided in <samp>mcsim/examples</samp>.
</p>
<p>The first set specifies all experimental conditions and the set of
observation times to optimize, for one or several output variables
given in <code>Print</code> statements. The output times you specify for
each output variable define an array of observation time values that
the optimization algorithm will rank by order of the estimated
variance reduction they permit for variables or parameters you will
specify in the second set of <code>Simulation</code> definitions. Data will
be simulated for each of the required output. There must be one Data
statement per output specified (the data values are arbitrary). An
error model must be specified for those data, using a
<code>Likelihood</code> statement (see <a href="#Distrib_0028_0029-specification">Distrib() specification</a>).
</p>
<p>The second set of <code>Simulation</code> specifies optimization target
parameters or outputs. The algorithm will select time-points (in the
first section&rsquo;s <code>Simulation</code> specifications) that minimize the
estimation variance of those parameters or outputs. When a parameter is
targeted no inputs are needed. If you optimize for an output variable
variance (<i>i.e.</i>, for the variance of a model prediction), the
experimental conditions can be very different from those of the
experiment whose conditions you optimize. The link is afforded solely by
the parameters (in the first set you are trying to determine the
conditions that will optimally identify the parameter values
conditioning the predictions &ndash; or trivially, the parameters &ndash; of the
second set)
</p>
<p>The format of the output file of design optimization simulations is
quite specific. The first column is an iteration number. At each
iteration one observation point is added (<code>Forward</code> mode) or
removed (<code>Backward</code> mode). Each step is therefore conditioned by
the selection of an observation time-point made by the previous
step. The following columns give, for each observation time point you
specify, the average variance of the target outputs or parameters
achieved if this point is added (<code>Forward</code> mode) or removed
(<code>Backward</code> mode). Next the chosen time point at this step is given
(the one minimizing average variance), followed by the variance it leads
to (in expectation) and the corresponding standard deviation. The last
column &quot;Utility&quot; is zero, unless you uncomment the function
<code>Compute_utility</code> and modify its code in <samp>optdesign.c</samp> to
compute a utility of your own.
</p>


<hr>
<a name="Distrib_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#SimType_0028_0029-specification" accesskey="n" rel="next">SimType() specification</a>, Previous: <a href="#OptimalDesign_0028_0029-specification" accesskey="p" rel="prev">OptimalDesign() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Distrib_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>Distrib()</code> specification</h4>
<a name="index-Distrib_0028_0029-specification"></a>
<a name="index-Specification_002c-Distrib_0028_0029"></a>

<p>The specification of distributions for simple Monte Carlo simulations
is quite straighforward. MCMC simulations require the definition of a
full statistical model and the use of distributions is somewhat more
complex in that case, but the use of <code>Distrib()</code> is basically the
same.
</p>
<p><strong>In the context of <code>MonteCarlo()</code> or <code>SetPoints()</code>
simulations</strong> (see <a href="#MonteCarlo_0028_0029-specification">MonteCarlo() specification</a>, and <a href="#SetPoints_0028_0029-specification">SetPoints() specification</a>), one (and only one) <code>Distrib()</code> specification must
be included for each model parameter to randomly sample. State, input or
output variables cannot be randomly sampled by <code>Distrib()</code> in this
context. A simulation specification file can include any number of
<code>Distrib()</code> commands at the global level.
</p>
<p><code>Distrib()</code> specifies the name of the parameter to sample, and its
sampling distribution. Its syntax is:
</p>
<div class="example">
<pre class="example">Distrib(&lt;parameter identifier&gt;, &lt;distribution-name&gt;,
        [&lt;shape parameters&gt;]);
</pre></div>

<p>The <var>&lt;parameter identifier&gt;</var> gives the name of the parameter to
sample. The <var>&lt;distribution-name&gt;</var> and the corresponding
<var>&lt;shape parameters&gt;</var> indicate the sampling distribution to use
(Bernardo and Smith, 1994; Gelman et al., 1995) (see <a href="#Bibliographic-References">Bibliographic References</a>). They are specified as follow:
</p>
<ul>
<li> <a name="index-Beta-distribution"></a>
<a name="index-Distribution_002c-Beta"></a>
<code>Beta</code>, takes at least two strictly positive real shape parameters:
<var>A</var> and <var>B</var>. By default the Beta distribution is defined over
the interval [0;1]. If a range is given for the beta distribution, the
[0;1] interval is mapped onto the specified range.

</li><li> <a name="index-Binomial-distribution"></a>
<a name="index-Distribution_002c-Binomial"></a>
<code>Binomial</code>, needs two strictly positive numbers: the probability
<var>p</var> (a real in the interval [0;1]), and the sample size <var>N</var>, an
integer. If <var>N</var> is not given as an integer it will be rounded down
during the computations.

</li><li> <a name="index-Cauchy-distribution"></a>
<a name="index-Cauchy-distribution-1"></a>
<a name="index-Distribution_002c-Cauchy"></a>
<a name="index-Distribution_002c-Cauchy-1"></a>
<code>Cauchy</code>, takes one strictly positive real number as parameter:
its scale <var>s</var>.

</li><li> <a name="index-Chi2-distribution"></a>
<a name="index-Chi_002dsquare-distribution"></a>
<a name="index-Distribution_002c-Chi2"></a>
<a name="index-Distribution_002c-Chi_002dsquare"></a>
<code>Chi2</code>, takes one strictly positive real number as parameter:
<var>n</var>. This distribution is the same as Gamma(<var>n</var>/2, 1/2).

</li><li> <a name="index-Exponential-distribution"></a>
<a name="index-Distribution_002c-Exponential"></a>
<code>Exponential</code>, uses one strictly positive real number: the
inverse-scale <var>b</var>. 

</li><li> <a name="index-Gamma-distribution"></a>
<a name="index-Distribution_002c-Gamma"></a>
<code>Gamma</code>, uses two strictly positive real parameter: the shape and
the inverse scale.

</li><li> <a name="index-HalfCauchy-distribution"></a>
<a name="index-Distribution_002c-HalfCauchy"></a>
<code>HalfCauchy</code>, takes one strictly positive real number as
parameter: the scale <var>s</var>. The mode is at zero, on the lower
boundary. The random variates returned are strictly positive.

</li><li> <a name="index-HalfNormal-distribution"></a>
<a name="index-Distribution_002c-HalfNormal"></a>
<code>HalfNormal</code>, takes one real number as parameter: the standard
deviation, strictly positive.  The mode is at zero, on the lower
boundary. The random variates returned are strictly positive.

</li><li> <a name="index-InvGamma-distribution"></a>
<a name="index-Inverse_002dgamma-distribution"></a>
<a name="index-Distribution_002c-inverse_002dgamma"></a>
<a name="index-Distribution_002c-InvGamma"></a>
<code>InvGamma</code> (inverse gamma distribution), needs two strictly
positive real parameters: the shape and the scale.

</li><li> <a name="index-LogNormal-distribution"></a>
<a name="index-Distribution_002c-LogNormal"></a>
<code>LogNormal</code>, takes two reals numbers as parameters: the geometric
mean (exponential of the mean in log-space) and the geometric standard
deviation (exponential, strictly superior to 1, of the standard
deviation in log-space).

</li><li> <a name="index-LogNormal_005fv-distribution"></a>
<a name="index-Distribution_002c-LogNormal_005fv"></a>
<code>LogNormal_v</code>, is the lognormal distribution with the variance (in
log space!) instead of the standard deviation as second parameter. You
can use it to specify a hierarchical model with a conjugate prior on the
variance (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).

</li><li> <a name="index-LogUniform-distribution"></a>
<a name="index-Distribution_002c-Loguniform"></a>
<code>LogUniform</code>, with two shape parameters: the minimum and the
maximum of the sampling range (real numbers) in natural space.

</li><li> <a name="index-Normal-distribution"></a>
<a name="index-Distribution_002c-Normal"></a>
<code>Normal</code>, takes two reals numbers as parameters: the mean and the
standard deviation, the latter being strictly positive.

</li><li> <a name="index-NegativeBinomial-distribution"></a>
<a name="index-Distribution_002c-NegativeBinomial"></a>
<code>NegativeBinomial</code>, needs two positive or null numbers: the number
of failures <var>r</var> until trials are stopped and probability of success
(<var>p</var>, a real in the interval [0;1]) for each trial.


</li><li> <a name="index-Normal_005fcv-distribution"></a>
<a name="index-Distribution_002c-Normal_005fcv"></a>
<a name="Normal_005fcv"></a><code>Normal_cv</code>, is the normal distribution with the coefficient of
variation instead of the standard deviation as second
parameter.

</li><li> <a name="index-Normal_005fv-distribution"></a>
<a name="index-Distribution_002c-Normal_005fv"></a>
<code>Normal_v</code>, is also the normal distribution with the variance
instead of the standard deviation as second parameter. You can use it to
specify a hierarchical model with a conjugate prior on the variance
(see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).

</li><li> <a name="index-Piecewise-distribution"></a>
<a name="index-Distribution_002c-Piecewise"></a>
<a name="index-Triangular-distribution"></a>
<a name="index-Distribution_002c-triangular"></a>
<code>Piecewise</code>, uses four reals as parameters: the <var>minimum</var>,
<var>A</var>, <var>B</var>, and the <var>maximum</var>. The distribution has the form
of a truncated triangle, with a plateau between <var>A</var> and <var>B</var>. If
A = B,
the distribution is the triangular distribution.

</li><li> <a name="index-Poisson-distribution"></a>
<a name="index-Distribution_002c-Poisson"></a>
<code>Poisson</code>, needs a strictly positive real: the rate <var>A</var>.

</li><li> <a name="index-StudentT-distribution"></a>
<a name="index-Distribution_002c-StudentT"></a>
<code>StudentT</code>, requires three parameters: its number of degrees of
freedom (an integer), its mean, and its standard deviation.

</li><li> <a name="index-TruncInvGamma-distribution"></a>
<a name="index-Truncated-Inverse_002dgamma-distribution"></a>
<a name="index-Distribution_002c-truncated-inverse_002dgamma"></a>
<a name="index-Distribution_002c-TruncInvGamma"></a>
<code>TruncInvGamma</code> (truncated inverse gamma distribution), needs
four strictly positive real parameters: the shape, the scale, the
minimum and the maximum. To use it you need to have the GNU Scientific
Library (<code>gsl</code>) to be installed.

</li><li> <a name="index-TruncLogNormal-distribution"></a>
<a name="index-Distribution_002c-TruncLogNormal"></a>
<a name="index-Truncated-lognormal-distribution"></a>
<a name="index-Distribution_002c-truncated-lognormal"></a>
<code>TruncLogNormal</code> (truncated lognormal distribution), uses four real
numbers: the geometric mean and geometric standard deviation (strictly
superior to 1), the minimum and the maximum in natural space. For
example:

<div class="example">
<pre class="example">Distrib(Var, TruncLogNormal, 1, 2.718, 0.01, 10);
</pre></div>

<p>samples &lsquo;<samp>Var</samp>&rsquo; such that
log(&lsquo;<samp>Var</samp>&rsquo;) is a standardized normal variate of mean log(1)
and standard deviation log(2.718) -
while &lsquo;<samp>Var</samp>&rsquo; is truncated to fall between 0.01 to 10.
</p>
</li><li> <a name="index-TruncLogNormal_005fv-distribution"></a>
<a name="index-Distribution_002c-TrunclogNormal_005fv"></a>
<code>TruncLogNormal_v</code>, is like the truncated lognormal, except that it
takes the variance (in log space!) instead of the standard deviation as
second parameter. You can use it to specify a hierarchical model with a
conjugate prior on the variance (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).

</li><li> <a name="index-TruncNormal-distribution"></a>
<a name="index-Distribution_002c-TruncNormal"></a>
<a name="index-Truncated-normal-distribution"></a>
<a name="index-Distribution_002c-truncated-normal"></a>
<code>TruncNormal</code> (truncated normal distribution), takes four real
parameters: the mean, the standard deviation (strictly positive), the
minimum and the maximum.

</li><li> <a name="index-TruncNormal_005fcv-distribution"></a>
<a name="index-Distribution_002c-Truncnormal_005fcv"></a>
<code>TruncNormal_cv</code>, is like the truncated normal distribution with
the coefficient of variation instead of the standard deviation as
second parameter.

</li><li> <a name="index-TruncNormal_005fv-distribution"></a>
<a name="index-Distribution_002c-Truncnormal_005fv"></a>
<code>TruncNormal_v</code>, is like the truncated normal distribution with the
variance instead of the standard deviation as second parameter.

</li><li> <a name="index-Uniform-distribution"></a>
<a name="index-Distribution_002c-Uniform"></a>
<code>Uniform</code>, with two shape parameters: the minimum and the maximum
of the sampling range (real numbers).

</li><li> <a name="index-UserSpecifiedLL-distribution"></a>
<a name="index-Distribution_002c-UserSpecifiedLL"></a>
<code>UserSpecifiedLL</code> can be used to specify a data likelihood. It
allows the user to compute the log-likelihood of the data inside the
model definition file (in the <code>Dynamics</code> or <code>CalcOutputs</code>
sections). It uses only one parameters: the calculated
log-likelihood. For example:

<div class="example">
<pre class="example">Likelihood(LL, UserSpecifiedLL, Prediction(LL));
...
Print (LL, 1);
Data  (LL, 1);
</pre></div>

<p>In this case, the <code>Data()</code> statements are not actually used by
the model. They must still be provided, with arbitrary data values
(except that you should not use the missing data code, -1 by
default). The actual data values must be passed as parameter(s) to the
model. 
</p>
</li></ul>

<p>The shape parameters of the above distributions, if they are defined,
can symbolically reference other model parameters, even if
distributions for these have already been defined. For example:
</p>
<div class="example">
<pre class="example">Distrib(A, Normal, 0, 1);
Distrib(B, Normal, A, 2);
</pre></div>

<br>

<p><strong>In the context of MCMC sampling</strong>, <em>GNU MCSim</em> provides
extensions of the above <code>Distrib()</code> specification syntax.
<a name="index-Data_0028_0029-qualifier_002c-for-use-in-Distrib_0028_0029"></a>
<a name="index-Qualifier_002c-Data_0028_0029"></a>
<a name="index-Prediction_0028_0029-qualifier_002c-for-use-in-Distrib_0028_0029"></a>
<a name="index-Qualifier_002c-Prediction_0028_0029"></a>
<a name="index-Likelihood_0028_0029-specification"></a>
<a name="index-Specification_002c-Likelihood_0028_0029"></a>
<a name="index-Density_0028_0029-specification"></a>
<a name="index-Specification_002c-Density_0028_0029"></a>
</p>
<p>First, when <code>Distrib()</code> is used to specify the prior or
conditional distribution of a model parameter (in a Bayesian
framework), that parameter can also appear as a shape parameter, if a
distribution has already been specified for the parameter at an upper
<code>Level</code> of the file.
</p>
<p>For example:
</p>
<div class="example">
<pre class="example">Level {                      # upper level
  Distrib(A, Normal,   0, 1);
  Distrib(B, InvGamma, 2, 2);
  Level {                    # sub-level
    Distrib(A, Normal_v, A, B);
    ...
  }                          # end sub-level
}                            # end upper level
</pre></div>

<p>In that case, the parameter <var>A</var>, used for shape specification (as
the mean of a Normal distribution) in the sub-level, refers to the
&quot;<em>parent</em>&quot; <var>A</var> parameter, for which a standard Normal
distribution is defined at the upper <code>Level</code>. The <em>sampled</em>
values of the parent parameters <var>A</var> and <var>B</var> will be used as mean
and variance for their &quot;<em>child</em>&quot; parameter, <var>A</var>, when it will be
its turn to be randomly sampled. This forms the basis of the
specification of multilevel (hierarchical) models (see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).
</p>
<p>Note that the keyword <code>Density()</code> can be used instead of
<code>Distrib()</code> to make more understandable MCMC input
files. <code>Density()</code> and <code>Distrib()</code> are equivalent and have
the same syntax. We recommend its use.
</p>
<p>Next, in MCMC simulations, you usually assign a probability
distribution (<i>i.e.</i>, a likelihood) to the data you
analyze. Typically, your model&rsquo;s state and/or output variables will be
used to predict some aspect of the observed data distributions (mean,
variance, <i>etc.</i>). <em>GNU MCSim</em> gives you the possibility to
specify a distribution for your data, using model parameters, input,
state, or output model variables, or even other data, to define the
distribution shape. This is achieved through the use of the
<code>Data()</code> and <code>Prediction()</code> &quot;<em>qualifiers</em>&quot;. In that
case, the keyword <code>Likelihood()</code> should be used instead of
<code>Distrib()</code> (the two keywords are equivalent and have the same
syntax, but we recommend that you use <code>Likelihood()</code> to make your
MCMC input files more understandable and make it clear that the data
are <i>not</i> sampled, but only assigned a likelihood).
</p>
<p><code>Data()</code> can be used at the first position of a <code>Distrib()</code>
statement, or as a distribution shape parameter. It uses the following
syntax:
</p>
<div class="example">
<pre class="example">Data(&lt;identifier&gt;)
</pre></div>

<p>where <var>&lt;identifier&gt;</var> corresponds to a valid input, state or output
model variable for which data are available. Model parameters cannot be
used (but you can assign a simple parameter value to an output variable
in your model definition file and use that output here). The actual data
values need to be given later in the simulation input file through
<code>Data()</code> specifications (which, in addition to a variable
identifier, give a list of numerical data values, see <a href="#Data_0028_0029-specification">Data() specification</a>) or in a separate datafile (see <a href="#MCMC_0028_0029-specification">MCMC() specification</a>).
</p>
<p>Working hand in hand with <code>Data()</code>, and using the same syntax, the
<code>Prediction()</code> qualifier can be used to designate actual model
inputs, states and outputs for any shape parameter of a specified
distribution (therefore <code>Prediction()</code> must appear after the
distribution name). The actual predicted values, matching exactly the
corresponding data, need to be given later in the simulation input file
through <code>Print()</code> or <code>PrintStep()</code> specifications
[see <a href="#Print_0028_0029-specification">Print() specification</a> and <a href="#PrintStep_0028_0029-specification">PrintStep() specification</a>).
</p>
<p>Here are some example of use of <code>Data()</code> and <code>Prediction()</code>
in the extended syntax of a <code>Likelihood()</code> specification:
</p>
<div class="example">
<pre class="example">Likelihood (Data(y), Normal,   Prediction(y), 0.01);
...
Data (y, 0.1, 2,  5,  3,  9.2);
Print(y, 10,  20, 40, 60, 100);

Likelihood (Data(y), Normal,   Prediction(y), Prediction(sigma));
...
Data (y, 1.01, 1.20, 0.97, 0.80, 1.02);
PrintStep(y,     10, 50, 10);
PrintStep(sigma, 10, 50, 10);

Likelihood (Data(R), Binomial, Prediction(P), Data(N));
...
Data (R, 0,  2,  5, 5,  8, 9, 10, 10);
Data (N, 10, 10, 9, 10, 9, 9, 11, 10);
Print(P, 10, 20, 30,40, 50,60,70, 80);

</pre></div>

<p>(all these statements could not appear as such in an input file, they
would need to be embedded in <code>Level</code> and <code>Simulation</code>
sections.)
</p>


<hr>
<a name="SimType_0028_0029-specification"></a>
<div class="header">
<p>
Previous: <a href="#Distrib_0028_0029-specification" accesskey="p" rel="prev">Distrib() specification</a>, Up: <a href="#Global-specifications" accesskey="u" rel="up">Global specifications</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="SimType_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>SimType()</code> specification</h4>
<a name="index-SimType_0028_0029-specification"></a>
<a name="index-Specification_002c-SimType_0028_0029"></a>

<p>This specification is now obsolete and should not be used. It is left
for compatibility with old input files. It specifies the type of
analysis to perform. Syntax:
</p>
<div class="example">
<pre class="example">SimType(&lt;keyword&gt;);
</pre></div>

<p>The following keywords can be used: <code>DefaultSim</code> (the list of
specified simulations is simulated), <code>MonteCarlo</code>, <code>MCMC</code>
(previously <code>Gibbs</code>, which is now deprecated),
<code>SetPoints</code>. If <code>MonteCarlo</code>, <code>MCMC</code>, or
<code>SetPoints</code> analyses are requested, additional specifications are
needed (see below).
</p>


<hr>
<a name="Specifying-basic-conditions-to-simulate"></a>
<div class="header">
<p>
Next: <a href="#Setting_002dup-statistical-models" accesskey="n" rel="next">Setting-up statistical models</a>, Previous: <a href="#Global-specifications" accesskey="p" rel="prev">Global specifications</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Specifying-basic-conditions-to-simulate-1"></a>
<h4 class="subsection">6.2.4 Specifying basic conditions to simulate</h4>


<p>Any simulation file must define at least one <code>Simulation</code>
section. <code>Simulation</code> sections include particular specifications,
which are presented in the following.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Simulation-sections" accesskey="1">Simulation sections</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Events_0028_0029-specification" accesskey="2">Events() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#StartTime_0028_0029-specification" accesskey="3">StartTime() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Print_0028_0029-specification" accesskey="4">Print() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#PrintStep_0028_0029-specification" accesskey="5">PrintStep() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="Simulation-sections"></a>
<div class="header">
<p>
Next: <a href="#Events_0028_0029-specification" accesskey="n" rel="next">Events() specification</a>, Up: <a href="#Specifying-basic-conditions-to-simulate" accesskey="u" rel="up">Specifying basic conditions to simulate</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Simulation-sections-1"></a>
<h4 class="unnumberedsubsubsec"><code>Simulation</code> sections</h4>
<a name="index-Simulation-sections"></a>
<a name="index-Experiment-sections"></a>


<p>After global specifications, if any, <code>Simulation</code> sections must be
included in the input file. Expectedly, these sections start with the
keyword <code>Simulation</code> and are enclosed in curly braces.
</p>
<p>A <code>Simulation</code> section can make assignments to any state variable,
input variable or parameter defined in the global section of the model
description file. Output variables cannot receive assignments in
simulation input files.
</p>
<p>State variables and parameters can only take constant numerical values
(see <a href="#General-input-file-syntax">General input file syntax</a>). For state variables, this sets the
initial value only. So, for example, in a <code>Simulation</code> section the
parameter <code>Speed</code>, if properly defined, can be set using:
</p>
<div class="example">
<pre class="example">Speed = 83.2;
</pre></div>

<p>This overrides any previously assigned values, even if randomly sampled,
for the specified parameter.
</p>
<p>Inputs can be redefined with input functions (see <a href="#Input-functions-revisited">Input functions revisited</a>) or constant numerical values. Input functions can
reference other variables (eventually randomly sampled), as in:
</p>
<div class="example">
<pre class="example">Q_in = PerExp(InMag, 60, 0, RateConst);
</pre></div>

<p>The maximum number of <code>Simulation</code> sections allowed in an input
file is 200. This can be changed by changing MAX_INSTANCES and
MAX_EXPERIMENTS in the header file <samp>sim.h</samp> and recompiling the
program (this requires re-installation).
</p>
<p>Within a <code>Simulation</code> section, several additional specifications
can be used:
</p><ul>
<li> <code>StartTime()</code>,
</li><li> <code>Print()</code> (or its synonym, <code>Prediction()</code>)
</li><li> <code>PrintStep()</code>,
</li><li> <code>Data()</code>.
</li></ul>

<p>The <code>Data()</code> specification is used only when a statistical model is
set up and will be covered in the corresponding section of this manual
(<a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>).
</p>


<hr>
<a name="Events_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#StartTime_0028_0029-specification" accesskey="n" rel="next">StartTime() specification</a>, Previous: <a href="#Simulation-sections" accesskey="p" rel="prev">Simulation sections</a>, Up: <a href="#Specifying-basic-conditions-to-simulate" accesskey="u" rel="up">Specifying basic conditions to simulate</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Events_0028_0029-specification-for-state-discontinuities"></a>
<h4 class="unnumberedsubsubsec"><code>Events()</code> specification for state discontinuities</h4>
<a name="index-Events-specification"></a>
<a name="index-State-discontinuities"></a>


<p>You can impose state variables discontinuities at a given set of times
with the <code>Events</code> specification. <code>Events</code> has a syntax similar
to the <code>NDoses</code> input function (see <a href="#Input-functions">Input functions</a>). It is in
fact a special type of input function that resets a state variable,
hence the need to assign it to a (dummy) input variable. Its syntax
is:
</p>
<div class="example">
<pre class="example">&lt;input variable&gt; = Events(&lt;state variable&gt;, &lt;n&gt;, &lt;list-of-times&gt;,
                          &lt;list-of-operation&gt;, &lt;list-of-scalars&gt;);
</pre></div>

<p>The first argument, <var>&lt;state variable&gt;</var>, is the state whose value you
want to reset at given times. The integer <var>&lt;n&gt;</var> is the number of
reset times you want to specify; <var>&lt;list-of-times&gt;</var> is a comma
separated list of those reset times; <var>&lt;list-of-operations&gt;</var> is a
comma separated list of operations that will affect the given state
variable at the specified times (see next paragraph), and
<var>&lt;list-of-scalar&gt;</var> is the list of floating point values used for by
the operations specified, at the corresponding times.
</p>
<p>The three keywords operations are <code>Add</code>, <code>Multiply</code> and
<code>Replace</code>. <code>Add</code> adds the corresponding scalar to the target
state variable at the specified time; <code>Multiply</code> multiplies the
state variable by the specified scalar; <code>Replace</code> simply replaces
the value of the state variable by the given scalar.
</p>
<p>The assigned input value takes the value 1 at the specified times and is
zero otherwise. If you don&rsquo;t have a use for such an input, simply define
a dummy input variable. For example:
</p>
<p>In the model definition file define:
</p><div class="example">
<pre class="example">Inputs = {events_v1, events_v2};
</pre></div>

<p>and in the simulation specification file you can request, within a
<code>Simulation</code> specification:
</p><div class="example">
<pre class="example">events_v1 = Events (v1, 2, 1,   9,
                           Add, Add,
                           1,   4);

events_v2 = Events (v2, 2, 1,        5,
                           Multiply, Replace,
                           2,        6);
</pre></div>

<p>At time 1, a value of 1 will be added to the state variable <var>v1</var> and
<var>v2</var> will be multiplied by 2; At time 5 <var>v2</var> will be reset to 6,
and at time 9 the value 4 will be added to <var>v1</var>.
</p>
<p>See (and run) the example model and input file provided in the
example/events folder.
</p>

<hr>
<a name="StartTime_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#Print_0028_0029-specification" accesskey="n" rel="next">Print() specification</a>, Previous: <a href="#Events_0028_0029-specification" accesskey="p" rel="prev">Events() specification</a>, Up: <a href="#Specifying-basic-conditions-to-simulate" accesskey="u" rel="up">Specifying basic conditions to simulate</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="StartTime_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>StartTime()</code> specification</h4>
<a name="index-StartTime_0028_0029-specification"></a>
<a name="index-Specification_002c-StartTime_0028_0029"></a>


<p>The origin of time for a simulation, if it needs to be defined, can be
set with the <code>StartTime()</code> specification, whose syntax is:
</p>
<div class="example">
<pre class="example">StartTime(&lt;initial-time&gt;);
</pre></div>

<p>It just shifts the time scale. If this specification is not given, a
value of zero is used by default. A parameter can be used as initital
time value, so that initial time can be sampled in error-in-variable
models, for example:
</p>
<div class="example">
<pre class="example">T0 = 20;
StartTime(T0);
</pre></div>

<p>The final time is automatically computed to match the largest output
time specified in the <code>Print()</code> or <code>PrintStep()</code>
statements. Output times cannot be inferior to the initial
time.
</p>


<hr>
<a name="Print_0028_0029-specification"></a>
<div class="header">
<p>
Next: <a href="#PrintStep_0028_0029-specification" accesskey="n" rel="next">PrintStep() specification</a>, Previous: <a href="#StartTime_0028_0029-specification" accesskey="p" rel="prev">StartTime() specification</a>, Up: <a href="#Specifying-basic-conditions-to-simulate" accesskey="u" rel="up">Specifying basic conditions to simulate</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Print_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>Print()</code> specification</h4>
<a name="index-Print_0028_0029-specification"></a>
<a name="index-Prediction_0028_0029-specification-_0028in-Simulation-context_0029"></a>
<a name="index-Specification_002c-Print_0028_0029"></a>


<p>The value of any model variable or parameter can be requested for output
with <code>Print()</code> or <code>Prediction()</code> specifications. Their
arguments are a comma-separated list of variable names (at least one and
up to MAX_PRINT_VARS, which is set to 10 by default), and a
comma-separated list of increasing times at which to output their
values:
</p>
<div class="example">
<pre class="example">Print(&lt;identifier1&gt;, &lt;identifier2&gt;, ..., &lt;time1&gt;, &lt;time2&gt;, ...);
Prediction(&lt;identifier3&gt;, &lt;identifier4&gt;, ..., &lt;time1&gt;, &lt;time2&gt;, ...);
</pre></div>

<p>where <var>&lt;identifier1&gt;</var>, <var>&lt;identifier2&gt;</var> etc. correspond to
valid input, state or output model variables, or parameter.
</p>
<p>The same output times are used for all the variables specified. The size
of the time list is only limited by the available memory at run
time. The limit of 10 variables names can be increased by changing
MAX_PRINT_VARS in the header file <samp>sim.h</samp> and re-installing the
whole software. The number of <code>Print()</code> statements you can used in
a given <code>Simulation</code> section is only limited by the available
memory at run time. The same variable or parameter can appear in more
than one <code>Print()</code> specification in a given <code>Simulation</code>
section.
</p>


<hr>
<a name="PrintStep_0028_0029-specification"></a>
<div class="header">
<p>
Previous: <a href="#Print_0028_0029-specification" accesskey="p" rel="prev">Print() specification</a>, Up: <a href="#Specifying-basic-conditions-to-simulate" accesskey="u" rel="up">Specifying basic conditions to simulate</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="PrintStep_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>PrintStep()</code> specification</h4>
<a name="index-PrintStep_0028_0029-specification"></a>
<a name="index-Specification_002c-PrintStep_0028_0029"></a>


<p>The value of any model variable or parameter can be also output with
<code>PrintStep()</code> specifications. They allow dense printing, suitable
for smooth plots, for example. Their arguments are: a comma-separated
list of variable names (at least one and up to MAX_PRINT_VARS, which is
set to 10 by default), the first output time, the last one, and a time
increment:
</p>
<div class="example">
<pre class="example">PrintStep(&lt;identifier1&gt;, &lt;identifier2&gt;, ..., &lt;start-time&gt;, &lt;end-time&gt;,
          &lt;time-step&gt;);
</pre></div>

<p>The final time has to be superior to the initial time and the time step
has to be less than the time span between end and start. If the time
step is not an exact divider of the time span the last printing step is
shorter and the last output time is still the end-time specified. The
number of outputs produced is only limited by the memory available at
run time. You can use several <code>PrintStep()</code> specification, and the
same variable or parameter can appear in more than one
<code>PrintStep()</code>, in a given <code>Simulation</code> section.
</p>


<hr>
<a name="Setting_002dup-statistical-models"></a>
<div class="header">
<p>
Previous: <a href="#Specifying-basic-conditions-to-simulate" accesskey="p" rel="prev">Specifying basic conditions to simulate</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Setting_002dup-statistical-models-1"></a>
<h4 class="subsection">6.2.5 Setting-up statistical models</h4>
<a name="index-Models_002c-statistical"></a>
<a name="index-Setting_002dup-statistical-models"></a>
<a name="index-Statistical-models"></a>

<p>With <em>GNU MCSim</em>, you must define a statistical model to use the
<code>MCMC()</code> specification. <code>MCMC</code> simulations will give you a
sample from the joint posterior distribution of the parameters that
you designate as randomly sampled through <code>Distrib()</code>
specifications. You do not need to specify explicitly that joint
posterior distribution (in fact, in most case, this is
impossible). The posterior distribution is implicitly defined by a
statistical model, that is simply a set of conditional relationship
between the parameters and some data.
</p>
<p><em>GNU MCSim</em> handles multilevel (hierarchical) random effects and
mixed effects statistical models in a Bayesian framework. These models
need to be defined in the simulation specification file, rather than
in the structural model definition file. Yet, due to compilation
constraints, if you need special parameters for your statistical model
(<i>e.g.</i>, variances) you have to declare them in the structural model
file, even if they are not used by the structural model itself.
</p>
<p>So, how do we go about specifying a statistical model with
<em>GNU MCSim</em>? Take for example the following simple linear regression
model:
</p>
<p><var>y_i</var>  = N(<var>Mu_i</var>, <var>Sigma</var>^2),
  <var>Mu_i</var> = <var>Alpha</var> + <var>Beta</var> * (<var>x_i</var> - <var>x_bar</var>).
</p>
<p>where the observed (<var>x</var>,<var>y</var>) pairs are (1,1), (2,3), (3,3),
(4,3) and (5,5). Assume that the parameters <var>Alpha</var> and <var>Beta</var>
are given N(0,10000) priors, and that 1/<var>Sigma</var>^2 is given a
Gamma(1e-2,1e-2) prior.  <var>x_bar</var> is the average of the above values
for <var>x</var>.  We want the posterior distributions of <var>Alpha</var>,
<var>Beta</var>, and <var>Sigma^2</var>.
</p>
<p>The first thing to do is to define a structural (or link) model to
compute <var>y</var> as a function of <var>x</var>. Here is such a model (quite
similar to the one distributed with <em>GNU MCSim</em> source code
(see <a href="#linear_002emodel">linear.model</a>):
</p>
<div class="example">
<pre class="example"># ---------------------------------------------
# Model definition file for a linear model
# ---------------------------------------------
Outputs = {y};

# Structural model parameters
Alpha = 0;
Beta = 0;
x_bar = 0;

# Statistical parameter
Sigma2 = 1;

CalcOutputs { y = Alpha + Beta * (t - x_bar); }
# ---------------------------------------------
</pre></div>

<p>The parameters&rsquo; default values are arbitrary, and could be
anything reasonable. They will be changed or sampled through the input
file. Note that
<var>Sigma2</var>
is not used in the model equations, but still
needs to be defined here in order to be part of the statistical
model. On the other hand,
<var>Mu</var> is not defined, since we do not really need it.
Finally <var>x</var> is replaced by the time, <code>t</code>, for convenience.
An alternative would be to define an input &lsquo;<samp>x</samp>&rsquo; and use it instead
of <code>t</code>.
</p>
<p>We now need to write an input file specifying the distribution of
<var>y</var> (<i>i.e.</i>, the likelihood), and the prior distributions of
the various parameters. Technically, <em>GNU MCSim</em> uses Metropolis
sampling and you do not need to worry about issues of conjugacy or
log-concavity of your prior or posterior distributions. Here is what a
simulation file with a statistical model looks like:
</p>
<div class="example">
<pre class="example"># ---------------------------------------------------------------
# Simulation input file for a linear regression
# ---------------------------------------------------------------
MCMC (&quot;linear.MCMC.out&quot;, &quot;&quot;, &quot;&quot;, 50000, 0, 5, 40000, 63453.1961);
Level {
  Distrib(Alpha,  Normal_v, 0, 10000);
  Distrib(Beta,   Normal_v, 0, 10000);
  Distrib(Sigma2, InvGamma, 0.01, 0.01);
  Likelihood(Data(y), Normal_v, Prediction(y), Sigma2);
  Simulation {
    x_bar = 3.0;
    PrintStep (y, 1, 5, 1);
    Data (y, 1, 3, 3, 3, 5);
  }
} # end Level
End.
# ---------------------------------------------------------------

</pre></div>

<p>The file begins with <code>MCMC()</code> (see <a href="#MCMC_0028_0029-specification">MCMC() specification</a>). The
keyword <code>Level</code> comes next.  <code>Level</code> is used to specify
hierarchical dependences between model parameters. There should be at
least one <code>Level</code> in every MCMC input file, even for a
non-hierarchical model like the one above. See below for further
discussion of the <code>Level</code> keyword. You can also look at the MCMC
input files provided as examples with <em>GNU MCSim</em> source code.  The
<code>Distrib()</code> statements define the parameter priors.
<code>Normal_v</code> specifications are used since we use variances instead
of standard deviations. The inverse-Gamma distribution is used for the
variance component, since the precision is supposed to be
Gamma-distributed. The likelihood is the distribution of the data,
given the model: it is specified by a <code>Likelihood()</code> specification,
valid for every <var>y</var> data point. Again, note that the 
<var>Mu</var>
variable is not used. Instead, the <code>Prediction(y)</code> specification
designates the linear model output. The distributions and likelihoods
specified are in effect for every sub-level or every <code>Simulation</code>
section included in the current <code>Level</code>.
</p>
<p>The &quot;simulations&quot; to perform, and the corresponding data values, are
specified by a <code>Simulation</code> section. Only one <code>Simulation</code>
section is needed here, but several could be specified. In this section,
the value of
<var>x_bar</var>
is provided. The different values of <var>x</var> (time in our formulation of
the model) can be specified via <code>PrintStep()</code> (see <a href="#PrintStep_0028_0029-specification">PrintStep() specification</a>), since they are equally spaced. More generally,
<code>Print()</code> can also be used (see <a href="#Print_0028_0029-specification">Print() specification</a>). The
data values are given in a <code>Data()</code> statement (see below).
</p>
<p>The following paragraphs deal with <code>Level</code> sections and <code>Data()</code>
specifications.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Level-sections" accesskey="1">Level sections</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Data_0028_0029-specification" accesskey="2">Data() specification</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>



<hr>
<a name="Level-sections"></a>
<div class="header">
<p>
Next: <a href="#Data_0028_0029-specification" accesskey="n" rel="next">Data() specification</a>, Up: <a href="#Setting_002dup-statistical-models" accesskey="u" rel="up">Setting-up statistical models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Level-sections-1"></a>
<h4 class="unnumberedsubsubsec"><code>Level</code> sections</h4>
<a name="index-Level-sections"></a>


<p>Markov chain Monte Carlo simulations require the definition of a
statistical model structured with &quot;<em>levels</em>&quot;. Think for example of
the definition of a prior distribution as a top level in a hierarchy,
with the data likelihood being at the lowest level. The hierarchy
levels are defined in <em>GNU MCSim</em> with the help of <code>Level</code>
sections. At least one <code>Level</code> section must be defined in the
simulation input file (you cannot use <code>Level</code> in a structural
model definition file). A <code>Level</code> section starts with the
corresponding keyword and is enclosed in curly braces (&rsquo;{}&rsquo;). It can
include any number of sub-levels or <code>Simulations</code>
sections. <code>Simulations</code> (where the data are specified) form the
lowest level of the hierarchy (see <a href="#Simulation-sections">Simulation sections</a>). In terms
of structure, <code>Simulation</code> sections behave like <code>Level</code>
sections (in particular with regard to &quot;<em>cloning</em>&quot; of random
variables, see below) except that they cannot include further
levels. There must be one and only one top <code>Level</code> and at most 10
nested sub-levels in the hierarchy. No parameter assignement or
distribution specification should occur outside a <code>Level</code>,
otherwise it will be ignored (which is probably not what you
want). This limit of 10 can be increased (up to 255) by changing
MAX_LEVELS in the header file <samp>sim.h</samp> and re-installing <em>GNU
MCSim</em>.
</p>
<p>A <code>Level</code> can specify or change the sampling distribution of any
model parameter properly defined in the global section of the structural
model description file. These distribution specifications apply to all
sub-levels of the <code>Level</code> where they take place. For
example:
</p>
<div class="example">
<pre class="example">

MCMC(&quot;samp.out&quot;, &quot;&quot;, &quot;&quot;, 1, 1, 1, 1, 1); # we are in an MCMC context
Level { # this is the top level
  Distrib(A, Uniform, 0, 1);
  Likelihood(Data(y), Normal, Prediction(y), 1);
  Level { # sub-level 1
    Distrib(A, Normal, A, 1);
    Simulation { ... } # simulation 1
    Simulation { ... } # simulation 2
  } # End sub-level 1
} # End top, end file
End.

</pre></div>

<p>A <code>Level</code> can also make simple assignments to any model parameter
(see <a href="#General-input-file-syntax">General input file syntax</a>). So, for example, in an
simulation, the parameter <var>A</var> could be modified with:
</p>
<div class="example">
<pre class="example">A = 2.0;
</pre></div>

<p>This overrides any previously assigned values for the specified
parameter, even if randomly sampled, and applies to the sub-levels of
the <code>Level</code> where it take place.
</p>
<p>An important concept to grasp here is that of parameter
&quot;<em>cloning</em>&quot;. Cloning automatically creates, using templates, as many
new parameters as you need in your multilevel model. One of the
characteristic feature of multilevel models is the same parameters
appear at several levels. For example, in a random effect model, a
parameter (<i>e.g.</i>, size) will be assumed to be randomly distributed in
a population of individuals. If you have 100 individuals in your
database, your model will have to deal with 100 individual size
parameters and an average size. To spare you the tedium of defining the
same distribution for many parameters, <em>GNU MCSim</em> creates an
appropriate number of parameters for your model on the basis of its
level structure. Assume that you have specified a distribution for a
parameter <var>A</var> at a given level (that we label <var>L1</var> for
clarity). <em>GNU MCSim</em> will automatically create new parameters
(&quot;<em>clones</em>&quot;) with the same distribution as <var>A</var> to match the
number of immediate sub-levels in <var>L1</var>. For example, if there are
three sub-levels included in <var>L1</var>, <em>GNU MCSim</em> creates two clones
to form a total of three instances of <var>A</var> (the original and its
two clones). This convention saves a lot writing and effort
in the long run.
</p>
<p>In the example of code given above, the parameter <var>A</var>, defined at the
top level, will be simply moved to sub-level 1 (cloning is not necessary
since there is only on sub-level directly included in the top level).
Within sub-level 1, the normally-distributed <var>A</var> will be cloned once
in order to create another normal variate with the same
distribution. Each one of those two will be moved to a lower
<code>Simulation</code>, where they will be conditioned by the data of that
simulation only. A total of three variables of &quot;type&quot; <var>A</var> will be
sampled and will be printed in the output file (coded so that the
position in the hierarchy is apparent): the &quot;parent&quot; <var>A</var>(<var>1</var>), a
priori uniformly distributed, and two &quot;dependents&quot; <var>A</var>(<var>1.1</var>)
and <var>A</var>(<var>1.2</var>), <i>a priori</i> normally distributed around
<var>A</var>(<var>1</var>).
</p>
<p>Note that you can check on the console screen the detail of the actual
multilevel structure of your statistical model at run-time by using
option <code>-D=print-hierarchy</code> (see <a href="#Using-the-compiled-program">Using the compiled program</a>).
</p>


<hr>
<a name="Data_0028_0029-specification"></a>
<div class="header">
<p>
Previous: <a href="#Level-sections" accesskey="p" rel="prev">Level sections</a>, Up: <a href="#Setting_002dup-statistical-models" accesskey="u" rel="up">Setting-up statistical models</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Data_0028_0029-specification-1"></a>
<h4 class="unnumberedsubsubsec"><code>Data()</code> specification</h4>
<a name="index-Data_0028_0029-specification"></a>
<a name="index-Specification_002c-Data_0028_0029"></a>


<p>Experimental observations of model variables, inputs, outputs, or
parameters, can be specified with the <code>Data()</code> command. Markov
chain Monte Carlo sampling requires that you specify <code>Data()</code>
statements (see <a href="#MCMC_0028_0029-specification">MCMC() specification</a>; see <a href="#Setting_002dup-statistical-models">Setting-up statistical models</a>). The data are then used internally to evaluate
the likelihood function for the model.  The arguments are the name of
the variable for which observations exist, and a comma-separated list
of data values:
</p>
<div class="example">
<pre class="example">Data(&lt;variable identifier&gt;, &lt;value1&gt;, &lt;value2&gt;, ...);
</pre></div>

<p>This specification can only be used with a matching <code>Print()</code> or
<code>PrintStep()</code> for the same variable (see <a href="#Print_0028_0029-specification">Print() specification</a>;
see <a href="#PrintStep_0028_0029-specification">PrintStep() specification</a>). You must make sure that there are as
many data values in the <code>Data()</code> specification as output time
requested in the corresponding <code>Print()</code> or <code>PrintStep()</code>. A
data value of &quot;-1&quot; is treated as &quot;missing data&quot; and ignored in
likelihood calculations. The convention &quot;-1&quot; can be changed by changing
INPUT_MISSING_VALUE in the header file <samp>mc.h</samp> and
recompiling.
</p>


<hr>
<a name="Analyzing-simulation-output"></a>
<div class="header">
<p>
Next: <a href="#Error-handling" accesskey="n" rel="next">Error handling</a>, Previous: <a href="#Syntax-of-simulation-files" accesskey="p" rel="prev">Syntax of simulation files</a>, Up: <a href="#Running-Simulations" accesskey="u" rel="up">Running Simulations</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Analyzing-simulation-output-1"></a>
<h3 class="section">6.3 Analyzing simulation output</h3>
<a name="index-Analyzing-simulation-output"></a>


<p>The output from Monte Carlo or <code>SetPoints</code> simulations is a
tab-delimited text file with one row for each run (i.e., parameter set)
and one column for each parameter and output in the order specified.
Thus each line of the output file is in the following order:
</p>
<div class="example">
<pre class="example">&lt;# of run&gt; &lt;parameters&gt; &lt;outputs for Exp 1&gt; &lt;outputs for Exp2&gt; ...
</pre></div>

<p>The parameters are printed in the order they were sampled or set.
</p>
<p>The first line gives the column headers. A variable called <var>name</var>
requested for output in an simulation <var>i</var> at a time <var>j</var> is
labeled <var>name_i.j</var>.
</p>
<p>The output of Markov chain Monte Carlo simulations is also a text file
with one row for each run. It displays a column of iteration labels,
and one column for each parameter sampled. The last three columns
contain respectively, the sum of the logarithms of each parameter&rsquo;s
density given its parents&rsquo; values (&lsquo;<samp>LnPrior</samp>&rsquo;), the logarithm of
the data likelihood (&lsquo;<samp>LnData</samp>&rsquo;), and the sum of the previous two
values (&lsquo;<samp>LnPosterior</samp>&rsquo;). The first line gives the column
headers. On this line, parameters names are tagged with a code
identifying their position in the hierarchy defined by the Level
sections. For example, the second instance of a parameter called
<var>name</var> placed at the fist level of the hierarchy is labeled
<var>name</var>(<var>2</var>); the first instance of the same parameter placed
at the second instance of the second level of the hierarchy is labeled
<var>name</var>(<var>2.1</var>), etc.
</p>
<p>If tempered Markov chain Monte Carlo simulations have been requested,
the overall output format is the same as above, with the addition of a
column of perk index (the lowest perk having index zero), and columns
of log-pseudoprior values (one column per perk, starting with the
log-pseudoprior of the lowest perk). Those extra colums are labelled
&lsquo;<samp>IndexT</samp>&rsquo;, &lsquo;<samp>LnPseudoPrior(1)</samp>&rsquo;, &lsquo;<samp>LnPseudoPrior(2)</samp>&rsquo;,
etc. and come just after the parameters. The samples at the highest
perk (typically, perk 1) can be found by selecting the highest value of
&lsquo;<samp>IndexT</samp>&rsquo;.
</p>
<p>In addition, in the case of tempered MCMC, an history of the perks
values computed is saved with the same name as the output file, with a
<var>.perks</var> extension. It lists perk values, counts of samples and
log-pseudoprior at each perk, attempted jumps and successful jumps
between perks. This can help check the perk schedule optimisation (in
particular whether perk zero has been reached) and the behavior of the
chain over perks values. If the perks are correctly spaced, there
should be about equal number of samples at each perk, and jumps
between perks should be frequent.
</p>
<p>Those tab-delimited files can easily be imported into your favorite
spreadsheet, graphic or statistical package for further
analysis.
</p>


<hr>
<a name="Error-handling"></a>
<div class="header">
<p>
Previous: <a href="#Analyzing-simulation-output" accesskey="p" rel="prev">Analyzing simulation output</a>, Up: <a href="#Syntax-of-simulation-files" accesskey="u" rel="up">Syntax of simulation files</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Error-handling-1"></a>
<h3 class="section">6.4 Error handling</h3>
<a name="index-Error-handling"></a>


<p>If integration fails for a <code>imulation</code> in <code>DefaultSim</code>
simulations no output is generated for that simulation, and the user is
warned by an error message on the screen. In <code>MonteCarlo</code> or
<code>SetPoints</code> simulations, the corresponding simulation line is not
printed, but the iteration number is incremented. Finally, in
MCMC simulations, the parameter for which the data likelihood was
computed is simply not updated (which implicitly forbids the
uncomputable region of the parameter space). In all cases an error
message is given on the screen, or wherever the screen output has been
redirected.
</p>


<hr>
<a name="Common-Pitfalls"></a>
<div class="header">
<p>
Next: <a href="#XMCSim" accesskey="n" rel="next">XMCSim</a>, Previous: <a href="#Running-Simulations" accesskey="p" rel="prev">Running Simulations</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Common-Pitfalls-1"></a>
<h2 class="chapter">7 Common Pitfalls</h2>
<a name="index-Common-pitfalls"></a>
<a name="index-Pitfalls"></a>


<p>The following mistakes are particularly easy to make, and sometimes
hard to notice, or understand at first.
</p>
<ul>
<li> Forgetting about type-related arithmetics in C: &lsquo;<samp>1000/882</samp>&rsquo; gives
&lsquo;<samp>1</samp>&rsquo; since it is interpreted as an integer division by the compiler.
To get a floating-point (usual) division use &lsquo;<samp>1000./882.</samp>&rsquo;.

</li><li> Forgetting a semi-colon (&rsquo;;&rsquo;) at the end of statements: the error is
usually detected at the following line(s) where in fact nothing may be
wrong.

</li></ul>



<hr>
<a name="XMCSim"></a>
<div class="header">
<p>
Next: <a href="#Bibliographic-References" accesskey="n" rel="next">Bibliographic References</a>, Previous: <a href="#Common-Pitfalls" accesskey="p" rel="prev">Common Pitfalls</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="XMCSim-1"></a>
<h2 class="chapter">8 XMCSim</h2>
<a name="index-xmcsim"></a>


<p><em>XMCSim</em> is a menu-driven interface which automatizes the
compilation and running tasks of <em>GNU MCSim</em>. It also offers a
convenient interface to 2-D and 3-D plotting of the simulation
results. Note that you need <code>XWindows</code>, <code>Tcl/Tk</code> and
<code>wish</code> installed to run <em>XMCSim</em>. <code>xemacs</code> is also
recommended.
</p>
<p>Just type <code>xmcsim</code> at the command promt. A windows appear, with
a menu bar. Menu items are:
</p>
<ul>
<li> <code>File</code>, which allows you to choose an existing model file or to
exit the program. Once you have chosen a model file, its file name
appears as a reminder at the bottom of the window.

</li><li> <code>Edit</code>, which calls <code>xemacs</code> for you to create a new model
file or edit any file of your choice (for example an input or output
file). Note: if you do not have <code>xemacs</code> installed you can change
the file <samp>xmcsim</samp> to replace the call to <code>xemacs</code> by a call to
your editor.

</li><li> <code>Compile</code> has two items: <code>Compile model</code> will compile
the current model file or prompt you for one and will call <code>mod</code> to
generate a <samp>model.c</samp> file from it; <code>Compile mcsim</code> will
first call <code>mod</code> and will then go on to create an executable mcsim
filevia a call to <code>makemcsim</code> create an executable program.

</li><li> <code>Run</code> with three items: <code>Run</code> which will prompt you for
an executable mcsim file, an input file and an output file (the latter
is optional) and will then launch the executable; <code>Stop</code> will
just stop a running executable; <code>Debug</code> will produce a
standalone executable with a name starting with <samp>debugmcsim</samp> and
will launch <code>xemacs</code> for you (you will then need to call
<code>gdb</code> or another debugger by yourself; if you find a way to
start gdb on an executable <i>via</i> xemacs on the command line please
tell me...).

</li><li> <code>Plot</code> will start an Xgnuplot-based interface to <code>gnuplot</code>
An <code>Help</code> menu available there to guide you further in the
arcanes of <code>gnuplot</code>, but we recommend that you also browse
<code>gnuplot</code> documentation.

</li></ul>

<p>At some point <em>GNU MCSim</em> may do symbolic computations, wash dishes,
clothes and cars, and write poems, but for now, that&rsquo;s all, folks!
</p>

<hr>
<a name="Bibliographic-References"></a>
<div class="header">
<p>
Next: <a href="#Keywords-List" accesskey="n" rel="next">Keywords List</a>, Previous: <a href="#XMCSim" accesskey="p" rel="prev">XMCSim</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Bibliographic-References-1"></a>
<h2 class="unnumbered">Bibliographic References</h2>
<a name="index-Bibliographic-references"></a>


<p>Amzal B., Bois F., Parent E. and Robert C.P. (2006). Bayesian optimal
design via interacting MCMC, Journal of the American Statistical
Association, <b>101</b>:773-785.
</p>
<p>Barry T.M. (1996). Recommendations on the testing and use of
pseudo-random number generators used in Monte Carlo analysis for risk
assessment. Risk Analysis <b>16</b>:93-105.
</p>
<p>Bernardo J.M. and Smith A.F.M. (1994). Bayesian Theory. Wiley, New
York.
</p>
<p>Bois F.Y., Gelman A., Jiang J., Maszle D., Zeise L. and Alexeef
G. (1996). Population toxicokinetics of tetrachloroethylene. Archives of
Toxicology <b>70</b>:347-355.
</p>
<p>Bois F.Y., Smith T.J., Gelman, A., Chang H.Y., Smith
A.E. (1999). Optimal design for a study of butadiene toxicokinetics in
humans. Toxicological Sciences <b>49</b>:213-224.
</p>
<p>Bois F.Y., Zeise L. and Tozer T.N. (1990). Precision and
sensitivity analysis of pharmacokinetic models for cancer risk
assessment: tetrachloroethylene in mice, rats and humans. Toxicology and
Applied Pharmacology <b>102</b>:300-315.
</p>
<p>Calderhead B. and Girolami M. (2009). Estimating Bayes factors via
thermodynamic integration and population MCMC. Computational Statistics
and Data Analysis <b>53</b>:4028-4045.
</p>
<p>Gear C.W. (1971a). Algorithm 407 - DIFSUB for solution of ordinary
differential equations [D2]. Communications of the ACM <b>14</b>:185-190.
</p>
<p>Gear C.W. (1971b). The automatic integration of ordinary differential
equations. Communications of the ACM <b>14</b>:176-179.
</p>
<p>Gelman A. (1992). Iterative and non-iterative simulation algorithms.
Computing Science and Statistics <b>24</b>:433-438.
</p>
<p>Gelman A., Bois F.Y. and Jiang J. (1996). Physiological
pharmacokinetic analysis using population modeling and informative prior
distributions. Journal of the American Statistical Association
<b>91</b>:1400-1412.
</p>
<p>Gelman A., Carlin J.B., Stern H.S. and Rubin D.B. (1995).
Bayesian Data Analysis. Chapman &amp; Hall, London.
</p>
<p>Gelman A. and Rubin D.B. (1992). Inference from iterative simulation
using multiple sequences (with discussion). Statistical Science
<b>7</b>:457-511.
</p>
<p>Geyer C.J. and Thompson E.A. (1995). Annealing Markov chain Monte
Carlo with applications to ancestral inference. Journal of the
American Statistical Association<b>90</b>: 909-920.
</p>
<p>Gilks W.R., Richardson S. and Spiegelhalter D.J. (1996). Markov Chain
Monte Carlo In Practice. Chapman &amp; Hall, London.
</p>
<p>Hammersley J.M. and Handscomb D.C. (1964). Monte Carlo Methods.
Chapman and Hall, London.
</p>
<p>Manteufel R.D. (1996). Variance-based importance analysis applied to a
complex probabilistic performance assessment. Risk Analysis
<b>16</b>:587-598.
</p>
<p>Park S.K. and Miller K.W. (1988). Random number generators: good
ones are hard to find. Communications of the ACM <b>31</b>:1192-1201.
</p>
<p>Press W.H., Flannery B.P., Teukolsky S.A. and Vetterling W.T.
(1989). Numerical Recipes (2nd ed.). Cambridge University Press,
Cambridge.
</p>
<p>Robert C.P. (1995). Simulation of truncated normal variables.
Statistics and Computing. <b>5</b>(2):121-125. doi:10.1007/BF00143942.
</p>
<p>Savic R.M., Jonker D.M., Kerbusch T., Karlsson
M.O. (2007). Implementation of a transit compartment model for
describing drug absorption in pharmacokinetic studies. Journal of
Pharmacokinetics and Pharmacodynamics <b>34</b>:711â726.
doi:10.1007/s10928-007-9066-0.
</p>
<p>Smith A.F.M. (1991). Bayesian computational methods. Philosophical
Transactions of the Royal Society of London, Series A <b>337</b>:369-386.
</p>
<p>Smith A.F.M. and Roberts G.O. (1993). Bayesian computation via the
Gibbs sampler and related Markov chain Monte Carlo methods. Journal of
the Royal Statistical Society Series B <b>55</b>:3-23.
</p>
<p>Vattulainen I., Ala-Nissila T. and Kankaala K. (1994). Physical tests
for random numbers in simulations. Physical Review Letters
<b>73</b>:2513-2516.
</p>


<hr>
<a name="Keywords-List"></a>
<div class="header">
<p>
Next: <a href="#Examples" accesskey="n" rel="next">Examples</a>, Previous: <a href="#Bibliographic-References" accesskey="p" rel="prev">Bibliographic References</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Keywords-List-1"></a>
<h2 class="appendix">Appendix A Keywords List</h2>
<a name="index-Keywords-list"></a>
<a name="index-Reserved-keywords"></a>

<p>You should use the following reserved keywords as prescribed when building
your models and input files:
</p>
<ul>
<li> Add
</li><li> Beta
</li><li> BetaRandom
</li><li> Binomial
</li><li> BinomialBetaRandom
</li><li> BinomialRandom
</li><li> CDFNormal
</li><li> CalcDelay
</li><li> CalcOutputs
</li><li> Cauchy
</li><li> CauchyRandom
</li><li> Chi2
</li><li> Chi2Random
</li><li> Compartment
</li><li> Cvodes
</li><li> Data
</li><li> DefaultSim
</li><li> Density
</li><li> Distrib
</li><li> dt
</li><li> Dynamics
</li><li> End
</li><li> erfc
</li><li> Euler
</li><li> Events
</li><li> ExpRandom
</li><li> Experiment
</li><li> Exponential
</li><li> GGammaRandom
</li><li> Gamma
</li><li> GammaRandom
</li><li> GetSeed
</li><li> HalfCauchy
</li><li> HalfNormal
</li><li> IFN
</li><li> Initialize
</li><li> Inline
</li><li> Inputs
</li><li> Integrate
</li><li> InvGGammaRandom
</li><li> InvGamma
</li><li> InvTemperature
</li><li> Jacobian
</li><li> Level
</li><li> Likelihood
</li><li> lnDFNormal
</li><li> lnGamma
</li><li> LogNormal
</li><li> LogNormalRandom
</li><li> LogNormal_v
</li><li> LogUniform
</li><li> LogUniformRandom
</li><li> Lsodes
</li><li> MCMC
</li><li> MonteCarlo
</li><li> Multiply
</li><li> NegativeBinomial
</li><li> NegativeBinomialRandom
</li><li> NDoses
</li><li> Normal
</li><li> NormalRandom
</li><li> Normal_cv
</li><li> Normal_v
</li><li> OptimalDesign
</li><li> OutputFile
</li><li> Outputs
</li><li> PerDose
</li><li> PerExp
</li><li> Piecewise
</li><li> PiecewiseRandom
</li><li> PKTemplate
</li><li> Poisson
</li><li> PoissonRandom
</li><li> Prediction
</li><li> Print
</li><li> PrintStep
</li><li> Replace
</li><li> SBMLModels
</li><li> Scale
</li><li> SetPoints
</li><li> SetSeed
</li><li> SimType
</li><li> Simulation
</li><li> Spikes
</li><li> StartTime
</li><li> States
</li><li> StudentT
</li><li> StudentTRandom
</li><li> t
</li><li> TruncInvGamma
</li><li> TruncInvGGammaRandom
</li><li> TruncLogNormal
</li><li> TruncLogNormalRandom
</li><li> TruncLogNormal_v
</li><li> TruncNormal
</li><li> TruncNormalRandom
</li><li> TruncNormal_cv
</li><li> TruncNormal_v
</li><li> Uniform
</li><li> UniformRandom
</li><li> useID

</li></ul>


<hr>
<a name="Examples"></a>
<div class="header">
<p>
Next: <a href="#Concept-Index" accesskey="n" rel="next">Concept Index</a>, Previous: <a href="#Keywords-List" accesskey="p" rel="prev">Keywords List</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Examples-1"></a>
<h2 class="appendix">Appendix B Examples</h2>
<a name="index-Examples-1"></a>


<p>You will find here some examples of model description files and
simulation input files.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#linear_002emodel" accesskey="1">linear.model</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a simple algebraic model
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#g_t1cpt_002emodel" accesskey="2">1cpt.model</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a one-compartment pharmacokinetic model
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#perc_002emodel" accesskey="3">perc.model</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">a multi-compartment pharmacokinetic model
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#perc_002elsodes_002ein" accesskey="4">perc.lsodes.in</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">an example simulation input file
</td></tr>
</table>



<hr>
<a name="linear_002emodel"></a>
<div class="header">
<p>
Next: <a href="#g_t1cpt_002emodel" accesskey="n" rel="next">1cpt.model</a>, Up: <a href="#Examples" accesskey="u" rel="up">Examples</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="linear_002emodel-1"></a>
<h3 class="section">B.1 <samp>linear.model</samp></h3>


<div class="example">
<pre class="example"># Linear Model with a random component
# y = A + B * time + N(0,SD_true)
# Setting SD_true to zero gives the deterministic version
#---------------------------------------------------------

# Outputs
Outputs = {y};

# Model Parameters
A = 0;
B = 1;
SD_true = 0;
SD_esti = 0;

CalcOutputs { y = A + B * t + NormalRandom(0,SD_true); }
</pre></div>


<hr>
<a name="g_t1cpt_002emodel"></a>
<div class="header">
<p>
Next: <a href="#perc_002emodel" accesskey="n" rel="next">perc.model</a>, Previous: <a href="#linear_002emodel" accesskey="p" rel="prev">linear.model</a>, Up: <a href="#Examples" accesskey="u" rel="up">Examples</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="g_t1cpt_002emodel_003a-A-example-model-description-file"></a>
<h3 class="section">B.2 <samp>1cpt.model</samp>: A example model description file</h3>


<div class="example">
<pre class="example"># One Compartment Model
# First order input and output
#---------------------------------------------------------

# Inputs
Inputs = {Dose};

# Outputs
Outputs = {C_central, AUC, ln_C_central, ln_AUC,
           SD_C_computed, SD_A_computed};

# Model Parameters
ka = 1;
ke = 0.5;
F  = 1;
V  = 2;

# Statistical Parameters
SDb_ka = 0;
SDw_ka = 0;
SDb_ke = 0;
SDw_ke = 0;
SDb_V  = 0;
min_F  = 0;
max_F  = 0;
SD_C_central = 0;
SD_AUC       = 0;
CV_C_cen     = 0;
CV_AUC       = 0;
CV_C_cen_true = 0;
CV_AUC_true   = 0;


# Calculate Outputs
CalcOutputs {

  # algebraic equation for C_central
  C_central = (ka != ke ?
               (exp(-ke * t) - exp(-ka * t)) *
               F * ka * Dose / (V * (ka - ke))):
               exp(-ka * t) * ka * t * F * Dose / V);

  # algebraic equation for AUC
  AUC = (ka != ke ?
         ((1 - exp(-ke * t)) / ke -
          (1 - exp(-ka * t)) / ka) * F * ka * Dose / (V * (ka - ke))) :
         F * Dose * (1 - (1 + ka * t) * exp(-ka * t)) / (V * ke));

  C_central = C_central + NormalRandom(0, C_central * CV_C_cen_true);
  AUC       = AUC + NormalRandom(0, AUC * CV_AUC_true);

  ln_C_central = (C_central &gt; 0 ? log (C_central) : -100);
  ln_AUC = (AUC &gt; 0 ? log (AUC) : -100);

  SD_C_computed = (C_central &gt; 0 ? C_central * CV_C_cen : 1e-10);
  SD_A_computed = (AUC &gt; 0 ? AUC * CV_AUC : 1e-10);

} # End of output calculations

End.
</pre></div>


<hr>
<a name="perc_002emodel"></a>
<div class="header">
<p>
Next: <a href="#perc_002elsodes_002ein" accesskey="n" rel="next">perc.lsodes.in</a>, Previous: <a href="#g_t1cpt_002emodel" accesskey="p" rel="prev">1cpt.model</a>, Up: <a href="#Examples" accesskey="u" rel="up">Examples</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="perc_002emodel_003a-A-example-model-description-file"></a>
<h3 class="section">B.3 <samp>perc.model</samp>: A example model description file</h3>


<div class="example">
<pre class="example">#---------------------------------------------------------
# perc.model
# A four compartment model of Tetrachloroethylene (PERC)
# and total metabolites.
#---------------------------------------------------------
# States are quantities of PERC and metabolite formed, they can be
# output

States = {Q_fat,        # Quantity of PERC in the fat
          Q_wp,         #   ...   in the well-perfused compartment
          Q_pp,         #   ...   in the poorly-perfused compartment
          Q_liv,        #   ...   in the liver
          Q_exh,        #   ...   exhaled
          Qmet};        # Quantity of metabolite formed


# Extra outputs are concentrations at various points

Outputs = {C_liv,               # mg/l in the liver
           C_alv,               # ... in the alveolar air
           C_exh,               # ... in the exhaled air
           C_ven,               # ... in the venous blood
           Pct_metabolized,     # % of the dose metabolized
           C_exh_ug};           # ug/l in the exhaled air

Inputs = {C_inh}                # Concentration inhaled

# Constants
# Conversions from/to ppm: 72 ppm = .488 mg/l

PPM_per_mg_per_l = 72.0 / 0.488;
mg_per_l_per_PPM = 1/PPM_per_mg_per_l;

#---------------------------------------------------------
# Nominal values for parameters
# Units:
# Volumes: liter
# Vmax:    mg / minute
# Weights: kg
# Km:      mg / minute
# Time:    minute
# Flows:   liter / minute
#---------------------------------------------------------

InhMag = 0.0;
Period = 0.0;
Exposure = 0.0;

C_inh = PerDose (InhMag, Period, 0.0, Exposure);

LeanBodyWt = 55;    # lean body weight

# Percent mass of tissues with ranges shown

Pct_M_fat  = .16;   # % total body mass
Pct_LM_liv = .03;   # liver, % of lean mass
Pct_LM_wp  = .17;   # well perfused tissue, % of lean mass
Pct_LM_pp  = .70;   # poorly perfused tissue, recomputed in scale

# Percent blood flows to tissues

Pct_Flow_fat = .09;
Pct_Flow_liv = .34;
Pct_Flow_wp  = .50; # will be recomputed in scale
Pct_Flow_pp  = .07;

# Tissue/blood partition coeficients

PC_fat = 144;
PC_liv = 4.6;
PC_wp  = 8.7;
PC_pp  = 1.4;
PC_art = 12.0;

Flow_pul   = 8.0;    # Pulmonary ventilation rate (minute volume)
Vent_Perf = 1.14;    # ventilation over perfusion ratio

sc_Vmax = .0026;     # scaling coeficient of body weight for Vmax

Km = 1.0;

# The following parameters are calculated from the above values in
# the Scale section before the start of each simulation.
# They are left uninitialized here.

BodyWt = 0;

V_fat = 0;           # Actual volume of tissues
V_liv = 0;
V_wp  = 0;
V_pp  = 0;

Flow_fat = 0;        # Actual blood flows through tissues
Flow_liv = 0;
Flow_wp  = 0;
Flow_pp  = 0;

Flow_tot = 0;        # Total blood flow
Flow_alv = 0;        # Alveolar ventilation rate

Vmax = 0;            # kg/minute


#---------------------------------------------------------
# Dynamics
# Define the dynamics of the simulation. This section is
# calculated with each integration step. It includes
# specification of differential equations.
#---------------------------------------------------------

Dynamics {

# Venous blood concentrations at the organ exit

Cout_fat = Q_fat / (V_fat * PC_fat);
Cout_wp  = Q_wp  / (V_wp  * PC_wp);
Cout_pp  = Q_pp  / (V_pp  * PC_pp);
Cout_liv = Q_liv / (V_liv * PC_liv);

# Sum of Flow * Concentration for all compartments

dQ_ven = Flow_fat * Cout_fat + Flow_wp * Cout_wp
         + Flow_pp * Cout_pp + Flow_liv * Cout_liv;

# Venous blood concentration

C_ven =  dQ_ven / Flow_tot;

# Arterial blood concentration
# Convert input given in ppm to mg/l to match other units

C_art = (Flow_alv * C_inh / PPM_per_mg_per_l +  dQ_ven) /
        (Flow_tot + Flow_alv / PC_art);

# Alveolar air concentration

C_alv = C_art / PC_art;

# Exhaled air concentration

C_exh = 0.7 * C_alv + 0.3 * C_inh / PPM_per_mg_per_l;

# Differentials

dt (Q_exh) = Flow_alv * C_alv;
dt (Q_fat) = Flow_fat * (C_art - Cout_fat);
dt (Q_wp)  = Flow_wp  * (C_art - Cout_wp);
dt (Q_pp)  = Flow_pp  * (C_art - Cout_pp);

# Quantity metabolized in liver

dQmet_liv = Vmax * Q_liv / (Km + Q_liv);
dt (Q_liv) = Flow_liv * (C_art - Cout_liv) - dQmet_liv;

# Metabolite formation

dt (Qmet)  = dQmet_liv;

} # End of Dynamics


#---------------------------------------------------------
# Scale
# Scale certain model parameters and resolve dependencies
# between parameters. Generally the scaling involves a
# change of units, or conversion from percentage to actual
# units.
#---------------------------------------------------------

Scale {

# Volumes scaled to actual volumes

BodyWt = LeanBodyWt/(1 - Pct_M_fat);

V_fat = Pct_M_fat  * BodyWt/0.92;        # density of fat = 0.92 g/ml
V_liv = Pct_LM_liv * LeanBodyWt;
V_wp  = Pct_LM_wp  * LeanBodyWt;
V_pp  = 0.9 * LeanBodyWt - V_liv - V_wp; # 10% bones

# Calculate Flow_alv from total pulmonary flow

Flow_alv = Flow_pul * 0.7;

# Calculate total blood flow from the alveolar ventilation rate and
# the V/P ratio.

Flow_tot = Flow_alv / Vent_Perf;

# Calculate actual blood flows from total flow and percent flows

Flow_fat = Pct_Flow_fat * Flow_tot;
Flow_liv = Pct_Flow_liv * Flow_tot;
Flow_pp  = Pct_Flow_pp  * Flow_tot;
Flow_wp  = Flow_tot - Flow_fat - Flow_liv - Flow_pp;

# Vmax (mass/time) for Michaelis-Menten metabolism is scaled
# by multiplication of bdw^0.7

Vmax = sc_Vmax * exp (0.7 * log (LeanBodyWt));

} # End of model scaling


#---------------------------------------------------------
# CalcOutputs
# The following outputs are only calculated just before values
# are saved.  They are not calculated with each integration step.
#---------------------------------------------------------

CalcOutputs {

# Fraction of TCE metabolized per day

Pct_metabolized = (InhMag ?
                   Qmet / (1440 * Flow_alv * InhMag * mg_per_l_per_PPM):
                   0);

C_exh_ug  = C_exh * 1000; # milli to micrograms

} # End of output calculation

End.
</pre></div>


<hr>
<a name="perc_002elsodes_002ein"></a>
<div class="header">
<p>
Previous: <a href="#perc_002emodel" accesskey="p" rel="prev">perc.model</a>, Up: <a href="#Examples" accesskey="u" rel="up">Examples</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="perc_002elsodes_002ein-1"></a>
<h3 class="section">B.4 <samp>perc.lsodes.in</samp></h3>


<div class="example">
<pre class="example">#---------------------------------------------------------
# perc.lsodes.in
#
#---------------------------------------------------------

Integrate (Lsodes, 1e-4, 1e-6, 1);


#---------------------------------------------------------
# The following is a simulation of one of Dr. Monster's
# exposure experiments described in &quot;Kinetics of Tetracholoroethylene
# in Volunteers; Influence of Exposure Concentration and Work Load,&quot;
# A.C. Monster, G. Boersma, and H. Steenweg,
# Int. Arch. Occup. Environ. Health, v42, 1989, pp303-309
#
# The paper documents measurements of levels of TCE in blood and
# exhaled air for a group of 6 subjects exposed to
# different concentrations of PERC in air.
#
# Inhalation is specified as a dose of magnitude InhMag for the
# given Exposure time.
#
# Inhalation is given in ppm
#---------------------------------------------------------

Simulation {

InhMag = 72;            # ppm
Period = 1e10;          # Only one dose
Exposure = 240;         # 4 hour exposure

# measurements before end of exposure
# and at [5' 30'] 2hr 18 42 67 91 139 163

Print (C_exh_ug, 239.9 245 270 360 1320 2760 4260 5700 8580 10020 );
Print (C_ven, 239.9 360 1320 2760 4260 5700 8580 10020 );

}

END.
</pre></div>


<hr>
<a name="Concept-Index"></a>
<div class="header">
<p>
Previous: <a href="#Examples" accesskey="p" rel="prev">Examples</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="Concept-Index-1"></a>
<h2 class="unnumbered">Concept Index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-Index_cp_symbol-1"><b>'</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Concept-Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-W"><b>W</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-X"><b>X</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_symbol-1">'</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_0021_003d_0027-operator">&rsquo;!=&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_0023_0027-sign">&rsquo;#&rsquo; sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_002d_0027-_0028hyphen_0029-sign">&rsquo;-&rsquo; (hyphen) sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003a_0027-sign">&rsquo;:&rsquo; sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003b_0027-sign">&rsquo;;&rsquo; sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003c_0027-operator">&rsquo;&lt;&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003c_003d_0027-operator">&rsquo;&lt;=&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003c_003e_0027-operator">&rsquo;&lt;&gt;&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003d_0027-sign">&rsquo;=&rsquo; sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003d_003d_0027-operator">&rsquo;==&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003e_0027-operator">&rsquo;&gt;&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003e_003d_0027-operator">&rsquo;&gt;=&rsquo; operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_003f_0027-sign">&rsquo;?&rsquo; sign</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_005b_005d_0027-_0028square-brackets_0029-notation">&rsquo;[]&rsquo; (square brackets) notation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_005f_0027-_0028underscore_0029-in-templates">&rsquo;_&rsquo; (underscore) in templates</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0027_005f_0027-_0028underscore_0029-vector-notation">&rsquo;_&rsquo; (underscore) vector notation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Algebraic-models">Algebraic models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Analyzing-simulation-output">Analyzing simulation output</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Analyzing-simulation-output">Analyzing simulation output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Arrays">Arrays</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Assignment">Assignment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Beta-distribution"><code>Beta</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-BetaRandom_0028_0029-function"><code>BetaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Bibliographic-references">Bibliographic references</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Bibliographic-References">Bibliographic References</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Binomial-distribution"><code>Binomial</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-BinomialBetaRandom_0028_0029-function"><code>BinomialBetaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-BinomialRandom_0028_0029-function"><code>BinomialRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Blank-lines">Blank lines</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-CalcOutputs_002c-output-section"><code>CalcOutputs</code>, output section</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-calculations">Output calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cauchy-distribution"><code>Cauchy</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cauchy-distribution-1">Cauchy distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CauchyRandom_0028_0029-function"><code>CauchyRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-CDFNormal_0028_0029-function"><code>CDFNormal()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Chi_002dsquare-distribution">Chi-square distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Chi2-distribution"><code>Chi2</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Chi2Random_0028_0029-function"><code>Chi2Random()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Colon-conditional-assignment">Colon conditional assignment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Comments">Comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Common-pitfalls">Common pitfalls</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Common-Pitfalls">Common Pitfalls</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Comparison-operators">Comparison operators</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Compartment-keyword"><code>Compartment</code> keyword</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Complementary-error-function">Complementary error function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Conditional-assignment">Conditional assignment</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cumulative-density-function_002c-Normal">Cumulative density function, Normal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Cvodes-integrator"><code>Cvodes</code> integrator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Data_0028_0029-qualifier_002c-for-use-in-Distrib_0028_0029"><code>Data()</code> qualifier, for use in <code>Distrib()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Data_0028_0029-specification"><code>Data()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Data_0028_0029-specification">Data() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Default">Default</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Defining-models">Defining models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Delay-differential-equations">Delay differential equations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Delay-differentials">Delay differentials</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Density-function_002c-Normal">Density function, Normal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Density_0028_0029-specification"><code>Density()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Derivative-specification">Derivative specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dynamics-section">Dynamics section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Differential-models">Differential models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Discrete_002dtime-models">Discrete-time models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distrib_0028_0029-specification"><code>Distrib()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Beta">Distribution, <code>Beta</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Binomial">Distribution, <code>Binomial</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Cauchy">Distribution, <code>Cauchy</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Cauchy-1">Distribution, Cauchy</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Chi_002dsquare">Distribution, Chi-square</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Chi2">Distribution, <code>Chi2</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Exponential">Distribution, <code>Exponential</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Gamma">Distribution, <code>Gamma</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-HalfCauchy">Distribution, <code>HalfCauchy</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-HalfNormal">Distribution, <code>HalfNormal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-inverse_002dgamma">Distribution, inverse-gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-InvGamma">Distribution, <code>InvGamma</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-LogNormal">Distribution, <code>LogNormal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-LogNormal_005fv">Distribution, <code>LogNormal_v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Loguniform">Distribution, <code>Loguniform</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-NegativeBinomial">Distribution, <code>NegativeBinomial</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Normal">Distribution, <code>Normal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Normal_005fcv">Distribution, <code>Normal_cv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Normal_005fv">Distribution, <code>Normal_v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Piecewise">Distribution, <code>Piecewise</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Poisson">Distribution, <code>Poisson</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-StudentT">Distribution, <code>StudentT</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-triangular">Distribution, triangular</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-truncated-inverse_002dgamma">Distribution, truncated inverse-gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-truncated-lognormal">Distribution, truncated lognormal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-truncated-normal">Distribution, truncated normal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-TruncInvGamma">Distribution, <code>TruncInvGamma</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-TruncLogNormal">Distribution, <code>TruncLogNormal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-TrunclogNormal_005fv">Distribution, <code>TrunclogNormal_v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-TruncNormal">Distribution, <code>TruncNormal</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Truncnormal_005fcv">Distribution, <code>Truncnormal_cv</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Truncnormal_005fv">Distribution, <code>Truncnormal_v</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-Uniform">Distribution, <code>Uniform</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Distribution_002c-UserSpecifiedLL">Distribution, <code>UserSpecifiedLL</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Documentation-license">Documentation license</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Licenses">Licenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dt_0028_0029-operator"><code>Dt()</code> operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dynamics-section">Dynamics section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Dynamics-section">Dynamics section</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dynamics-section">Dynamics section</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-End-keyword">End keyword</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-erfc_0028_0029-function"><code>erfc()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Error-function_002c-complementary">Error function, complementary</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Error-handling">Error handling</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Error-handling">Error handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Euler-integrator"><code>Euler</code> integrator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Events-specification"><code>Events</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Events_0028_0029-specification">Events() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Examples">Examples</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Examples-1">Examples</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Examples">Examples</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Experiment-sections"><code>Experiment</code> sections</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simulation-sections">Simulation sections</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Experimental-design-optimization">Experimental design optimization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Exponential-distribution"><code>Exponential</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ExpRandom_0028_0029-function"><code>ExpRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-BetaRandom_0028_0029">Function, <code>BetaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-BinomialBetaRandom_0028_0029">Function, <code>BinomialBetaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-BinomialRandom_0028_0029">Function, <code>BinomialRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-CauchyRandom_0028_0029">Function, <code>CauchyRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-CDFNormal_0028_0029">Function, <code>CDFNormal()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-Chi2Random_0028_0029">Function, <code>Chi2Random()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-erfc_0028_0029">Function, <code>erfc()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-ExpRandom_0028_0029">Function, <code>ExpRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-GammaRandom_0028_0029">Function, <code>GammaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-GetSeed_0028_0029">Function, <code>GetSeed()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-GGammaRandom_0028_0029">Function, <code>GGammaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-Inline_002c-in-line">Function, Inline, in line</a>:</td><td>&nbsp;</td><td valign="top"><a href="#In-line-functions">In line functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-input">Function, input</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-InvGGammaRandom_0028_0029">Function, <code>InvGGammaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-lnDFNormal_0028_0029">Function, <code>lnDFNormal()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-lnGamma_0028_0029">Function, <code>lnGamma()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-LogNormalRandom_0028_0029">Function, <code>LogNormalRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-LogUniformRandom_0028_0029">Function, <code>LogUniformRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-NDoses_0028_0029">Function, <code>NDoses()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-NDoses_0028_0029-1">Function, <code>NDoses()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-NegativeBinomialRandom_0028_0029">Function, <code>NegativeBinomialRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-NormalRandom_0028_0029">Function, <code>NormalRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerDose_0028_0029">Function, <code>PerDose()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerDose_0028_0029-1">Function, <code>PerDose()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerExp_0028_0029">Function, <code>PerExp()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerExp_0028_0029-1">Function, <code>PerExp()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerTransit_0028_0029">Function, <code>PerTransit()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PerTransit_0028_0029-1">Function, <code>PerTransit()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PiecewiseRandom_0028_0029">Function, <code>PiecewiseRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-PoissonRandom_0028_0029">Function, <code>PoissonRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-SetSeed_0028_0029">Function, <code>SetSeed()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-special">Function, special</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-Spikes_0028_0029">Function, <code>Spikes()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-Spikes_0028_0029-1">Function, <code>Spikes()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-StudentTRandom_0028_0029">Function, <code>StudentTRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-TruncInvGGammaRandom_0028_0029">Function, <code>TruncInvGGammaRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-TruncLogNormalRandom_0028_0029">Function, <code>TruncLogNormalRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-TruncNormalRandom_0028_0029">Function, <code>TruncNormalRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Function_002c-UniformRandom_0028_0029">Function, <code>UniformRandom()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Functions_002c-input">Functions, input</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Functions_002c-input-1">Functions, input</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Functions_002c-special">Functions, special</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gamma-distribution"><code>Gamma</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Gamma-function">Gamma function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GammaRandom_0028_0029-function"><code>GammaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-General-input-file-syntax">General input file syntax</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-input-file-syntax">General input file syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GetSeed_0028_0029-function"><code>GetSeed()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GGammaRandom_0028_0029-function"><code>GGammaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Global-specifications">Global specifications</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-specifications">Global specifications</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-HalfCauchy-distribution"><code>HalfCauchy</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-HalfNormal-distribution"><code>HalfNormal</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-I">I</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Initialize_002c-initialization-section_002c">Initialize, initialization section,</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-initialization">Model initialization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Inline_002c-in-line-functions">Inline, in line functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#In-line-functions">In line functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Input-functions">Input functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Input-functions-1">Input functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Input-functions-2">Input functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Input-variables">Input variables</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Declarations-of-global-variables">Declarations of global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Installation">Installation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integrate_0028_0029-specification"><code>Integrate()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-routine_002c-Cvodes">Integration routine, <code>Cvodes</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-routine_002c-Euler">Integration routine, <code>Euler</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-routine_002c-Lsodes">Integration routine, <code>Lsodes</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Integration-variable">Integration variable</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dynamics-section">Dynamics section</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Inverse_002dgamma-distribution">Inverse-gamma distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-InvGamma-distribution"><code>InvGamma</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-InvGGammaRandom_0028_0029-function"><code>InvGGammaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-InvTemperature_0028_0029-specification"><code>InvTemperature()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Keyword_002c-Compartment">Keyword, <code>Compartment</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Keywords-list">Keywords list</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Keywords-List">Keywords List</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Level-sections"><code>Level</code> sections</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Level-sections">Level sections</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Licenses">Licenses</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Licenses">Licenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Likelihood_0028_0029-specification"><code>Likelihood()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lnDFNormal_0028_0029-function"><code>lnDFNormal()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lnGamma_0028_0029-function"><code>lnGamma()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Logical-tests">Logical tests</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LogNormal-distribution"><code>LogNormal</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LogNormalRandom_0028_0029-function"><code>LogNormalRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LogNormal_005fv-distribution"><code>LogNormal_v</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LogUniform-distribution"><code>LogUniform</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-LogUniformRandom_0028_0029-function"><code>LogUniformRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Lsodes-integrator"><code>Lsodes</code> integrator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-5_002e4_002e0">Major changes in version 5.4.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-5_002e5_002e0">Major changes in version 5.5.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-5_002e6_002e0">Major changes in version 5.6.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-6_002e0_002e0">Major changes in version 6.0.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-6_002e1_002e0">Major changes in version 6.1.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Major-changes-in-version-6_002e2_002e0">Major changes in version 6.2.0</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-makemcsim-script"><code>makemcsim</code> script</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-makemcsimd-script"><code>makemcsimd</code> script</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-makemcsimp-script"><code>makemcsimp</code> script</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-makemcsims-script"><code>makemcsims</code> script</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Markov_002dchain-Monte-Carlo-simulations">Markov-chain Monte Carlo simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Markov_002dchain-Monte-Carlo-simulations-1">Markov-chain Monte Carlo simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MCMC-simulations"><code>MCMC</code> simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MCMC-simulations-1"><code>MCMC</code> simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MCMC_0028_0029-specification"><code>MCMC()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mod-syntax"><code>mod</code> syntax</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax-of-mod-files">Syntax of mod files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-mod-usage"><code>mod</code> usage</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-mod">Using mod</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Model-definition-files">Model definition files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Model-types">Model types</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Models_002c-algebraic">Models, algebraic</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Models_002c-differential">Models, differential</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Models_002c-discrete_002dtime">Models, discrete-time</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Models_002c-statistical">Models, statistical</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting_002dup-statistical-models">Setting-up statistical models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Monte-Carlo-simulations">Monte Carlo simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Monte-Carlo-simulations-1">Monte Carlo simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MonteCarlo_0028_0029-specification">MonteCarlo() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MonteCarlo_0028_0029-specification"><code>MonteCarlo()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MonteCarlo_0028_0029-specification">MonteCarlo() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-MPI">MPI</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-NDoses_0028_0029-function"><code>NDoses()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NDoses_0028_0029-function-1"><code>NDoses()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NegativeBinomial-distribution"><code>NegativeBinomial</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NegativeBinomialRandom_0028_0029-function"><code>NegativeBinomialRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Normal-cumulative-density-function">Normal cumulative density function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Normal-density-function">Normal density function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Normal-distribution"><code>Normal</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-NormalRandom_0028_0029-function"><code>NormalRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Normal_005fcv-distribution"><code>Normal_cv</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Normal_005fv-distribution"><code>Normal_v</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-OptimalDesign_0028_0029-specification"><code>OptimalDesign()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#OptimalDesign_0028_0029-specification">OptimalDesign() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Output-specification">Output specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Output-calculations">Output calculations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Output-variables">Output variables</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Declarations-of-global-variables">Declarations of global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-OutputFile_0028_0029-specification"><code>OutputFile()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#OutputFile_0028_0029-specification">OutputFile() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Overview">Overview</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Parallelization">Parallelization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Installation">Installation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Parallelized-code">Parallelized code</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Using-makemcsim">Using makemcsim</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Parameter-declaration">Parameter declaration</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Declarations-of-global-variables">Declarations of global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Parameter-scaling">Parameter scaling</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-initialization">Model initialization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerDose_0028_0029-function"><code>PerDose()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerDose_0028_0029-function-1"><code>PerDose()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerExp_0028_0029-function"><code>PerExp()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerExp_0028_0029-function-1"><code>PerExp()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerTransit_0028_0029-function"><code>PerTransit()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PerTransit_0028_0029-function-1"><code>PerTransit()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Piecewise-distribution"><code>Piecewise</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PiecewiseRandom_0028_0029-function"><code>PiecewiseRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Pitfalls">Pitfalls</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Common-Pitfalls">Common Pitfalls</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Poisson-distribution"><code>Poisson</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PoissonRandom_0028_0029-function"><code>PoissonRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Prediction_0028_0029-qualifier_002c-for-use-in-Distrib_0028_0029"><code>Prediction()</code> qualifier, for use in <code>Distrib()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Prediction_0028_0029-specification-_0028in-Simulation-context_0029"><code>Prediction()</code> specification (in <code>Simulation</code> context)</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Print_0028_0029-specification">Print() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Print_0028_0029-specification"><code>Print()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Print_0028_0029-specification">Print() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-PrintStep_0028_0029-specification"><code>PrintStep()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#PrintStep_0028_0029-specification">PrintStep() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-Q">Q</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Qualifier_002c-Data_0028_0029">Qualifier, <code>Data()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Qualifier_002c-Prediction_0028_0029">Qualifier, <code>Prediction()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-R-deSolve">R deSolve</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-with-deSolve">Working with deSolve</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-beta">Random number, beta</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-binomial">Random number, binomial</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-binomial_002dbeta">Random number, binomial-beta</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-Cauchy">Random number, Cauchy</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-Chi_002dsquared">Random number, Chi-squared</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-exponential">Random number, exponential</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-gamma">Random number, gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-general_002dgamma">Random number, general-gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-inverse_002dgamma">Random number, inverse-gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-lognormal">Random number, lognormal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-loguniform">Random number, loguniform</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-negative-binomial">Random number, negative binomial</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-normal">Random number, normal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-piecewise">Random number, piecewise</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-Poisson">Random number, Poisson</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-Student-t">Random number, Student <i>t</i></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-truncated-inverse_002dgamma">Random number, truncated inverse-gamma</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-truncated-lognormal">Random number, truncated lognormal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-truncated-normal">Random number, truncated normal</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-number_002c-uniform">Random number, uniform</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-seed_002c-reading-its-value">Random seed, reading its value</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Random-seed_002c-setting-its-value">Random seed, setting its value</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Reserved-keywords">Reserved keywords</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Keywords-List">Keywords List</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Running-simulations">Running simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-Simulations">Running Simulations</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-SBML-models">SBML models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Scale_002c-scaling-section">Scale, scaling section</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-initialization">Model initialization</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Semi_002dcolon">Semi-colon</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SetPoints-simulations"><code>SetPoints</code> simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Overview">Overview</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SetPoints_0028_0029-specification"><code>SetPoints()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#SetPoints_0028_0029-specification">SetPoints() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SetSeed_0028_0029-function"><code>SetSeed()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Setting_002dup-statistical-models">Setting-up statistical models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting_002dup-statistical-models">Setting-up statistical models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SimType_0028_0029-specification"><code>SimType()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#SimType_0028_0029-specification">SimType() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Simulation-definition-files">Simulation definition files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-Simulations">Running Simulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Simulation-file_002c-syntax">Simulation file, syntax</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax-of-simulation-files">Syntax of simulation files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Simulation-sections"><code>Simulation</code> sections</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Simulation-sections">Simulation sections</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Software-license">Software license</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Licenses">Licenses</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Special-functions">Special functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Special-functions-1">Special functions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Data_0028_0029">Specification, <code>Data()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Data_0028_0029-specification">Data() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Density_0028_0029">Specification, <code>Density()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Distrib_0028_0029">Specification, <code>Distrib()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Integrate_0028_0029">Specification, <code>Integrate()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Integrate_0028_0029-specification">Integrate() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-InvTemperature_0028_0029">Specification, <code>InvTemperature()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Likelihood_0028_0029">Specification, <code>Likelihood()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-MCMC_0028_0029">Specification, <code>MCMC()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-MonteCarlo_0028_0029">Specification, <code>MonteCarlo()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#MonteCarlo_0028_0029-specification">MonteCarlo() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-OptimalDesign_0028_0029">Specification, <code>OptimalDesign()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#OptimalDesign_0028_0029-specification">OptimalDesign() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-OutputFile_0028_0029">Specification, <code>OutputFile()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#OutputFile_0028_0029-specification">OutputFile() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-Print_0028_0029">Specification, <code>Print()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Print_0028_0029-specification">Print() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-PrintStep_0028_0029">Specification, <code>PrintStep()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#PrintStep_0028_0029-specification">PrintStep() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-SetPoints_0028_0029">Specification, <code>SetPoints()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#SetPoints_0028_0029-specification">SetPoints() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-SimType_0028_0029">Specification, <code>SimType()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#SimType_0028_0029-specification">SimType() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specification_002c-StartTime_0028_0029">Specification, <code>StartTime()</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#StartTime_0028_0029-specification">StartTime() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specifications_002c-global">Specifications, global</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Global-specifications">Global specifications</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Specifying-simulations">Specifying simulations</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Running-Simulations">Running Simulations</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Spikes_0028_0029-function"><code>Spikes()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions">Input functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Spikes_0028_0029-function-1"><code>Spikes()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Input-functions-revisited">Input functions revisited</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Square-brackets">Square brackets</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-StartTime_0028_0029-specification"><code>StartTime()</code> specification</a>:</td><td>&nbsp;</td><td valign="top"><a href="#StartTime_0028_0029-specification">StartTime() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-State-discontinuities">State discontinuities</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Events_0028_0029-specification">Events() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-State-variables">State variables</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Declarations-of-global-variables">Declarations of global variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Statistical-models">Statistical models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Setting_002dup-statistical-models">Setting-up statistical models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Structural-models">Structural models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Structural-models-1">Structural models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Model-types">Model types</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-StudentT-distribution"><code>StudentT</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-StudentTRandom_0028_0029-function"><code>StudentTRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Style">Style</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Comments-on-style">Comments on style</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Syntax-for-mod">Syntax for <code>mod</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax-of-mod-files">Syntax of mod files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Syntax-of-simulation-files">Syntax of simulation files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax-of-simulation-files">Syntax of simulation files</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tempered-MCMC">Tempered MCMC</a>:</td><td>&nbsp;</td><td valign="top"><a href="#MCMC_0028_0029-specification">MCMC() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Template-models">Template models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tests_002c-logical">Tests, logical</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Triangular-distribution">Triangular distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Truncated-Inverse_002dgamma-distribution">Truncated Inverse-gamma distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Truncated-lognormal-distribution">Truncated lognormal distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Truncated-normal-distribution">Truncated normal distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncInvGamma-distribution"><code>TruncInvGamma</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncInvGGammaRandom_0028_0029-function"><code>TruncInvGGammaRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncLogNormal-distribution"><code>TruncLogNormal</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncLogNormalRandom_0028_0029-function"><code>TruncLogNormalRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncLogNormal_005fv-distribution"><code>TruncLogNormal_v</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncNormal-distribution"><code>TruncNormal</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncNormalRandom_0028_0029-function"><code>TruncNormalRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncNormal_005fcv-distribution"><code>TruncNormal_cv</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-TruncNormal_005fv-distribution"><code>TruncNormal_v</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Underscore-syntax-for-vectors">Underscore syntax for vectors</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Underscore-use-for-template-models">Underscore use for template models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Reading-SBML-models">Reading SBML models</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Uniform-distribution"><code>Uniform</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-UniformRandom_0028_0029-function"><code>UniformRandom()</code> function</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Special-functions">Special functions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-UserSpecifiedLL-distribution"><code>UserSpecifiedLL</code> distribution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Distrib_0028_0029-specification">Distrib() specification</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Using-deSolve">Using deSolve</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-with-deSolve">Working with deSolve</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Variable-names">Variable names</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Vectorization">Vectorization</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Vectors">Vectors</a>:</td><td>&nbsp;</td><td valign="top"><a href="#General-syntax">General syntax</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Working-Through-an-Example">Working Through an Example</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Working-Through-an-Example">Working Through an Example</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Writing-and-Compiling-structural-models">Writing and Compiling structural models</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Writing-and-Compiling-Structural-Models">Writing and Compiling Structural Models</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index_cp_letter-X">X</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-xmcsim"><code>xmcsim</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#XMCSim">XMCSim</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-Index_cp_symbol-1"><b>'</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Concept-Index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-V"><b>V</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-W"><b>W</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index_cp_letter-X"><b>X</b></a>
 &nbsp; 
</td></tr></table>

<hr>



</body>
</html>
