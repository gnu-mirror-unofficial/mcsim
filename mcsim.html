<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<!-- Created on January, 11  2009 by texi2html 1.65 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>MCSim User' Manual: </TITLE>

<META NAME="description" CONTENT="MCSim User' Manual: ">
<META NAME="keywords" CONTENT="MCSim User' Manual: ">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.65">

</HEAD>

<BODY LANG="en" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC_Top"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1>MCSim User' Manual</H1></P><P>

MCSim manual, version 5.3.0
</P><P>

<EM>MCSim</EM> is a general purpose modeling and simulation program which can
performs "standard" or "Markov chain" Monte Carlo simulations. It allows
you to specify a set of linear or nonlinear algebraic equations or
ordinary differential equations. They are solved numerically using
parameter values you choose or parameter values sampled from statistical
distributions. Simulation outputs can be compared to experimental data
for Bayesian parameter estimation (model calibration).
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
</TABLE>
Reference&nbsp;Manual
<br>
<TABLE BORDER=0 CELLSPACING=0>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC1">1. Software License</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">MCSim is under GNU General Public License</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC2">2. Overview</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">the gist of it</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC6">3. Installation</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">for GNU/Linux, Unix and other platforms</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC12">4. Working Through an Example</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">highly recommended!</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">use and syntax of model definition files</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC28">6. Running Simulations</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">syntax of simulation specification files</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC52">7. Common Pitfalls</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">errors you will make one day or the other...</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC53">8. XMCSim</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a graphical user's interface to MCSim</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC54">Bibliographic References</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">examples of applications</TD></TR>
</TABLE>

<br>
Appendices
<br>
<TABLE BORDER=0 CELLSPACING=0>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC55">A. Keywords List</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a list of the reserved keywords</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC56">B. Examples</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">examples of models and input files</TD></TR>
</TABLE>

<br>
Index&nbsp;Table
<br>
<TABLE BORDER=0 CELLSPACING=0>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC61">Concept Index</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<HR SIZE=1>
<A NAME="SEC1"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC2"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC2"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<A NAME="Software License"></A>
<H1> 1. Software License </H1>
<!--docid::SEC1::-->
<P>

<center>
 <B>The GNU Free Documentation License</B>
</center>
</P><P>

Version 1.2, November 2002
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=display><pre style="font-family: serif">Copyright &copy; 2000,2001,2002 Free Software Foundation, Inc.
51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></td></tr></table></P><P>

<OL>
<LI>
PREAMBLE
<P>

The purpose of this License is to make a manual, textbook, or other
functional and useful document <EM>free</EM> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</P><P>

This License is a kind of "copyleft", which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</P><P>

We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</P><P>

<LI>
APPLICABILITY AND DEFINITIONS
<P>

This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The "Document", below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as "you".  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</P><P>

A "Modified Version" of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</P><P>

A "Secondary Section" is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</P><P>

The "Invariant Sections" are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</P><P>

The "Cover Texts" are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</P><P>

A "Transparent" copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not "Transparent" is called "Opaque".
</P><P>

Examples of suitable formats for Transparent copies include plain
ASCII without markup, Texinfo input format, LaTeX input
format, <FONT SIZE="-1">SGML</FONT> or <FONT SIZE="-1">XML</FONT> using a publicly available
<FONT SIZE="-1">DTD</FONT>, and standard-conforming simple <FONT SIZE="-1">HTML</FONT>,
PostScript or <FONT SIZE="-1">PDF</FONT> designed for human modification.  Examples
of transparent image formats include <FONT SIZE="-1">PNG</FONT>, <FONT SIZE="-1">XCF</FONT> and
<FONT SIZE="-1">JPG</FONT>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <FONT SIZE="-1">SGML</FONT> or
<FONT SIZE="-1">XML</FONT> for which the <FONT SIZE="-1">DTD</FONT> and/or processing tools are
not generally available, and the machine-generated <FONT SIZE="-1">HTML</FONT>,
PostScript or <FONT SIZE="-1">PDF</FONT> produced by some word processors for
output purposes only.
</P><P>

The "Title Page" means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, "Title Page" means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.
</P><P>

A section "Entitled XYZ" means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as "Acknowledgements",
"Dedications", "Endorsements", or "History".)  To "Preserve the Title"
of such a section when you modify the Document means that it remains a
section "Entitled XYZ" according to this definition.
</P><P>

The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</P><P>

<LI>
VERBATIM COPYING
<P>

You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</P><P>

You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</P><P>

<LI>
COPYING IN QUANTITY
<P>

If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</P><P>

If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</P><P>

If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</P><P>

It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</P><P>

<LI>
MODIFICATIONS
<P>

You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</P><P>

<OL>
<LI>
Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.
<P>

<LI>
List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.
<P>

<LI>
State on the Title page the name of the publisher of the
Modified Version, as the publisher.
<P>

<LI>
Preserve all the copyright notices of the Document.
<P>

<LI>
Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.
<P>

<LI>
Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.
<P>

<LI>
Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.
<P>

<LI>
Include an unaltered copy of this License.
<P>

<LI>
Preserve the section Entitled "History", Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled "History" in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.
<P>

<LI>
Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the "History" section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.
<P>

<LI>
For any section Entitled "Acknowledgements" or "Dedications", Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.
<P>

<LI>
Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.
<P>

<LI>
Delete any section Entitled "Endorsements".  Such a section
may not be included in the Modified Version.
<P>

<LI>
Do not retitle any existing section to be Entitled "Endorsements" or
to conflict in title with any Invariant Section.
<P>

<LI>
Preserve any Warranty Disclaimers.
</OL>
<P>

If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice.
These titles must be distinct from any other section titles.
</P><P>

You may add a section Entitled "Endorsements", provided it contains
nothing but endorsements of your Modified Version by various
parties--for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</P><P>

You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</P><P>

The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</P><P>

<LI>
COMBINING DOCUMENTS
<P>

You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</P><P>

The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</P><P>

In the combination, you must combine any sections Entitled "History"
in the various original documents, forming one section Entitled
"History"; likewise combine any sections Entitled "Acknowledgements",
and any sections Entitled "Dedications".  You must delete all
sections Entitled "Endorsements."
</P><P>

<LI>
COLLECTIONS OF DOCUMENTS
<P>

You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</P><P>

You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</P><P>

<LI>
AGGREGATION WITH INDEPENDENT WORKS
<P>

A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an "aggregate" if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</P><P>

If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</P><P>

<LI>
TRANSLATION
<P>

Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</P><P>

If a section in the Document is Entitled "Acknowledgements",
"Dedications", or "History", the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</P><P>

<LI>
TERMINATION
<P>

You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.
</P><P>

<LI>
FUTURE REVISIONS OF THIS LICENSE
<P>

The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<A HREF="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</A>.
</P><P>

Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License "or any later version" applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
</OL>
<P>

<A NAME="Overview"></A>
<HR SIZE="6">
<A NAME="SEC2"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC1"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC3"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC1"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC6"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 2. Overview </H1>
<!--docid::SEC2::-->
<P>

<EM>MCSim</EM> is a simulation and statistical inference tool for algebraic or
differential equation systems. Other programs have been created to the
same end, the Matlab family of graphical interactive programs being some
of the more general and easy to use. Still, many available tools are not
optimal for performing computer intensive and sophisticated Monte Carlo
analyses. <EM>MCSim</EM> was created specifically to this end: to perform Monte
Carlo analyses in an optimized, and easy to maintain environment. The
software consists in two pieces, a model generator and a simulation
engine:</P><P>

- The model generator, "<EM>mod</EM>", was created to facilitate structural model
definition and maintenance, while keeping execution time short. You code your
model using a simplified syntax and <CODE>mod</CODE> translates it in C.</P><P>

- The simulation engine is a set of routines are linked to your model to
produce executable code. After linking, you will be able to run
simulations of your structural model under a variety of conditions,
specify an associated statistical model, and perform Monte Carlo
simulations.</P><P>

<HR SIZE="6">
<A NAME="SEC3"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC2"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC4"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 2.1 General procedure </H2>
<!--docid::SEC3::-->
<P>

Model building and simulation proceeds in four stages:</P><P>

<OL>
<LI>
You create with any text editor (<I>e.g.</I>, <CODE>emacs</CODE>) a model
description file. The reference section on <CODE>mod</CODE>, later in this
manual gives you the syntax to use (see section <A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A>). This syntax allows you to describe the model variables,
parameters, equations, inputs and outputs in a C-like fashion without
having you to actually know how to write a C program.<P>

<LI>
You instruct the model generator, <CODE>mod</CODE>, to preprocess your
structural model description file. <CODE>Mod</CODE> creates a C file, called
`<TT>model.c</TT>'.<P>

<LI>
You compile and link the newly created `<TT>model.c</TT>' file together with
a library containing the other C routines (or with the other C files of
the `<TT>mcsim/sim</TT>' directory). <EM>MCSim</EM> C code is standard, so you should
be able to compile it with any standard C compiler, for example GNU
<CODE>gcc</CODE>. After compiling and linking, an executable simulation
program is created, specific of your particular model. These
preprocessing and compilation steps can be performed in Unix with a
single shell command <CODE>makemcsim</CODE> (in which case, the `<TT>model.c</TT>'
is created only temporarily and erased afterward). This produces the
most efficient code for your particular machine.<P>

<LI>
You then write any number of simulation specification files and run them
with the compiled <CODE>mcsim</CODE> program. These simulation files describe
the kind of simulation to run (simple simulations, Monte Carlo etc.),
various settings for the integration algorithm if needed, and a
description of one or several simulation conditions (eventually with a
statistical model and data to fit) (see section <A HREF="mcsim.html#SEC28">6. Running Simulations</A>). The
simulation output is written to standard ASCII files.</OL>
<P>

Little or no knowledge of computer programming is required, unless you
want to tailor the program to special needs, beyond what is described in
this manual (in which case you may want to contact us).</P><P>

Under Unix, a graphical user interface written in Tcl/Tk, <EM>XMCSim</EM>
(called by the command <CODE>xmcsim</CODE>), is also provided. This
menu-driven interface automatizes the compilation and running tasks. It
also offers a convenient interface to 2-D and 3-D plotting of the
simulation results.</P><P>

<HR SIZE="6">
<A NAME="SEC4"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC3"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC5"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 2.2 Types of simulations </H2>
<!--docid::SEC4::-->
<P>

Five types of simulations are available:</P><P>

<UL>
<LI>
<A NAME="IDX1"></A>
A simple simulation will solve (eventually integrate) the equations you
specified, using the default parameter values eventually overridden in
the simulation specification file. User-requested outputs are sent to
an output file of your choice.<P>

<LI>
<A NAME="IDX2"></A>
"<EM>Monte Carlo</EM>" simulations will perform repeated (stochastic)
simulations across a randomly sampled region of the model parameter
space (see section <A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A>).<P>

<LI>
<A NAME="IDX3"></A>
<A NAME="IDX4"></A>
A Markov-chain Monte Carlo (<EM>MCMC</EM>) simulation performs a series of
simulations along a Markov chain in the model parameter space
(see section <A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>). In MCMC simulations the random choice of
a new parameter value is influenced by the current value. They can be
used to obtain the Bayesian posterior distribution of the model
parameters, given a statistical model, prior parameter distributions
(that you need to specify) and data for which a likelihood function can
be computed. The program handles hierarchical (<I>e.g.</I>, random effects
and mixed effects) statistical models (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).<P>

<LI>
<A NAME="IDX5"></A>
A "<EM>SetPoints</EM>" simulation solves the model for a series of specified
parameter sets, listed in a separate ASCII file (see section <A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A>). You can create these parameter sets yourself (on a
regular grid, for example) or use the output of a previous Monte Carlo
or MCMC simulation.<P>

<LI>
<A NAME="IDX6"></A>
An "<EM>OptimalDesign</EM>" procedure optimizes the number and location of
observation times for experimental conditions, in order to minimize the
variance of a parameter or an output you specify, given a structural
model, a statistical model, and prior distributions for their parameters
(see section <A HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A>).<P>

</UL>
<P>

<HR SIZE="6">
<A NAME="SEC5"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC4"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC6"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 2.3 Major changes introduced with version 5.3.0 </H2>
<!--docid::SEC5::-->
<P>

<UL>

<LI>
Systems Biology Markup Language (SBML) models can be read in, merged 
together, and translated by <CODE>mod</CODE> into a model.c file suitable 
for compilation as an <EM>MCSim</EM> executable (see section <A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A>). 
A template transport equations model can also be specified to apply to 
some of the species of those SBML models.<P>

<LI>
Random variate generating functions <CODE>CauchyRandom</CODE> and 
<CODE>StudentTRandom</CODE> are available for structural model building 
(see section <A HREF="mcsim.html#SEC20">5.3.4 Special functions</A>). <CODE>Cauchy</CODE>, <CODE>HalfCauchy</CODE>, 
<CODE>HalfNormal</CODE>, and <CODE>StudentT</CODE> distributions can be used to specify 
sampling distributions in simulation specification files 
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>).<P>

</UL>
<P>

For a detailed list of changes, you should consult the `<TT>MCSim-changelog</TT>'
file distributed with the source code.</P><P>

<A NAME="Installation"></A>
<HR SIZE="6">
<A NAME="SEC6"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC5"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC7"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC2"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC12"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 3. Installation </H1>
<!--docid::SEC6::-->
<P>

<HR SIZE="6">
<A NAME="SEC7"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC6"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC8"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 3.1 System requirements </H2>
<!--docid::SEC7::-->
<P>

<EM>MCSim</EM> is written in ANSI-standard C language. We are distributing the
source code and you should be able to compile it for any system,
provided you have an ANSI C compliant compiler.</P><P>

Starting with version 5 <EM>MCSim</EM> is using routines from the GNU
Scientific Library (<CODE>gsl</CODE>). Version 1.5 (or higher) of the shared
gsl library, gslcblas library, and gsl include files should be installed
on your system.</P><P>

On a Unix or GNU/Linux system we recommend the GNU <CODE>gcc</CODE> compiler
(freeware). The automated installation script checks for the
availability on your system of the tools needed for compilation and
proper running of the software. It should warn you of missing component
and eventually adapt the installation to your environment (for example
by generating only the documentation formats that you can read).</P><P>

For other operating systems (MacOS, Windows...) you will need a C
language development environment or at least a compiler, and some
familiarity with it. Here also you might considerer installing a
freeware version of <CODE>gcc</CODE>, such as <CODE>djgpp</CODE>.</P><P>

To run the graphical user interface <EM>XMCsim</EM>, you need a 
GNU/Linux or Unix system with "XWindows", "Tcl/Tk" and "wish" 
installed.</P><P>

<HR SIZE="6">
<A NAME="SEC8"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC7"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC9"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 3.2 Distribution </H2>
<!--docid::SEC8::-->
<P>

<EM>MCSim</EM> source code is available on Internet through:</P><P>

 - <A HREF="http://savannah.gnu.org/projects/mcsim">http://savannah.gnu.org/projects/mcsim</A>.
</P><P>

Packaged distributions are available at:</P><P>

 - <A HREF="http://ftp.gnu.org/gnu/mcsim">http://ftp.gnu.org/gnu/mcsim</A>,
</P><P>

 - <A HREF="http://www.gnu.org/software/mcsim">http://www.gnu.org/software/mcsim</A>,
</P><P>

and mirror sites of the GNU project.</P><P>

Three mailing lists are available for <EM>MCSim</EM> users:</P><P>

General <I>info</I> on <EM>MCSim</EM> is broadcasted through:
</P><P>

 - <A HREF="http://lists.gnu.org/archive/html/info-mcsim">http://lists.gnu.org/archive/html/info-mcsim</A>
</P><P>

You can subscribe to the info list by going to:
</P><P>

 - <A HREF="http://lists.gnu.org/mailman/listinfo/info-mcsim">http://lists.gnu.org/mailman/listinfo/info-mcsim</A>.
</P><P>

You can request <I>help</I> from us, and from other <EM>MCSim</EM> users,
by sending email to:</P><P>

 - <A HREF="mailto:help-mcsim@gnu.org">help-mcsim@gnu.org</A>
</P><P>

(see <A HREF="http://lists.gnu.org/mailman/listinfo/help-mcsim">http://lists.gnu.org/mailman/listinfo/help-mcsim</A> for subscribing).
</P><P>

Help archives are found at:
</P><P>

 - <A HREF="http://news.gmane.org/gmane.comp.gnu.mcsim">http://news.gmane.org/gmane.comp.gnu.mcsim</A>,
</P><P>

 - <A HREF="http://lists.gnu.org/archive/html/help-mcsim">http://lists.gnu.org/archive/html/help-mcsim</A>.
</P><P>

You can report <I>bugs</I> to us, by sending email to:</P><P>

 - <A HREF="mailto:bug-mcsim@gnu.org">bug-mcsim@gnu.org</A>
</P><P>

(<A HREF="http://lists.gnu.org/mailman/listinfo/bug-mcsim">http://lists.gnu.org/mailman/listinfo/bug-mcsim</A> for subscribing).
</P><P>

Bugs archives are located at:
</P><P>

 - <A HREF="http://news.gmane.org/gmane.comp.gnu.mcsim.bugs">http://news.gmane.org/gmane.comp.gnu.mcsim.bugs</A>,
</P><P>

 - <A HREF="http://lists.gnu.org/archive/html/bug-mcsim">http://lists.gnu.org/archive/html/bug-mcsim</A>.
</P><P>

<HR SIZE="6">
<A NAME="SEC9"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC8"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC10"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 3.3 Machine-specific installation </H2>
<!--docid::SEC9::-->
<P>

<HR SIZE="6">
<A NAME="SEC10"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC9"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC11"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 3.3.1 Unix and GNU/Linux operating systems </H3>
<!--docid::SEC10::-->
<P>

To install on a Unix or GNU/Linux machine, download (in binary mode) the
distributed archive file to your machine. Place it in a directory where
there is no existing `<TT>mcsim</TT>' subdirectory that could be erased
(make sure you check that). Decompress the archive with GNU gunzip
(<CODE>gunzip &#60;archive-name&#62;.tar.gz</CODE>). Untar the decompressed archive
with tar (<CODE>tar xf &#60;archive-name&#62;.tar</CODE>) (do <CODE>man tar</CODE> for
further help). Move to the `<TT>mcsim</TT>' directory just created and issue
the following commands:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>./configure
make
make check
</pre></td></tr></table></P><P>

The first command above checks for the availability of the tools needed
for installation and proper running of the software. The second compiles
the <CODE>mod</CODE> program and the dynamic <CODE>libmcsim.so</CODE> library and
eventually compiles this manual in various formats. The third checks
whether the software is running and producing meaningful results in test
cases. In case of error messages, don't panic: check the actual
differences between the culprit output file and the file `<TT>sim.out</TT>'
produced by the checking. Small differences may occur from different
machine precision. This can happen for random numbers, in which case the
Markov chain simulations (MCMC) can diverge greatly after a
while.</P><P>

If you are logged in as "root" or have 
sufficient access rights, you can then install the software in
common directories in `<TT>/usr</TT>' by typing at the shell prompt:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>make install
</pre></td></tr></table></P><P>

If this system-wide installation is successful the executable files
<CODE>mod</CODE>, <CODE>makemcsim</CODE>, <CODE>xmcsim</CODE> are installed in
`<TT>/usr/local/bin</TT>'. The library <CODE>libmcsim.so</CODE> is placed in
`<TT>/usr/lib</TT>'. A copy of the `<TT>mcsim</TT>' source directory (with the
`<TT>mod</TT>', `<TT>sim</TT>', `<TT>doc</TT>', `<TT>samples</TT>', and `<TT>xmcsim</TT>'
subdirectories) is placed in `<TT>/usr/share</TT>'. If you have the GNU
<CODE>info</CODE> system available, an <CODE>mcsim</CODE> node is added to the main
<CODE>info</CODE> menu, so that <CODE>info mcsim</CODE> will show you this
manual. Finally, a symbolic link to `<TT>/usr/share/mcsim/doc</TT>', which
contains the documentation files and this manual (if it was generated),
is created as `<TT>/usr/share/doc/mcsim</TT>'.</P><P>

If you do not have the necessary access rights or just want to install
<EM>MCSim</EM> in your own directory, type:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>make install-here
</pre></td></tr></table></P><P>

This will copy or move `<TT>mod</TT>', `<TT>makemcsim</TT>', and `<TT>xmcsim</TT>'
in a `<TT>/bin</TT>' directory in your home directory, creating it if
necessary. The library <CODE>libmcsim.so</CODE> will be moved to a `<TT>/lib</TT>'
directory in your home directory. The other files in the `<TT>mcsim</TT>'
installation directory (sources, manuals, samples) are left
untouched. You should move the entire `<TT>mcsim</TT>' directory in your
home directory, otherwise you will have to edit the `<TT>bin/xmcsim</TT>'
and the `<TT>bin/makemcsim</TT>' scripts to indicate the location of the
`<TT>mcsim</TT>' directory</P><P>

<HR SIZE="6">
<A NAME="SEC11"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC10"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC12"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 3.3.2 Other operating systems </H3>
<!--docid::SEC11::-->
<P>

Under other operating systems (MacOS, Windows, etc.)  you should be able
to both uncompress and untar the archive with widely distributed
archiving tools. Refer to the documentation of your compiler to create
an executable `<TT>mod</TT>' file from the source code files (mod.c, lex.c,
lexerr.c, lexfn.c, modd.c, modo.c, modi.c, strutil.c) provided in the
`<TT>mod</TT>' directory. Place the executable `<TT>mod</TT>' on your command
path. The `<TT>sim</TT>' directory contains all the source files (sim.c,
getopt.c, lex.c, lexerr.c, lexfn.c, list.c, lsodes1.c, lsodes2.c,
matutil.c, matutilo.c, mh.c, modelu.c, optdsign.c, random.c, simi.c,
siminit.c, simmonte.c, simo.c, strutil.c, yourcode.c) to create a
dynamic library or a set of objects to link with the `<TT>model.c</TT>'
files generated by <CODE>mod</CODE> after processing your models.</P><P>

You are now ready to use <EM>MCSim</EM>. We recommend that you go through 
the next section of this manual, which walks you through an example of model
building and running.</P><P>

<A NAME="Working Through an Example"></A>
<HR SIZE="6">
<A NAME="SEC12"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC11"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC6"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 4. Working Through an Example </H1>
<!--docid::SEC12::-->
<P>

Several models and simulation specification files are provided with
the package as examples (they are in the `<TT>samples</TT>' directory.
You can try any of them. The linear regression model is particularly
simple, but to be more complete we will try here a nonlinear implicit
model, specified through differential equations.</P><P>

Pharmacokinetics models describe the transport and transformation of
chemical compounds in the body. These models often include nonlinear
first-order differential equations. The following example is taken
from our own work on the kinetics of tetrachloroethylene (a solvent)
in the human body (Bois et al., 1996; Bois et al., 1990)
(see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>).</P><P>

Go to the `<TT>mcsim/samples/perc</TT>' directory (installed either
locally or by default in `<TT>usr/share</TT>' under Unix or
GNU/Linux). Open the file `<TT>perc.model</TT>' with any text editor
(<I>e.g.</I>, <CODE>emacs</CODE> or <CODE>vi</CODE> under Unix). This file is an
example of a model definition file. It is also printed at in Appendix
the end of this manual (see section <A HREF="mcsim.html#SEC59">B.3 `<TT>perc.model</TT>': A sample model description file</A>). You can use it as a
template for your own model, but you should leave it unchanged for
now. In that file, the pound signs (<KBD>#</KBD>) indicate the start of
comments. Notice that the file defines:</P><P>

<UL>
<LI>
state variables for the model (for which differentials are
defined), for example:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>States = {Q_fat,   # Quantity of PERC in the fat (mg)
          Q_wp,    #   ...   in the well-perfused compartment (mg)
          Q_pp,    #   ...   in the poorly-perfused compartment (mg)
          Q_liv,   #   ...   in the liver (mg)
          Q_exh,   #   ...   exhaled (mg)
          Q_met}   # Quantity of metabolite formed (mg)
</pre></td></tr></table></P><P>

<LI>
output variables (obtainable at any time as analytical functions
of the states, inputs and parameters), for example:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Outputs = {C_liv,           # mg/l in the liver
           C_alv,           # ... in the alveolar air
           C_exh,           # ... in the exhaled air
           C_ven,           # ... in the venous blood
           Pct_metabolized, # % of the dose metabolized
           C_exh_ug}        # ug/l in the exhaled air
</pre></td></tr></table></P><P>

<LI>
input variables (independent of the others variables, and
eventually varying with time), for example:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Inputs = {C_inh,   # Concentration inhaled (ppm)
          Q_ing};  # Quantity ingested (mg)
</pre></td></tr></table></P><P>

<LI>
model parameters (independent of time), such as:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>LeanBodyWt = 55; # lean body weight (kg)
</pre></td></tr></table></P><P>

<LI>
model initialization and parameters' scaling (the parameters used in the
dynamic equations can be made functions of other parameters: for example
volumes can be computed from masses and densities, etc.),<P>

<LI>
system's dynamics (differential or algebraic equations defining the 
model <I>per se</I>),<P>

<LI>
equations to compute the output variables.<P>

</UL>
<P>

This model definition file as a simple syntax, easy to master. It needs
to be turned into a C program file before compilation and linking to the
other routines (integration, file management etc.) of <EM>MCSim</EM>. You will
use <CODE>mod</CODE> for that. First, quit the editor and return to the operating
system.</P><P>

To start <CODE>mod</CODE> under Unix just type <CODE>mod perc.model</CODE>. After a
few seconds, with no error messages if the model definition is
syntactically correct, <CODE>mod</CODE> announces that the `<TT>model.c</TT>' file
has been created. It should operate similarly under other operating
systems. </P><P>

The next step is to compile and link together the various C files that
will constitute the simulation program for your particular model. Note
that each time you want to change an equation in your model you will
have to change the model definition file and repeat the steps above. However, 
changing just parameter values or state initial values does not
require recompilation since that can be done through simulation
specification files. </P><P>

<UL>
<LI>
Under Unix, the simplest is to use the <CODE>makemcsim</CODE> script. Just
type <CODE>makemcsim</CODE> and compilation will be done automatically
(see section <A HREF="mcsim.html#SEC15">5.2 Using <CODE>makemcsim</CODE> to fully process model files</A>). An executable `<TT>mcsim.perc</TT>' is
created. You can rename it if you wish. <P>

<LI>
Under other operating systems, you should use the command <CODE>make</CODE> or
its equivalent to compile and link together the `<TT>model.c</TT>' file
created by <CODE>mod</CODE> and the other C files of the `<TT>sim</TT>' directory
(see section <A HREF="mcsim.html#SEC6">3. Installation</A>). That should create an application (you should
give it a name specific to the model you are developing, <I>e.g.</I>,
`<TT>mcsim.perc</TT>'). Refer to your compiler manual for details on how to
use your programming environment. Your executable `<TT>mcsim.perc</TT>'
program is now ready to perform simulations. <P>

</UL>
<P>

To start your <EM>MCSim</EM> program just type <CODE>mcsim.perc</CODE> (if you gave it
that name) under Unix. After an introductory banner (telling in
particular which model file the program has been compiled with), you are
prompted for an input file name: type in <KBD>perc.lsodes.in</KBD>
(see section <A HREF="mcsim.html#SEC60">B.4 `<TT>perc.lsodes.in</TT>'</A>, to see this file in Appendix), then a space,
and then type in the output file name: <KBD>perc.lsodes.out</KBD>. After a
few seconds or less (depending on your machine) the program announces
that it has finished and that the output file is `<TT>perc.lsodes.out</TT>'.
You can open the output file with any text editor or word processor, you
can edit it for input in graphic programs <I>etc</I>.</P><P>

You can try the various demonstration models provided in the `<TT>samples</TT>'
directory and observe the output you obtain. You can then start
programming you own models and doing simulations. The next sections of
this manual reference the syntax for model definition and simulation
specifications. </P><P>

<A NAME="Setting-up Structural Models"></A>
<HR SIZE="6">
<A NAME="SEC13"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC12"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC14"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC12"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 5. Setting-up Structural Models </H1>
<!--docid::SEC13::-->
<P>

The model generator, "<EM>mod</EM>", was created to facilitate structural
model definition and maintenance, while keeping short execution time
through compilation. This chapter explains how to use <CODE>mod</CODE>, and
how to code your models using a simplified syntax that <CODE>mod</CODE> can
translate in C (creating thereby a `<TT>model.c</TT>' file).</P><P>

After compiling and linking of the newly created `<TT>model.c</TT>' file
together with the other C files of the `<TT>mcsim/sim</TT>' directory (or
after linking with a dynamic library `<TT>libmcsim.so</TT>'), an executable
simulation program is created, specific of your particular model. These
preprocessing and compilation steps can be performed in Unix with a
single shell command <CODE>makemcsim</CODE> (in which case, the `<TT>model.c</TT>'
is created only temporarily and erased after that).</P><P>

<A NAME="IDX7"></A>
Several examples of model simulation files are included in the
`<TT>mcsim/samples</TT>' directory. Some of them are reproduced in Appendix
(see section <A HREF="mcsim.html#SEC56">B. Examples</A>).</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC14">5.1 Using <CODE>mod</CODE> to preprocess model description files</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">how to process a model definition file</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC15">5.2 Using <CODE>makemcsim</CODE> to fully process model files</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a simple command to preprocess and compile a model</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">how to write a model definition file</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">how to specify a list of SBML models and template model</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Using mod"></A>
<HR SIZE="6">
<A NAME="SEC14"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 5.1 Using <CODE>mod</CODE> to preprocess model description files </H2>
<!--docid::SEC14::-->
<P>

The <CODE>mod</CODE> program is a stand-alone facility. It takes a model
description file in the "user-friendly" format described below
(see section <A HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A>) and creates a C language file
`<TT>model.c</TT>' which you will compile and link to produce the simulation
program. <CODE>Mod</CODE> allows the user to define equations for the model,
assign default values to parameters or default initial values to model
variables, and to initialize them using additional algebraic
equations. <CODE>Mod</CODE> lets the user create and modify models without
having to maintain C code. Under Unix or GNU/Linux, the command line syntax for
the mod program is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>mod [input-file [output-file]]
</pre></td></tr></table></P><P>

where the brackets indicate that the input and output filenames are
optional. If the input filename is not specified, the program will
prompt for both. If only the input filename is specified, the output
is written by default to the file `<TT>model.c</TT>'. Unless you feel like
doing some makefile programming, we recommend using this default since
the makefile for <EM>MCSim</EM> assumes the C language model file to
have this name. You have to have prepared a text file containing a
description of the model following the syntax described in the
following (see section <A HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A>).</P><P>

Most error messages given by <CODE>mod</CODE> are self-explanatory. Where
appropriate, they also give the line number in the model file where the
error occurred. Beware, however, of cascades of errors generated as a
consequence of a first one; so don't panic: start by fixing the first
one and rerun <CODE>mod</CODE>. If you get really stuck you can send a message
to the help mailing list (see section <A HREF="mcsim.html#SEC6">3. Installation</A>) or to the authors of 
this manual.</P><P>

<A NAME="Using makemcsim"></A>
<HR SIZE="6">
<A NAME="SEC15"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC14"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 5.2 Using <CODE>makemcsim</CODE> to fully process model files </H2>
<!--docid::SEC15::-->
<P>

<CODE>makemcsim</CODE> is a Unix <CODE>sh</CODE> shell script that further
facilitates preprocessing and compilation. You run <CODE>makemcsim</CODE>
by entering it at the command prompt:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>makemcsim [model-file]
</pre></td></tr></table></P><P>

where the brackets indicate that the model filename is optional. If a
model filename is not specified, the first file having extension
`<TT>.model</TT>' (by alphabetical order) is used. Makemcsim calls
<CODE>mod</CODE> if the model file has changed since last compilation,
compiles the `<TT>model.c</TT>' generated, links it to the shared
`<TT>libmcsim.so</TT>' library to create an executable
`<TT>mcsim.&#60;root-model-name&#62;</TT>'. The extension `<TT>root-model-name</TT>'
corresponds to your model filename (without its last extension if it has
one; <I>i.e.,</I>typically, without the `<TT>.model</TT>' extension). The
`<TT>model.c</TT>' file is deleted afterward; if you want to inspect it (for
example, if you got error messages from <CODE>mod</CODE>), run <CODE>mod</CODE> on
your model definition file.</P><P>

Two variants of <CODE>makemcsim</CODE> are also available: <CODE>makemcsims</CODE>,
which creates a standalone version (no dynamic libraries needed), and
<CODE>makemcsimd</CODE>, which creates a standalone version with debugging
symbols included (so that you can use gdb, for example, to check what
the code does).</P><P>

<A NAME="Syntax of mod files"></A>
<HR SIZE="6">
<A NAME="SEC16"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC17"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 5.3 Syntax of the model description file </H2>
<!--docid::SEC16::-->
<P>

The model description file is a text (ASCII) file that consists of
several sections, including global declarations, dynamics specifications
(with derivative calculations), model initialization ("scaling"), and
output computations. Here is a template for such a file (for further
examples see section <A HREF="mcsim.html#SEC56">B. Examples</A>):</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>
# Model description file (this is a comment)
&#60;Global variable specifications&#62;
Initialize {
  &#60;Equations for initializing or scaling model parameters&#62;
}
Dynamics {
  &#60;Equations for computing derivatives of the state variables&#62;
}
CalcOutputs {
  &#60;Equations for computing output variables&#62;
}

</pre></td></tr></table></P><P>

<CODE>Initialize</CODE>, <CODE>Dynamics</CODE> and <CODE>CalcOutputs</CODE> are reserved
keywords and, if used, must appear as shown, followed by the curly
braces which delimit each section (see section <A HREF="mcsim.html#SEC23">5.3.7 Model initialization</A>;
<A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>; <A HREF="mcsim.html#SEC25">5.3.9 Output calculations</A>). Please note that at
least one of the sections <CODE>Dynamics</CODE> or <CODE>CalcOutputs</CODE> should
be defined, and that <CODE>Dynamics</CODE> must be used if the model includes
differential equations.</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC22">5.3.6 In line functions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC23">5.3.7 Model initialization</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC25">5.3.9 Output calculations</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC26">5.3.10 Comments on style</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="General syntax"></A>
<HR SIZE="6">
<A NAME="SEC17"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC18"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.1 General syntax </H3>
<!--docid::SEC17::-->
<P>

The general syntax of the model description file is as follows:</P><P>

<UL>
<LI>
<A NAME="IDX8"></A>
<A NAME="IDX9"></A>
Comments begin with a pound sign (<KBD>#</KBD>) and continue to the end of
the line.<P>

<LI>
<A NAME="IDX10"></A>
Blank lines are allowed and ignored.<P>

<LI>
<A NAME="IDX11"></A>
<A NAME="IDX12"></A>
All commands can span several lines and are terminated by a semi-colon
(<KBD>;</KBD>).<P>

<LI>
<A NAME="IDX13"></A>
Four types of variables are used: state variables, output variables,
input variables, and parameters (see section <A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A>).
The name of a variable should be a valid C identifier, starting with a
letter or underscore (<KBD>_</KBD>) and followed by any number of
alpha-numeric characters or underscores, up to a maximum of 80. Variable
names are case sensitive. Note that the name <KBD>IFN</KBD>, in capital
letters, is reserved by the program and should not be used as parameter
or variable name.<P>

<LI>
<A NAME="IDX14"></A>
<A NAME="IDX15"></A>
<A NAME="IDX16"></A>
<A NAME="IDX17"></A>
<A NAME="IDX18"></A>
<A NAME="IDX19"></A>
Variable assignments have the following syntax:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;variable-name&#62; '=' &#60;constant-value-or-expression&#62; ';'
</pre></td></tr></table></P><P>

The equal sign is needed. The right-hand side expression can be a valid
C mathematical expression including numerical constants, already defined
variables, standard ANSI C mathematical functions, and <EM>MCSim</EM>'s
"<EM>special functions</EM>" (see section <A HREF="mcsim.html#SEC20">5.3.4 Special functions</A>) or "<EM>input
functions</EM>" (see section <A HREF="mcsim.html#SEC21">5.3.5 Input functions</A>). Special functions can take already
defined variables, constant values or expressions as parameters. Input
functions can only be used on the right hand side of assignments to
input variables.</P><P>

Colon conditional assignments have the following syntax:<A NAME="IDX20"></A>
<A NAME="IDX21"></A>
<A NAME="IDX22"></A>
<A NAME="IDX23"></A>
<A NAME="IDX24"></A>
<A NAME="IDX25"></A>
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;variable-name&#62; = (&#60;test&#62; ? &#60;value-if-true&#62; : &#60;value-if-false&#62;);
</pre></td></tr></table></P><P>

For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Adjusted_Param = (Input_Var &#62; 0.0 ? Param * 1.1 : Param);
</pre></td></tr></table></P><P>

In this example, if `<SAMP>Input_Var</SAMP>' is greater than 0, the parameter
`<SAMP>Adjusted_Param</SAMP>' is computed as the product of `<SAMP>Param</SAMP>' by
`<SAMP>1.1</SAMP>'; otherwise `<SAMP>Adjusted_Param</SAMP>' is equal to
`<SAMP>Param</SAMP>'. Note that conditional assignments can be nested (<I>i.e.</I>,
&#60;value-if-true&#62; or &#60;value-if-false&#62; can themselves be a conditional
expression). The comparison operators allowed are the equality operator
<CODE>==</CODE>, and non-equality operators <CODE>!=</CODE>, <CODE>&#60;</CODE>, <CODE>&#62;</CODE>,
<CODE>&#60;&#62;</CODE>, <CODE>&#60;=</CODE> and <CODE>&#62;=</CODE>.<A NAME="IDX26"></A>
<A NAME="IDX27"></A>
<A NAME="IDX28"></A>
<A NAME="IDX29"></A>
<A NAME="IDX30"></A>
<A NAME="IDX31"></A>
<A NAME="IDX32"></A>
<A NAME="IDX33"></A>
</P><P>

<LI>
<A NAME="IDX34"></A>
<A NAME="IDX35"></A>
<A NAME="IDX36"></A>
<A NAME="IDX37"></A>
<A NAME="IDX38"></A>
Vectors: (Warning: for now, the square bracket notation can be only
used in the model definition file. It is not recognized in simulation
specification files; for those, the underscore ((<KBD>_</KBD>) unrolling
syntax can be used to address vector components. This limits the
usefulness of this feature).<P>

<I>Vectors' declaration</I>: To declare a variable as a vector use the one
of the two following syntaxes when you first define it:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;variable-name&#62; '[' &#60;integer&#62; ']'
&#60;variable-name&#62; '[' &#60;integer&#62; '-' &#60;integer&#62; ']'
</pre></td></tr></table></P><P>

The variable name is immediately followed by an opening square bracket
('['). The array index bounds (which define the valid indices) can be
given as (long) positive or null integers separated by an hyphen ('-')
(spaces are allowed). In this case the second integer must be higher the
first. They are followed by a closing bracket (']'). The hyphen and
second integer are optional. If only one bound (integer) is given, only
the component with corresponding index is declared. Both syntaxes can be
mixed. For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>States = {y[0-9]};
alpha[0-2] = 1;
beta[0] = 1;
beta[1] = 2;
beta[2-4];
</pre></td></tr></table></P><P>

The previous lines define a state variable `<SAMP>y</SAMP>' as a vector of
length 10, with valid indices ranging between 0 and 9, included. The
parameter vector `<SAMP>alpha</SAMP>' is defined with range 0 to 2, each
component being initialized to value 1. For parameter `<SAMP>beta</SAMP>',
components 0, 1 and 2 to 4 are initialized separately (components 2 to 4
are initialized with default value 0).</P><P>

<I>Accessing vectors' components</I>: After declaration, vector's components
can be accessed individually using the square bracket syntax:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;variable-name&#62; '[' &#60;integer&#62; ']'
</pre></td></tr></table></P><P>

For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Outputs = {x[0-1]};
beta[0] = 0;
beta[1] = beta[0] + 1;
CalcOutputs {
  x[0] = beta[0] * t;
  x[1] = beta[1] * t;
}
</pre></td></tr></table></P><P>

In the above example, `<SAMP>beta[0]</SAMP>', `<SAMP>beta[1]</SAMP>', `<SAMP>x[0]</SAMP>', and
`<SAMP>x[1]</SAMP>' are accessed individually. The variable `<SAMP>t</SAMP>' refers to
the implicit variable 'time'.</P><P>

<I>Vectorization of equations</I>: The equations specifying the model,
which consist in assignments, can be vectorized in the
<CODE>Initialize</CODE>, <CODE>Dynamics</CODE> and <CODE>CalcOutputs</CODE> sections
(but not in the global section) (see section <A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A>). Vectorization allows you to specify an operation for an
entire vector or parts of it. The following syntax should be
used:<A NAME="IDX39"></A>
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;var-name&#62;'['&#60;integer&#62;'-'&#60;integer&#62;']' = &#60;vectorized-expression&#62;;
</pre></td></tr></table></P><P>

On the right-hand side, the vectorized expression should be a valid C
mathematical expression including numerical constants, already defined
state, input, output, other (parameter) variables or vectors, and
standard ANSI C mathematical functions or special functions
(see section <A HREF="mcsim.html#SEC20">5.3.4 Special functions</A>). Here also, input functions (see section <A HREF="mcsim.html#SEC21">5.3.5 Input functions</A>) can only be used on the right hand side of assignments to
input variables. Vector indices on the right-hand side can take the
special form of "<EM>bracketed expressions</EM>". Bracketed expressions can
be composed of integers, the 4 basic arithmetic operators ('+', '-',
'*', '/'), parentheses and the index letter 'i'. The running index 'i'
points in turn to each component in the range specified on the left-hand
side (imagine that the range given on the left-hand side corresponds to
a 'for' loop with index 'i' running from the lower bound to the upper
bound). This is best understood by looking at some code. In the previous
example, the assignments to x[0] and x[1] obviously deserve
vectorization. This is achieved by the following statements:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>CalcOutputs {
  x[0-1] = beta[i] * t;
}
</pre></td></tr></table></P><P>

Here, the index 'i' refers to the values 0 and 1. Here is another
example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Outputs{x[1-10]};
CalcOutputs {
  x[1] = 0;
  x[2-10] = x[i-1] + 1;
}
</pre></td></tr></table></P><P>

This is equivalent to:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Outputs{x[1-10]};
CalcOutputs {
  x[1] = 0;
  x[2] = x[1] + 1;
  ...
  x[10] = x[9] + 1;
}
</pre></td></tr></table></P><P>

and will assign value 1 to `<SAMP>x[2]</SAMP>', 2 to `<SAMP>x[3]</SAMP>', <I>etc</I>. On
the right-hand side, more complicated bracketed expressions like
`<SAMP>[(2*i-1)/(i+3)]</SAMP>' can be used. Another, working, example of vector
use is given in the `<TT>mcsim/samples/pde2</TT>' directory.</P><P>

<I>Alternative 'underscore' ('_') syntax</I>: Individual vector components
can be declared and used (everywhere in the model file) with the
following syntax:<A NAME="IDX40"></A>
<A NAME="IDX41"></A>
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;variable-name&#62;'_'&#60;integer&#62;
</pre></td></tr></table></P><P>

The integer indicates which component of the vector is referred to. For
example `<SAMP>x_1</SAMP>' is strictly equivalent to `<SAMP>x[1]</SAMP>'. Note!: No space
are allowed between the variable name, the underscore and the
integer. Note also!: This syntax is the only one that can be used in
simulation specification files. If you declare a parameter
`<SAMP>beta[1-10]</SAMP>' in your model definition file, the only way to refer
to it in the simulation input file will be through its individual
components `<SAMP>beta_1</SAMP>', `<SAMP>beta_2</SAMP>', ... <I>etc</I>. This limitation
will be removed in a future release of the software.</P><P>

</UL>
<P>

<A NAME="Global variable declarations"></A>
<HR SIZE="6">
<A NAME="SEC18"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC17"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC19"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.2 Global variable declarations </H3>
<!--docid::SEC18::-->
<P>

Commands not specified within the delimiting braces of another section
are considered to be global declarations. In the global section, you
first declare the state, input, and output variables. There should be at
least one state or output variable in your model.</P><P>

<UL>
<LI>
<A NAME="IDX42"></A>
States are variables for which a first-order differential equation is
defined in the <CODE>Dynamics</CODE> section (see section <A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>)
(higher orders or partial differential equations are not
allowed).<P>

<LI>
<A NAME="IDX43"></A>
Inputs are variables independent of the others variables, but eventually
varying with time (for example an exposure concentration to a
chemical).<P>

<LI>
<A NAME="IDX44"></A>
Outputs are dependent model variables (obtainable at any time as
analytical functions of the states, inputs or parameters) that do not
have dynamics. They can receive assignments in the <CODE>Dynamics</CODE>
or <CODE>CalcOutputs</CODE> sections.<P>

</UL>
<P>

The format for declaring each of these variables is the same, and
consists of the keyword <CODE>States</CODE>, <CODE>Inputs</CODE> or <CODE>Outputs</CODE>
followed by an equal sign and a list of the variable names enclosed in 
curly braces as shown here:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>States =   {Qb_fat,  # Benzene in the fat
            Qb_bm,   # ...     in the bone marrow
            Qb_liv}; # ...     in the liver and others

Inputs =   {Q_gav,   # Gavage dose
            C_inh};  # Inhalation concentration

Outputs =  {Cb_exp,  # Concentration in expired air
            Cb_ven}; # ...           in venous blood
</pre></td></tr></table></P><P>

After being defined, states, inputs and outputs can then be given
initial values (constants or expressions). Inputs can also be assigned
input functions, described below (see section <A HREF="mcsim.html#SEC21">5.3.5 Input functions</A>). Some
examples of initialization are shown here:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Qb = 0.1; # Default initial value for state variable Qb

# Input variable assigned a periodic exponential input function
Q = PerExp(1, 60, 0, 1); # Magnitude of 1.0,
                         # period of 60 time units,
                         # T0 in period is 0,
                         # Rate constant is 1.0
</pre></td></tr></table></P><P>

If a state, input, or output variable is not explicitly given an initial
value, that value will be set to zero by default. Initial values are
reset to their specified value by the simulation program at the start of
each simulation of an <CODE>Experiment</CODE> (see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>).</P><P>

All the other variables are "<EM>parameters</EM>". Model parameters you want
to be able to change in simulation input files should be declared in the
global section. For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Wind_speed; # (m/s) Local wind speed
</pre></td></tr></table></P><P>

Parameters are by default assigned a value of zero. To assign a different
nominal values, use the assignment rules given above. For
example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>BodyWt = 65.0 + sqrt(15.0); # Weight of the subject (in kg)
</pre></td></tr></table></P><P>

All parameters and variables are computed in double precision
floating-point format. Initial values should not be such as to cause
computation errors in the model equations; this is likely to lead to
crashing of the program (so, for example, do not assign a default value
of zero to a parameter appearing alone in a denominator). Note that the
order of global declarations matters within the global section itself
(<I>i.e.</I>, parameters and variables should be defined and initialized
before being used in assignments of others), but not with respect to
other blocks. A parameter defined at the end of the description file can
be used in the <CODE>Dynamics</CODE> section which may appear at the
beginning of the file. Still, such an inverse order should be
avoided. For this reason, the format above, where global declarations
come first, is strongly suggested to avoid confusing results. Note again
that the name <CODE>IFN</CODE>, in capital letters, is reserved by the program
and should not be used as parameter or variable name.  Finally, if a
parameter is defined several times, only the first definition is taken
into account (a warning is issued, but beware of it).</P><P>

<A NAME="Model types"></A>
<HR SIZE="6">
<A NAME="SEC19"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC18"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC20"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.3 Model types </H3>
<!--docid::SEC19::-->
<P>

This section deals with structural models. Statistical models that you
setup for model calibration and data analysis are defined in the
simulation input files, through statistical distribution functions. They
are dealt with later in this manual (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).</P><P>

<EM>MCSim</EM> can easily deal with purely algebraic structural
models. You do not need to define state variables or a <CODE>Dynamics</CODE>
section for such models. Simply use input and output variables and
parameters and specify the model in the <CODE>CalcOutputs</CODE> section. You
can use the time variable <CODE>t</CODE> if that is natural for your model. If
your model does not use <CODE>t</CODE>, you will still need to specify "output
times" in <CODE>Print()</CODE> or <CODE>PrintStep()</CODE> statements to obtain
outputs: you can use arbitrary times. If you do not use <CODE>t</CODE> as
"independent" model variable, you will also need do define a
<CODE>Simulation</CODE> section (see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>) for each
combination of values for the independent variables of your model. This
may be clumsy if many values are to be used. In that case, you may want
to use the variable <CODE>t</CODE> to represent something else than
time.</P><P>

Ordinary differential models, with algebraic components, can be easily
setup with <EM>MCSim</EM>. Use state variables and specify a <CODE>Dynamics</CODE>
section. Time, <CODE>t</CODE> is the integration variable, but here again,
<CODE>t</CODE> can be used to represent anything you want. For partial
differential equations some problems might be solved by implementing
line methods (see examples in `<TT>mcsim/samples/pde1</TT>' and
`<TT>mcsim/samples/pde2</TT>')...</P><P>

You can use <EM>MCSim</EM> for discrete-time dynamic models (or difference
models). That is a bit tricky. Assignments in the <CODE>CalcOutputs</CODE>
section are volatile (not memorized), so the model equations have to be
given in a <CODE>Dynamics</CODE> section. But the model variables should still
be declared as outputs, because they should not be updated by
integration. However, you need at least one true differential equation
in the <CODE>Dynamics</CODE> section, so you should declare a dummy state
variable (and assign to its derivative a constant value of zero). You
also want the calls to <CODE>Dynamics</CODE> to be precisely scheduled, so it
is best to use the <CODE>Euler</CODE> integration routine (see section <A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A>) which uses a constant step. Since <CODE>Euler</CODE> may call
repeatedly <CODE>Dynamics</CODE> at any given time, you want to guard against
untimely updating... Altogether, we recommend that you examine the
sample files in the `<TT>mcsim/samples/discrete</TT>' directory provided
with the source code for <EM>MCSim</EM>.</P><P>

<A NAME="Special functions"></A>
<HR SIZE="6">
<A NAME="SEC20"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC19"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC21"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.4 Special functions </H3>
<!--docid::SEC20::-->
<P>

The following special functions (whose name is case-sensitive) are
available to the user for assignment of parameters and variables in the
model definition file:</P><P>

<UL>
<LI>
<A NAME="IDX45"></A>
<A NAME="IDX46"></A>
<A NAME="IDX47"></A>
<CODE>BetaRandom(<VAR>alpha</VAR>, <VAR>beta</VAR>, <VAR>a</VAR>, <VAR>b</VAR>)</CODE>: returns a
Beta distributed variate on the interval [<VAR>a</VAR>,<VAR>b</VAR>] with shape
parameters <VAR>alpha</VAR> and <VAR>beta</VAR>;<P>

<LI>
<A NAME="IDX48"></A>
<A NAME="IDX49"></A>
<A NAME="IDX50"></A>
<CODE>BinomialBetaRandom(<VAR>E</VAR>, <VAR>alpha</VAR>, <VAR>beta</VAR>)</CODE>: return
random variate, of mathematical expectation <VAR>E</VAR>, drawn from a
binomial distribution with probability <VAR>p</VAR>, <VAR>p</VAR> being Beta
distributed with parameters <VAR>alpha</VAR> and <VAR>beta</VAR>;<P>

<LI>
<A NAME="IDX51"></A>
<A NAME="IDX52"></A>
<A NAME="IDX53"></A>
<CODE>BinomialRandom(<VAR>p</VAR>, <VAR>N</VAR>)</CODE>: returns a binomially distributed
random variate;<P>

<LI>
<A NAME="IDX54"></A>
<A NAME="IDX55"></A>
<A NAME="IDX56"></A>
<CODE>CauchyRandom(<VAR>s</VAR>)</CODE>: returns a Cauchy distributed
random variate with scale <VAR>s</VAR>;<P>

<LI>
<A NAME="IDX57"></A>
<A NAME="IDX58"></A>
<A NAME="IDX59"></A>
<A NAME="IDX60"></A>
<CODE>CDFNormal(<VAR>x</VAR>)</CODE>: the normal cumulative density function;
<P>

<LI>
<A NAME="IDX61"></A>
<A NAME="IDX62"></A>
<A NAME="IDX63"></A>
<CODE>Chi2Random(<VAR>dof</VAR>)</CODE>: returns a Chi-squared random variate with
<VAR>dof</VAR> degrees of freedom;<P>

<LI>
<A NAME="IDX64"></A>
<A NAME="IDX65"></A>
<A NAME="IDX66"></A>
<A NAME="IDX67"></A>
<CODE>erfc(<VAR>x</VAR>)</CODE>: the complementary error function;<P>

<LI>
<A NAME="IDX68"></A>
<A NAME="IDX69"></A>
<A NAME="IDX70"></A>
<CODE>ExpRandom(<VAR>beta</VAR>)</CODE>: returns an exponential variate with inverse
scale <VAR>beta</VAR>;<P>

<LI>
<A NAME="IDX71"></A>
<A NAME="IDX72"></A>
<A NAME="IDX73"></A>
<CODE>GammaRandom(<VAR>alpha</VAR>)</CODE>: returns a gamma distributed random
variate with shape parameter <VAR>alpha</VAR> and inverse scale equal to
1;<P>

<LI>
<A NAME="IDX74"></A>
<A NAME="IDX75"></A>
<A NAME="IDX76"></A>
<CODE>GetSeed()</CODE>: returns the current value of the random generator
seed;<P>

<LI>
<A NAME="IDX77"></A>
<A NAME="IDX78"></A>
<A NAME="IDX79"></A>
<CODE>GGammaRandom(<VAR>alpha</VAR>, <VAR>beta</VAR>)</CODE>: returns a gamma distributed
random variate with shape parameter <VAR>alpha</VAR> and inverse scale
<VAR>beta</VAR>;<P>

<LI>
<A NAME="IDX80"></A>
<A NAME="IDX81"></A>
<A NAME="IDX82"></A>
<CODE>InvGGammaRandom(<VAR>alpha</VAR>, <VAR>beta</VAR>)</CODE>: returns an inverse gamma
distributed random variate with shape parameter <VAR>alpha</VAR> and scale
parameter <VAR>beta</VAR>;<P>

<LI>
<A NAME="IDX83"></A>
<A NAME="IDX84"></A>
<A NAME="IDX85"></A>
<A NAME="IDX86"></A>
<CODE>lnDFNormal(<VAR>x</VAR>, <VAR>mean</VAR>, <VAR>sd</VAR>)</CODE>: the natural logarithm
of the normal density function;<P>

<LI>
<A NAME="IDX87"></A>
<A NAME="IDX88"></A>
<A NAME="IDX89"></A>
<CODE>lnGamma(<VAR>x</VAR>)</CODE>: the natural logarithm of the gamma function;
<P>

<LI>
<A NAME="IDX90"></A>
<A NAME="IDX91"></A>
<A NAME="IDX92"></A>
<CODE>LogNormalRandom(<VAR>mean</VAR>, <VAR>sd</VAR>)</CODE>: returns a lognormally
distributed variate with geometric mean <VAR>mean</VAR> and geometric
standard deviation <VAR>sd</VAR> (<I>i.e.</I>, the log of the returned variate
is normally distributed with mean 
log(<VAR>mean</VAR>) and standard deviation log(<VAR>sd</VAR>));
<P>

<LI>
<A NAME="IDX93"></A>
<A NAME="IDX94"></A>
<A NAME="IDX95"></A>
<CODE>LogUniformRandom(<VAR>a</VAR>, <VAR>b</VAR>)</CODE>: returns variate log-uniformly
distributed on the interval [<VAR>a</VAR>,<VAR>b</VAR>];<P>

<LI>
<A NAME="IDX96"></A>
<A NAME="IDX97"></A>
<A NAME="IDX98"></A>
<CODE>NormalRandom(<VAR>mean</VAR>, <VAR>sd</VAR>)</CODE>: returns a normally distributed
random variable with prescribed mean and standard deviation;<P>

<LI>
<A NAME="IDX99"></A>
<A NAME="IDX100"></A>
<A NAME="IDX101"></A>
<CODE>PiecewiseRandom(<VAR>min</VAR>, <VAR>a</VAR>, <VAR>b</VAR>, <VAR>max</VAR>)</CODE>: the
distribution of the returned variate has the form of a truncated
triangle, with base from <VAR>min</VAR> to <VAR>max</VAR> and a plateau between
<VAR>a</VAR> and <VAR>b</VAR>. If
a = b,
the distribution is the triangular distribution;<P>

<LI>
<A NAME="IDX102"></A>
<A NAME="IDX103"></A>
<A NAME="IDX104"></A>
<CODE>PoissonRandom(<VAR>mu</VAR>)</CODE>: returns a Poisson-distributed random
variate, of rate <VAR>mu</VAR>;<P>

<LI>
<A NAME="IDX105"></A>
<A NAME="IDX106"></A>
<A NAME="IDX107"></A>
<CODE>SetSeed(<VAR>seed</VAR>)</CODE>: sets the current value of the pseudo-random
generator seed to the specified <VAR>seed</VAR>. That <VAR>seed</VAR> can be any
positive real number. Seeds between 1.0 and 2147483646.0 are used as is,
the others are rescaled within those bounds (and a warning is
issued);<P>

<LI>
<A NAME="IDX108"></A>
<A NAME="IDX109"></A>
<A NAME="IDX110"></A>
<CODE>StudentTRandom(<VAR>dof</VAR>, <VAR>mean</VAR>, <VAR>sd</VAR>)</CODE>: 
returns a Student <I>t</I> distributed random variate with <VAR>dof</VAR> 
degrees of freedom and given <VAR>mean</VAR> and standard deviation;<P>

<LI>
<A NAME="IDX111"></A>
<A NAME="IDX112"></A>
<A NAME="IDX113"></A>
<CODE>TruncInvGGammaRandom(<VAR>alpha</VAR>, <VAR>beta</VAR>, <VAR>a</VAR>, <VAR>b</VAR>)</CODE>: 
returns a truncated inverse gamma distributed random variate with shape 
parameter <VAR>alpha</VAR> and scale <VAR>beta</VAR>, in the range 
[<VAR>a</VAR>,<VAR>b</VAR>]. Explicit specification of <VAR>a</VAR>,<VAR>b</VAR> is 
required;<P>

<LI>
<A NAME="IDX114"></A>
<A NAME="IDX115"></A>
<A NAME="IDX116"></A>
<CODE>TruncLogNormalRandom(<VAR>mean</VAR>, <VAR>sd</VAR>, <VAR>a</VAR>, <VAR>b</VAR>)</CODE>:
returns a truncated lognormal variate with geometric mean <VAR>mean</VAR> and
geometric standard deviation <VAR>sd</VAR>, in the range
[<VAR>a</VAR>,<VAR>b</VAR>]. Explicit specification of <VAR>a</VAR>,<VAR>b</VAR> is 
required;<P>

<LI>
<A NAME="IDX117"></A>
<A NAME="IDX118"></A>
<A NAME="IDX119"></A>
<CODE>TruncNormalRandom(<VAR>mean</VAR>, <VAR>sd</VAR>, <VAR>a</VAR>, <VAR>b</VAR>)</CODE>: returns
a truncated normal variate with prescribed mean and standard deviation,
in the range [<VAR>a</VAR>,<VAR>b</VAR>]. Explicit
specification of <VAR>a</VAR>,<VAR>b</VAR> is required;<P>

<LI>
<A NAME="IDX120"></A>
<A NAME="IDX121"></A>
<A NAME="IDX122"></A>
<CODE>UniformRandom(<VAR>min</VAR>, <VAR>max</VAR>)</CODE>: returns a uniformly
distributed random variable, sampled between min and max. The algorithm
used is that of Park and Miller (Barry, 1996; Park and Miller, 1988;
Vattulainen et al., 1994) (see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>). A default
random generator seed (314159265.3589793) is used.<P>

</UL>
<P>

Note: for all the above random number generating functions, a default
random generator seed is used. It can be changed with the function
<CODE>SetSeed</CODE>. Note also that assignment of a random number generating
function to a state variable derivative will define a form of stochastic
differential equation. <EM>MCSim</EM>'s integration routines are not particularly
suited to the resolution of such equations. If you wish to try it
anyway, you may want to consider using the "robust" Euler method
(see section <A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A>).</P><P>

<A NAME="Input functions"></A>
<HR SIZE="6">
<A NAME="SEC21"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC20"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC22"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.5 Input functions </H3>
<!--docid::SEC21::-->
<P>

These functions can be used in special assignments, valid only for input
variables. Inputs can be initialized to a constant or to a standard
mathematical expression, or assigned one of the following input
functions:</P><P>

<UL>
<LI>
<A NAME="IDX123"></A>
<A NAME="IDX124"></A>
<CODE>PerDose()</CODE> specifies a periodic input of constant <VAR>&#60;magnitude&#62;</VAR>.
The input begins at <VAR>&#60;initial-time&#62;</VAR> in the <VAR>&#60;period&#62;</VAR> and lasts for
<VAR>&#60;exposure-time&#62;</VAR> time units. Syntax:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PerDose(&#60;magnitude&#62;, &#60;period&#62;, &#60;initial-time&#62;, &#60;exposure-time&#62;);
</pre></td></tr></table></P><P>

<LI>
<A NAME="IDX125"></A>
<A NAME="IDX126"></A>
<CODE>PerExp()</CODE> specifies a periodic exponential input. At time
<VAR>&#60;initial-time&#62;</VAR> in the <VAR>&#60;period&#62;</VAR> the input rises instantaneously
to <VAR>&#60;magnitude&#62;</VAR> and begins to decay exponentially with the constant
<VAR>&#60;decay-constant&#62;</VAR>. The input is turned off once the magnitude reaches
a negligible fraction 
of its original value. Note that the input does not accumulate across
periods, it resets at each period start. Syntax:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PerExp(&#60;magnitude&#62;, &#60;period&#62;, &#60;initial-time&#62;, &#60;decay-constant&#62;);
</pre></td></tr></table></P><P>

<LI>
<A NAME="IDX127"></A>
<A NAME="IDX128"></A>
<CODE>NDoses()</CODE> specifies a number of stepwise inputs of variable
magnitude and their starting times. The first argument, <VAR>&#60;n&#62;</VAR>, is the
number of input steps and start times. Next come a list of magnitudes
and a list of corresponding initial times. Each list is comma-separated.
The duration of each input step is computed automatically by difference
between the listed times. Currently this function can only be used in
the simulation description file, and not in the model description file
(which simply implies that you cannot use it as a default).
Syntax:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>NDoses(&#60;n&#62;, &#60;list-of-magnitudes&#62;, &#60;list-of-initial-times&#62;);
</pre></td></tr></table></P><P>

Note that the list of times <EM>must</EM> begin at the starting time of the
simulation (typically time zero), even if the magnitude at that first time
is zero.</P><P>

<LI>
<A NAME="IDX129"></A>
<A NAME="IDX130"></A>
<CODE>Spikes()</CODE> specifies a number of instantaneous inputs of variable
magnitude and their exact times of occurrence. The first argument,
<VAR>&#60;n&#62;</VAR>, is the number of inputs and input times. Next come a list of
magnitudes and a list of times. Each list is comma-separated.
Currently this function can only be used in the simulation description
file, and not in the model description file (which simply implies that
you cannot use it as a default). Syntax:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Spikes(&#60;n&#62;, &#60;list-of-magnitudes&#62;, &#60;list-of-times&#62;);
</pre></td></tr></table></P><P>

</UL>
<P>

The arguments of input functions can either be constants or variables.
For example, if `<SAMP>Mag</SAMP>' and `<SAMP>RateConst</SAMP>' are defined model
parameters, then the input variable `<SAMP>Q_in</SAMP>' can be defined
as:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Q_in = PerExp(Mag, 60, 0, RateConst);
</pre></td></tr></table></P><P>

In this way the parameters of input functions can, for example, be
assigned statistical distributions in Monte Carlo simulations
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>). Variable dependencies are resolved
before each simulation specified by an <CODE>Experiment</CODE>
(see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>).</P><P>

For each of the periodic functions, a single exposure beginning at time
<VAR>initial-time</VAR> can be specified by giving an effectively infinite
period,
<I>e.g.</I> 1e10. 
The first period starts at the initial time of the simulation.
Magnitudes change exactly at the times given.</P><P>

Input variables assigned input functions can be combined to give a lot
of flexibility (<I>e.g.</I>, an input variable can be declared as the sum
of others). Separate inputs can also be declared in the global section
of the model definition file and combined in the <CODE>Dynamics</CODE>
(see section <A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>) and <CODE>CalcOutputs</CODE> (see section <A HREF="mcsim.html#SEC25">5.3.9 Output calculations</A>) sections.</P><P>

<A NAME="In line functions"></A>
<HR SIZE="6">
<A NAME="SEC22"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC21"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC23"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.6 In line functions </H3>
<!--docid::SEC22::-->
<P>

<CODE>Inline()</CODE> functions can be placed in the various sections of a
model file to introduce standard C code (or whatever) in your
models. Text placed between the parentheses of an <CODE>Inline</CODE>
function will be passed <EM>as is</EM> to the C compiler.  That text can
span several lines but its size should not exceed MAX_EQN (defined in
`<TT>lex.h</TT>'); In case it does, you can increase MAX_EQN (and
recompile `<TT>mod</TT>'...) or you can split you text between any number
of <CODE>Inline()</CODE> in a row. It is your responsibility to make sure
that the code passed can be compiled without errors!</P><P>

Example:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Inline(printf("hello/n"));
</pre></td></tr></table></P><P>

<A NAME="Model initialization"></A>
<HR SIZE="6">
<A NAME="SEC23"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC22"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC24"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.7 Model initialization </H3>
<!--docid::SEC23::-->
<P>

The model initialization section begins with the keyword
<CODE>Initialize</CODE> (the keyword <CODE>Scale</CODE> is obsolete but is still
understood) and is enclosed in curly braces. The equations given in this
section will define a function (subroutine) that will be called by
<EM>MCSim</EM> after the assignments specified in each <CODE>Experiment</CODE>
are done (see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>). They are the last
initializations performed. The model file in `<TT>mcsim/samples/perc</TT>'
gives an example of the use of <CODE>Initialize</CODE> (see section <A HREF="mcsim.html#SEC59">B.3 `<TT>perc.model</TT>': A sample model description file</A>, in
Appendix).</P><P>

All model variables and parameters, except inputs, can be changed in
this section. Modifications to state variables affect initial values
only. In this section, state variables, outputs and parameters (but not
input variables) can also appear at the the right-hand side of
equations.</P><P>

Additional parameters (to those declared in the global section) may be
used within the section. They will be declared as local temporary
variables and their scope will be limited to the <CODE>Initialize</CODE>
section (<I>i.e.</I>, their value and existence will be forgotten outside
the section).</P><P>

The <CODE>dt()</CODE> operator (see section <A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>) cannot be
used in this section, since derivatives have not yet been computed when
the scaling function is called.</P><P>

<A NAME="Dynamics section"></A>
<HR SIZE="6">
<A NAME="SEC24"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC23"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC25"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.8 Dynamics section </H3>
<!--docid::SEC24::-->
<P>

The dynamics specification section begins with the keyword
<CODE>Dynamics</CODE> and is enclosed in curly braces. The equations given in
this section will be called by the integration routines at each
integration step. <CODE>Dynamics</CODE> must be used if the model includes
differential equations.</P><P>

Additional parameters (to those declared in the global section) may be
used for any calculations within the section. They will be declared as
local temporary variables. (Note, for example, the use of
`<SAMP>Cout_fat</SAMP>' and `<SAMP>Cout_wp</SAMP>' in the `<TT>perc.model</TT>' sample
file). Local variables are not accessible from the simulation program,
or from other sections of the model definition file, so don't try to
output them.</P><P>

Each state variable declared in the global section must have one
corresponding differential equation in the <CODE>Dynamics</CODE>
section. If a differential equation is missing, <CODE>mod</CODE> issues an
error message such as:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Error: State variable 'Q_foo' has no dynamics.
</pre></td></tr></table></P><P>

and no `<TT>model.c</TT>' file or executable program will be created.</P><P>

<A NAME="IDX131"></A>
<A NAME="IDX132"></A>
The derivative of a state variable is defined using the <CODE>dt()</CODE>
operator, as shown here:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>dt(state-variable) '=' constant-value-or-expression ';'
</pre></td></tr></table></P><P>

The right-hand side can be any valid C expression, including standard
math library calls and the special functions mentioned above
(see section <A HREF="mcsim.html#SEC20">5.3.4 Special functions</A>). Note that no syntactic check is performed
on the library function calls. Their correctness is your
responsibility.</P><P>

The <CODE>dt()</CODE> operator can also be used in the right-hand side of
equations in the dynamics section to refer to the value of a derivative
at that point in the calculations. For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>dt(Qm_in) = Qmetabolized - dt(Qm_out);
</pre></td></tr></table></P><P>

<A NAME="IDX133"></A>
The integration variable (<I>e.g.</I>, time) can be accessed if referred
to as <CODE>t</CODE>, as in:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>dt(Qm_in) = Qmetabolized - t;
</pre></td></tr></table></P><P>

Output variables can also be made a function of <CODE>t</CODE> in the
<CODE>Dynamics</CODE> section.</P><P>

Note that while state variables, input variables and model parameters
can be used on the right-hand side of equations, they cannot be assigned
values in the <CODE>Dynamics</CODE> section. If you need a parameter to
change with time, you can declare it as an output variable in the global
section. Assignments to states, inputs or parameters in this section
causes an error message like the following to be issued:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Error: line 48: 'YourParm' used in invalid context.
Parameters cannot be defined in Dynamics{} section.
</pre></td></tr></table></P><P>

<A NAME="Output calculations"></A>
<HR SIZE="6">
<A NAME="SEC25"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC24"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC26"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.9 Output calculations </H3>
<!--docid::SEC25::-->
<P>

The output calculation section begins with the keyword <CODE>CalcOutputs</CODE>
and is enclosed in curly braces. The equations given in this section
will be called by the simulation program at each output time specified
by a <CODE>Print()</CODE> or <CODE>PrintStep()</CODE> statement (see section <A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A>, and see section <A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A>). In this way, output 
computations are done efficiently, only when values are to be saved.</P><P>

Only variables that have been declared with the keyword <CODE>Outputs</CODE>,
or local temporary variables, can receive assignments in this section.
Assignments to other types of variables cause an error message like the
following to be issued:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Error: line 56: 'Qb_fat' used in invalid context.
Only output and local variables can be defined in CalcOutputs section.
</pre></td></tr></table></P><P>

Any reference to an input or state variable will use the current value
(at the time of output). The <CODE>dt()</CODE> operator can appear in the
right-hand side of equations, and refers to current values of the
derivatives (see section <A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>). Like in the
<CODE>Dynamics</CODE> section, the integration variable can be accessed if
referred to as <CODE>t</CODE>, as in:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Qx_out = DQx * t;
</pre></td></tr></table></P><P>

<A NAME="Comments on style"></A>
<HR SIZE="6">
<A NAME="SEC26"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC25"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC15"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 5.3.10 Comments on style </H3>
<!--docid::SEC26::-->
<P>

For your model file to be readable and understandable, it is useful to
use a consistent notation style. The example file `<TT>perc.model</TT>'
tries to follow such a style (see section <A HREF="mcsim.html#SEC59">B.3 `<TT>perc.model</TT>': A sample model description file</A>). For example we
suggest that:</P><P>

<UL>
<LI>
All variable names begin with a capital letter followed by meaningful
lower case subscripts.<P>

<LI>
Where two subscripts are necessary, they can be separated by an
underscore, such as in `<SAMP>Qb_fat</SAMP>'.<P>

<LI>
Where there is only one subscript an underscore can still be used to
increase readability as in `<SAMP>Q_fat</SAMP>'.<P>

<LI>
Where two words are used in combination to name one item, they can be
separated visually by capitalizing each word, as in `<SAMP>BodyWt</SAMP>'.</UL>
<P>

These conventions are suggestions only. The key to have a consistent
notation that makes sense to you. Consistency is one of the best ways
to:</P><P>

<OL>
<LI>
Increase readability, both for others and for yourself. If you
have to suspend work for a month or two and then come back to it, the
last thing you want is to have to decipher your own file.<P>

<LI>
Decrease the likelihood of mistakes. If all of the equations are
coded with a consistent, logical convention, mistakes stand out more
readily.</OL>
<P>

Last, but not least, do use comments to annotate your code! Also: make
sure your comments are accurate and update them when you change your
code. In our experience, an enormous number of hours has been wasted in
trying to figure out inconsistencies that existed only because of
inaccurate comments (<I>e.g.</I>, erroneous comments about the reasons for
choice of default parameter values). That does not decrease the value of
good comments, however...</P><P>

<A NAME="Reading SBML models"></A>
<HR SIZE="6">
<A NAME="SEC27"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC26"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC16"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 5.4 Reading SBML models and applying a template </H2>
<!--docid::SEC27::-->
<P>

To read models written in SBML, you simply need to create a text file
of the same format as an <EM>MCsim</EM> model definition file (comments
starting with <KBD>#</KBD>, file ending with <CODE>End</CODE>, <I>etc</I>.)  In that
file, you specify a list of one or more SBML model files with the
keyword <CODE>SBMLModels</CODE> followed by an equal sign and a list of SBML
model file names (of maximum size MAX_FILENAMESIZE, 80 characters, as
defined in mod.h), enclosed in curly braces, as shown here:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#---------------------------------------------------------
# SBML_List.in
# Use it as "mod SBML_List.in"
#---------------------------------------------------------

SBMLModels = {"C_central.xml", "C_periph.xml"};

End.
</pre></td></tr></table></P><P>

Give that file as input to <CODE>mod</CODE>, by typing in <CODE>mod
SBML_List.in</CODE> on your shell command line.  A `<TT>model.c</TT>' file is
produced, suitable for further compilation by <CODE>makemcsim</CODE>.  SBML
model files are typically ASCII text files with a <I>xml</I> extension
(for examples see `<TT>mcsim/sim/samples/SBML</TT>').  SBML Level 1 and
Level 2 are recognized (but some features of Level 2 are not yet
understood by <CODE>mod</CODE>, such as <CODE>functionDefinition</CODE>,
<CODE>unit</CODE>, <CODE>rateRule</CODE> and a few others.) Compartments are
ignored unless a model template for circulating species is given (see
below).</P><P>

If two or more of the SBML files define a same chemical species,
<CODE>mod</CODE> merges the models: namely, the rate equation for that
species will be the sum of the rate equations implied by each
model. In fact, <CODE>mod</CODE> constructs the rate equations from the
reaction descriptions given by the SBML format. State variables and
parameters keep the same name after merging, so they should be unique
from the start to each SBML model, to avoid confusion.</P><P>

To automatically extend SBML models with transport components, a
template model can be applied to all the species defined in SBML which
are placed in the default compartment (conventionally called
<CODE>compartment</CODE>), and outside of other compartments whose names are
specified by the template itself. Specifically: the template model
should define compartments and differential equations terms for the
transport of an unspecified species between those compartments (the
syntax for that will be described below). For each species placed in
SBML <EM>outside</EM> one of the defined compartments, a differential
equations is created for each compartment using the template transport
terms. The differentials for the compartments found in both the
template and the SBML models will contain both transport and kinetic
terms. With the exception of the generic <CODE>compartment</CODE>, the SBML
models merged can only use the compartments defined by the template
(compartment name recognition is case-sensitive). Species placed in
SBML <EM>inside</EM> one of the defined compartments are not transported
and stay local to that compartment. Their differentials will contain
only the reaction kinetics terms defined by the SBML models.</P><P>

There might be many applications of the template mechanism, and they
are left to the reader to imagine.</P><P>

The template model is specified with <CODE>PKTemplate</CODE> keyword,
followed by an equal sign and the file name of a template model file
(of maximum size MAX_FILENAMESIZE, 80 characters, as defined in
mod.h), enclosed in curly braces, like in:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#---------------------------------------------------------
# SBML_List.in
# Use it as "mod SBML_List.in"
#---------------------------------------------------------

PKTemplate = {"input_f/2cpt_PBPK.model"};

SBMLModels = {"C_central.xml", "C_periph.xml"};

End.
</pre></td></tr></table></P><P>

<A NAME="IDX134"></A>
<A NAME="IDX135"></A>
<A NAME="IDX136"></A>
<A NAME="IDX137"></A>
The template structure is similar to that of other <EM>MCSim</EM>
models, with two exceptions: First, the variables and parameters which
are supposed to apply to several chemical species defined in SBML are
preceeded with an underscore (<KBD>_</KBD>). Second, the compartments
allowed in SBML and for which the template is defined are declared
using the keyword <CODE>Compartment</CODE>, followed by an equal sign and a
list of the compartment names enclosed in curly braces.  Here is an
example of template file:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#---------------------------------------------------------
# Template for pharmacokinetic modeling
#---------------------------------------------------------

States = {_central, _periph};
Inputs = {_Dose_rate};
Outputs = {_Q_total};
Compartments = {central, peripheral};

# Species-dependent parameters
_PC = 2;
_K_urine;

# Species-independent parameters
V_central; 
V_periph;  

Initialize { _K_urine = _K_urine * 2; }

Dynamics {
  _Q_rate_c_p = 5 * (_central - _periph / _PC);

  # Central compartment quantity
  _pk_central  = (_Dose_rate - _Q_rate_c_p - 
                  _K_urine * _central) / V_central;
  dt(_central) = _pk_central;

  # Peripheral compartment quantity
  _pk_periph  = _Q_rate_c_p / V_periph;
  dt(_periph) = _pk_periph;
 }

CalcOutputs { _Q_total = _central / V_central + _periph / V_periph; }

End.
</pre></td></tr></table></P><P>

With that template, each species, say <VAR>S1</VAR>, defined in SBML to be
outside of the <CODE>central</CODE> or <CODE>peripheral</CODE> compartments will
be cloned to form the state variables <VAR>S1_central</VAR> and
<VAR>S1_peripheral</VAR>. Those will have associated differential equations
using specific parameters <VAR>S1_PC</VAR> or unspecific ones like
V_central. The chemical reactions defined in SBML to take place inside
the central or peripheral compartments will be translated into
specific terms added to the <CODE>dt(_central)</CODE> and
<CODE>dt(_periph)</CODE> equations.</P><P>

<A NAME="Running Simulations"></A>
<HR SIZE="6">
<A NAME="SEC28"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC27"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC13"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 6. Running Simulations </H1>
<!--docid::SEC28::-->
<P>

After having your model processed by <CODE>mod</CODE> or <CODE>makemcsim</CODE>,
and obtained an executable `<TT>mcsim_...</TT>' file, you are ready to run
simulations. For this you need to write simulation files. This chapter
explains how to write such files with the proper syntax and how to run
the executable program.</P><P>

You may want to first give a look at the examples given in the
`<TT>mcsim/samples</TT>' directory. An sample file `<TT>perc.lsodes.in</TT>',
which works with the perchloroethylene model `<TT>perc.model</TT>', is also
given in an Appendix to this manual (see section <A HREF="mcsim.html#SEC60">B.4 `<TT>perc.lsodes.in</TT>'</A>).</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC29">6.1 Using the compiled program</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">how to process a simulation file</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC30">6.2 Syntax of the simulation definition file</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">how to write a simulation file</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">beyond MCSim...</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC51">6.4 Error handling</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Using the compiled program"></A>
<HR SIZE="6">
<A NAME="SEC29"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 6.1 Using the compiled program </H2>
<!--docid::SEC29::-->
<P>

<EM>MCSim</EM> provides several types of simulations for the models you
create. Simulations are specified in a text file of format similar to
that of the model description file.</P><P>

Assume that your model `<TT>a.model</TT>' has been preprocessed and compiled
by <CODE>makemcsim</CODE> (see section <A HREF="mcsim.html#SEC15">5.2 Using <CODE>makemcsim</CODE> to fully process model files</A>) to generate an executable
`<TT>mcsim_my</TT>'. If you have renamed the executable file, substitute
`<TT>mcsim_my</TT>' by the name of your executable in the following. In
Unix the command-line syntax to run that executable is simply:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>mcsim_a [input-file [output-file]]
</pre></td></tr></table></P><P>

where the brackets indicate optional arguments. If no input and output
file names are specified, the program will prompt you for them. You must
provide an input file name. That file should describe the simulations to
perform and specify which outputs should be printed out (see section <A HREF="mcsim.html#SEC30">6.2 Syntax of the simulation definition file</A>). If you just hit the return key when prompted for
the output name, the program will use the name you have specified in the
input file, if any, or a default name (see section <A HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A>). If just one file name is given on the command-line, the
program will assume that it specifies the input file. For the output
filename, the program will then use the name you have specified in the
input file, if any, or a default name.</P><P>

When the program starts up, it announces which model description file
was used to create it. While the input file is read or while simulations
are running, some informations will be printed on your computer
screen. They can help you check that the input file is correctly
interpreted and that the program runs as it should. <EM>MCSim</EM> can also post
error messages, which should be self-explanatory. Where appropriate,
they show the line number in the input file where the error occurred.
Beware, however, of cascades of errors generated as a consequence of a
first one; also errors may be detected after the line in which they
really occur and the line number shown will be unhelpful; don't panic:
start by fixing the first error in the input file and rerun your
executable. You should not need to recompile your executable, unless you
have changed the model itself. If you get really stuck you can send a
message to the mailing list "help-mcsim@prep.ai.mit.edu"
(see section <A HREF="mcsim.html#SEC6">3. Installation</A>) or to the authors of this manual.</P><P>

The program ends (if everything is fine) by giving you the name of the
output file generated. If you want to run the program in batch mode (in
the background), you may want to redirect the screen output and error
messages; refer for this to the <CODE>man</CODE> pages for your shell.</P><P>

<A NAME="Syntax of simulation files"></A>
<HR SIZE="6">
<A NAME="SEC30"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC31"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 6.2 Syntax of the simulation definition file </H2>
<!--docid::SEC30::-->
<P>

A simulation specification file is a text (ASCII) file that consists of
several sections, starting with global specifications and assignments
(valid throughout the file), followed by a number of <CODE>Simulation</CODE>
sections (see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>), eventually enclosed in
<CODE>Level</CODE> sections. (The keyword <CODE>Experiment</CODE> is now obsolete but
can still be used as a synonym for <CODE>Simulation</CODE>.)</P><P>

Each <CODE>Simulation</CODE> section defines simulation conditions, from an
initial time (or whatever the dependent variable represents,
see section <A HREF="mcsim.html#SEC19">5.3.3 Model types</A>) to a final time. Initial values of the model state
variables, parameter values, input variables time-course, and which
outputs are to be printed at which times, can all be changed in a given
<CODE>Simulation</CODE> section.</P><P>

In simple cases, the general layout of the file is therefore (see also
the sample file in <A HREF="mcsim.html#SEC60">B.4 `<TT>perc.lsodes.in</TT>'</A>):</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>
# Input file (text after # are comments)
&#60;Global assignments and specifications&#62;
Simulation {
  &#60;Specifications for first simulation&#62;
}
Simulation {
  &#60;Specifications for second simulation&#62;
}
# Unlimited number of simulation specifications
End. # Optional End statement. Everything after this line is ignored

</pre></td></tr></table></P><P>

For Markov chain Monte Carlo simulations (see section <A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>),
the general layout of the file must include <CODE>Level</CODE> sections.
<CODE>Level</CODE> sections are used to define a hierarchy of statistical
dependencies (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>). In that case, the
general layout of the file is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>
# Input file
&#60;Global assignments and specifications&#62;
Level {
  # Up to 10 levels of hierarchy
  Simulation {
    &#60;Specifications and data for first simulation&#62;
  }
  Simulation {
    &#60;Specifications and data for second simulation&#62;
  }
  # Unlimited number of simulation specifications
} # end Level
End. # Optional statement.

</pre></td></tr></table></P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC31">6.2.1 General input file syntax</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC33">6.2.3 Global specifications</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC42">6.2.4 Specifying basic conditions to simulate</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC51">6.4 Error handling</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="General input file syntax"></A>
<HR SIZE="6">
<A NAME="SEC31"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 6.2.1 General input file syntax </H3>
<!--docid::SEC31::-->
<P>

The general syntax of the file is the same as that of structural model
definition files (see section <A HREF="mcsim.html#SEC17">5.3.1 General syntax</A>) except that:</P><P>

<UL>
<LI>
No new variable can be created (all variables must have been defined in
the model definition file). Assignments can only modify the value of
already defined model variables. This implies that parameters needed to
set up a statistical model must be declared in the model definition
file, even if the structural model does not use them.<P>

<LI>
Assignments to state variables or parameters can only use constant
values; mathematical expressions are not allowed.<P>

<LI>
Input variables' assignments can use any input function (including the
<CODE>NDoses()</CODE> and <CODE>Spikes()</CODE> functions) or constant
values.<P>

<LI>
Output variables cannot receive assignments.</UL>
<P>

At the program start, all model parameters are initialized to the
nominal values specified in the model description file. Next, after the
input file is read, modifications given in its global section (including
random sampling) are applied, then those specified at each <CODE>Level</CODE>,
and finally any modifications specified by the <CODE>Simulation</CODE>
sections. Computations specified in the <CODE>Initialize</CODE> section of the
model definition file are the last initialization statements
executed.</P><P>

Structural changes to the model (<I>e.g.</I>, addition of a state, input,
output or parameter) cannot be done here and must be done in the model
description file. The simulation specification file is read until its
end is reached, or until an <CODE>End</CODE> command is reached.</P><P>

<A NAME="Input functions revisited"></A>
<HR SIZE="6">
<A NAME="SEC32"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC31"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 6.2.2 Input functions (revisited) </H3>
<!--docid::SEC32::-->
<P>

Input variables can be assigned all the input functions defined
previously (see section <A HREF="mcsim.html#SEC21">5.3.5 Input functions</A>). Briefly, these are:</P><P>

<UL>
<LI>
<A NAME="IDX138"></A>
<A NAME="IDX139"></A>
<CODE>PerDose()</CODE>:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PerDose(&#60;magnitude&#62;, &#60;period&#62;, &#60;initial-time&#62;, &#60;exposure-time&#62;);
</pre></td></tr></table></P><P>

<LI>
<A NAME="IDX140"></A>
<A NAME="IDX141"></A>
<CODE>PerExp()</CODE>:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PerExp(&#60;magnitude&#62;, &#60;period&#62;, &#60;initial-time&#62;, &#60;decay-constant&#62;);
</pre></td></tr></table></P><P>

<LI>
<A NAME="IDX142"></A>
<A NAME="IDX143"></A>
<CODE>NDoses()</CODE>:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>NDoses(&#60;n&#62;, &#60;list-of-magnitudes&#62;, &#60;list-of-initial-times&#62;);
</pre></td></tr></table></P><P>

<LI>
<A NAME="IDX144"></A>
<A NAME="IDX145"></A>
<CODE>Spikes()</CODE>:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Spikes(&#60;n&#62;, &#60;list-of-magnitudes&#62;, &#60;list-of-times&#62;);
</pre></td></tr></table></P><P>

</UL>
<P>

<A NAME="Global specifications"></A>
<HR SIZE="6">
<A NAME="SEC33"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC34"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 6.2.3 Global specifications </H3>
<!--docid::SEC33::-->
<P>

In the global section you can modify, by assignment, the value of
already defined state or input model variables or parameters (you cannot
assign a value to an output variable). These assignments will be in
effect throughout the input file, unless they are overridden later in
the file. Here is an exemple of assignment (assuming that <CODE>x</CODE> and
<CODE>Pi</CODE> have been properly defined in the model definition
file):</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>x = 10; # set the initial value if x is a state variable
Pi = 3; # to stop worrying about little decimals...
</pre></td></tr></table></P><P>

In the global section, you can also give specifications relevant to all
<CODE>Simulation</CODE> or <CODE>Level</CODE> sections. These specifications are not
needed if you just want to perform simple simulations. They should also
not appear inside <CODE>Simulation</CODE> or <CODE>Level</CODE> sections (with the
notable exception of <CODE>Distrib()</CODE> specifications which can appear
inside <CODE>Level</CODE> sections). They are used to call for and define the
parameters of special computations (<I>e.g.</I>, the number of Monte Carlo
simulations to run, which sampling distributions to use for a given
parameter, the data likelihood, <I>etc</I>.) These specifications are the
following:</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC41"><CODE>SimType()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="OutputFile() specification"></A>
<HR SIZE="6">
<A NAME="SEC34"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC35"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>OutputFile()</CODE> specification </H4>
<!--docid::SEC34::-->
<P>

The <CODE>OutputFile()</CODE> specification allows you to specify a name for
the output file of basic simulations. If this specification is not given
the name `<TT>sim.out</TT>' is used if none has been supplied on the
command-line or during the initial dialog. The corresponding syntax
is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>OutputFile("&#60;OutputFilename&#62;");
</pre></td></tr></table></P><P>

where the character string <VAR>&#60;OutputFilename&#62;</VAR>, enclosed in double
quotes, should be a valid file name for your operating system.</P><P>

  
</P><P>

<A NAME="Integrate() specification"></A>
<HR SIZE="6">
<A NAME="SEC35"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC34"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC36"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Integrate()</CODE> specification </H4>
<!--docid::SEC35::-->
<P>

The integrator settings can be changed with the <CODE>Integrate</CODE>
specification.  Two integration routines are provided: <CODE>Lsodes</CODE>
(which originates from the SLAC Fortran library and is originally based
on Gear's routine) (Gear, 1971b; Gear, 1971a; Press et al., 1989)
(see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>) and <CODE>Euler</CODE> (Press et al.,
1989).</P><P>

The syntax for <CODE>Lsodes</CODE> is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Integrate(Lsodes, &#60;rtol&#62;, &#60;atol&#62;, &#60;method&#62;);
</pre></td></tr></table></P><P>

where <VAR>&#60;rtol&#62;</VAR> is a scalar specifying the relative error tolerance for each
integration step. The scalar <VAR>&#60;atol&#62;</VAR> specifies the absolute error
tolerance parameter. They are used for all state variables. The
estimated local error for a state variable <VAR>y</VAR> is controlled so as
to be roughly less (in magnitude) than
<VAR>rtol</VAR>*|<VAR>y</VAR>| + <VAR>atol</VAR>.
Thus the local error test passes if, for each state variable, either the
absolute error is less than <VAR>&#60;atol&#62;</VAR>, or the relative error is less
than <VAR>&#60;rtol&#62;</VAR>. Set <VAR>&#60;rtol&#62;</VAR> to zero for pure absolute error control,
and set <VAR>&#60;atol&#62;</VAR> to zero for pure relative error control. Caution:
actual (global) errors may exceed these local tolerances, so choose them
conservatively. The <VAR>&#60;method&#62;</VAR> flag should be 0 (zero) for non-stiff
differential systems and 1 for stiff systems. You should try both and
select the fastest for equal accuracy of output, unless insight from
your system leads you to choose one of them <I>a priori</I>. In our
experience, a good starting point for <VAR>&#60;atol&#62;</VAR> and <VAR>&#60;rtol&#62;</VAR> is about
1e-6.</P><P>

The syntax for <CODE>Euler</CODE> is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Integrate(Euler, &#60;time-step&#62;, 0, 0);
</pre></td></tr></table></P><P>

where <VAR>&#60;time-step&#62;</VAR> is a scalar specifying the constant time increment for
each integration step. The next two scalars are reserved for future use
and should be set to zero.</P><P>

Note: if the <CODE>Integrate()</CODE> specification is not used, the default
integration method is <CODE>Lsodes</CODE> with parameters
1e-5, 1e-7 and 1. 
We recommend using <CODE>Lsodes</CODE>, since is it highly accurate and
efficient. <CODE>Euler</CODE> can be used for special applications (<I>e.g.</I>, in
system dynamics) where a constant time step and a simple algorithm are
needed.</P><P>

<A NAME="MonteCarlo() specification"></A>
<HR SIZE="6">
<A NAME="SEC36"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC35"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC37"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>MonteCarlo()</CODE> specification </H4>
<!--docid::SEC36::-->
<P>

Monte Carlo simulations (Hammersley and Handscomb, 1964; Manteufel,
1996) (see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>) randomly sample parameter
values and run the model for each parameter set so generated. The
statistical distribution of the model outputs can be studied for
uncertainty analysis, sensitivity analysis <I>etc</I>. Such simulations
require the use of two specifications, <CODE>MonteCarlo()</CODE> and
<CODE>Distrib()</CODE>, which must appear in the global section of the file,
before the <CODE>Simulation</CODE> sections. They are ignored if they appear
inside a <CODE>Simulation</CODE> section.</P><P>

The <CODE>MonteCarlo</CODE> specification gives general information required
for the runs: the output file name, the number of runs to perform, and a
starting seed for the random number generator. Its syntax is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>MonteCarlo("&#60;OutputFilename&#62;", &#60;nRuns&#62;, &#60;RandomSeed&#62;);
</pre></td></tr></table></P><P>

The character string <VAR>&#60;OutputFilename&#62;</VAR>, enclosed in double quotes,
should be a valid filename for your operating system. If a null-string
"" is given, the default name `<TT>simmc.out</TT>' will be used. The number
of runs <VAR>&#60;nRuns&#62;</VAR> should be an integer, and is only limited by either
your storage space for the output file or the largest (long) integer
available on your machine. The seed <VAR>&#60;RandomSeed&#62;</VAR> of the
pseudo-random number generator can be any positive real number. Seeds
between 1.0 and 2147483646.0 are used as is, the others are rescaled
within those bounds (and a warning is issued). Here is an example of
use:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>MonteCarlo("percsimmc.out", 50000, 9386.630);
</pre></td></tr></table></P><P>

The parameters' sampling distributions are specified by a list of
<CODE>Distrib()</CODE> specifications, as explained in the following
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>). The format of the output file of
Monte Carlo simulations is discussed later (see section <A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A>).</P><P>

<A NAME="MCMC() specification"></A>
<HR SIZE="6">
<A NAME="SEC37"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC36"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC38"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>MCMC()</CODE> specification </H4>
<!--docid::SEC37::-->
<P>

Markov chain Monte Carlo (<EM>MCMC</EM>) can be defined as stochastic
simulations following a Markov chain in a given parameter space. In MCMC
simulations, the random choice of a new parameter value is influenced by
the current value. They can be used to obtain a sample of parameter
values from complex distribution functions, eventually intractable
analytically. Such complex distribution functions are typically
encountered during Bayesian data analysis, under the guise of posterior
distributions of a model's parameters. The reader wishing to use the
MCMC capabilities of <EM>MCSim</EM> is referred to the published literature (for
example, Bernardo and Smith, 1994; Gelman, 1992; Gelman et al., 1995;
Gelman et al., 1996; Gilks et al., 1996; Smith, 1991; Smith and Roberts,
1993) (see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>).</P><P>

MCMC simulation chains (which in <EM>MCSim</EM> start from a sample from the
specified prior) need to reach "<EM>equilibrium</EM>". Checking that
equilibrium is obtained is best achieved, in our opinion, by running
multiple independent chains (<I>cf.</I> Gelman and Rubin, 1992, and other
relevant statistical literature). <EM>MCSim</EM> does not deal (yet) with
convergence issues.</P><P>

The Bayesian analysis of data with <EM>MCSim</EM> requires you to setup:</P><P>

<UL>
<LI>
a <I>structural model</I> (see section <A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A>),<LI>
a <I>statistical model</I> (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>),<LI>
<I>prior distributions</I> for the model parameters you want to sample and
"<EM>data likelihoods</EM>" (defining the probability of some observed
realizations of the modeled process, conditionally to the model)
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>).</UL>
<P>

Setting-up a statistical model requires <CODE>Level</CODE> sections and
<CODE>Data()</CODE> specifications. Assigning priors and likelihoods is achieved
through the <CODE>Distrib()</CODE> statements (or its equivalents
<CODE>Density()</CODE> and <CODE>Likelihood()</CODE>). Please refer to the
corresponding sections of this manual, if you are not familiar with
them. The <CODE>MCMC()</CODE> statement, gives general directives for MCMC
simulations and has the following syntax:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>MCMC("&#60;OutputFilename&#62;", "<RestartFilename>", "&#60;DataFilename&#62;", 
     &#60;nRuns&#62;, &#60;simTypeFlag&#62;, &#60;printFrequency&#62;, &#60;itersToPrint&#62;, 
     &#60;RandomSeed&#62;);
</pre></td></tr></table></P><P>

The character strings <VAR>&#60;OutputFilename&#62;</VAR>, <VAR>&#60;RestartFilename&#62;</VAR>, and
<VAR>&#60;DataFilename&#62;</VAR>, enclosed in double quotes, should be valid file
names for your operating system. If a null-string "" is given instead of
the output file name, the default name `<TT>MCMC.default.out</TT>' will be
used.</P><P>

If a restart file name is given, the first simulations will be read from
that file (which must be a text file). This allows you to continue a
simulated Markov chain where you left it, since an MCMC output file can
be used as a restart file with no change. Note that the first line of
the file (which typically contains column headers) is skipped. Also, the
number of lines in the file must be less than or equal to
<VAR>&#60;nRuns&#62;</VAR>. The first column of the file should be integers, and the
following columns (tab- or space-separated) should give the various
parameters, in the same order as specified in the list of
<CODE>Distrib()</CODE> specifications in the input file.</P><P>

If a data file name is given, the observed (data) values for the
simulated outputs will be read from that file (in ASCII format);
otherwise, <CODE>Data()</CODE> specifications (see section <A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A>)
should be provided. We recommend that you use <CODE>Data()</CODE>
specifications rather that the data file, which is much more error
prone. The first line of the data file is skipped and can be used for
comments. The total number of data points should equal the total number
of outputs requested. The data values should be given on the second and
following lines, separated by white spaces or tabs. A data value of "-1"
will be treated as "missing data" and ignored in likelihood
calculations. The convention "-1" can be changed by changing
INPUT_MISSING_VALUE in the header file `<TT>mc.h</TT>' and recompiling the
entire library.</P><P>

The integer <VAR>&#60;nRuns&#62;</VAR> gives the total number of runs to be performed,
including the runs eventually read in the restart file. The next field,
<VAR>&#60;simTypeFlag&#62;</VAR> should be either 0, 1, or 2. It should be set at zero
to start a chain of MCMC simulations. In that case, parameters are
updated by Metropolis steps, one at a time. If the value of
<VAR>&#60;simTypeFlag&#62;</VAR> is set to 1 or 2, a restart file must also be
specified. In the case of 1, the output file will contain codes for the
level sequence, simulation numbers, printing times, data values and the
corresponding model predictions, computed using the last parameter
vector of the restart file. This is useful to quickly check the model
fit to the data. If <VAR>&#60;simTypeFlag&#62;</VAR> is equal to 2, the entire restart
file is used to compute the parameters' covariance matrix. All
parameters are then updated at once using a multivariate normal kernel
as proposal distribution of the Metropolis steps. This may result in
large improvement in speed. However, we recommend that this option be
used only when convergence is approximately obtained (therefore, you
should run MCMC simulations with <VAR>&#60;simTypeFlag&#62;</VAR> set to 0 first, up to
approximate convergence, and then restart the chain with the flag at
2).</P><P>

The integer <VAR>&#60;printFrequency&#62;</VAR> should be set to 1 if you want an
output at each iteration, to 2 if you want an output at every other
iteration etc. The parameter <VAR>&#60;itersToPrint&#62;</VAR> is the number of final
iterations for which output is required (<I>e.g.</I>, 1000 will request
output for the last 1000 iterations; to print all iterations just set
this parameter to the value of <VAR>&#60;nRuns&#62;</VAR>). Note that if no restart
file is used, the first iteration is always printed, regardless of the
value of <VAR>&#60;itersToPrint&#62;</VAR>. Finally, the seed <VAR>&#60;RandomSeed&#62;</VAR> of the
pseudo-random number generator can be any positive real number. Seeds
between 1.0 and 2147483646.0 are used as is, others are rescaled
silently within those bounds.</P><P>

Finally, the format of the output file of MCMC simulations is quite
similar to that of straight Monte Carlo simulations and will discussed
in a later section (see section <A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A>).</P><P>

<A NAME="SetPoints() specification"></A>
<HR SIZE="6">
<A NAME="SEC38"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC37"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC39"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>SetPoints()</CODE> specification </H4>
<!--docid::SEC38::-->
<P>

To impose a series of set points (<I>i.e.</I>, already tabulated values for
the parameters), the global section can include a <CODE>SetPoints()</CODE>
specification. It allows you to perform additional simulations with
previously Monte Carlo sampled parameter values, eventually filtered.
You can also generate parameters values in a systematic fashion, over a
grid for example, with another program, and use them as input to
<EM>MCSim</EM>. Importance sampling, Latin hypercube sampling, grid
sampling, can be accommodated in this way.</P><P>

This command specifies an output filename, the name of a text file
containing the chosen parameter values, the number of simulations to
perform and a list of model parameters to read in. It has the following
syntax:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>SetPoints("&#60;OutputFilename&#62;", "<SetPointsFilename>", &#60;nRuns&#62;, 
          &#60;identifier&#62;, &#60;identifier&#62;, ...);
</pre></td></tr></table></P><P>

If a null string is given for the output filename, the set points output
will be written to the same default output file used for Monte Carlo
analyses, `<TT>simmc.out</TT>'.</P><P>

The <VAR>SetPointsFilename</VAR> is required and must refer to an existing file
containing the parameter values to use. The first line of the set points
file is skipped and can contain column headers, for example. Each of the
other lines should contain an integer (<I>e.g.</I>, the line number)
followed by values of the various parameters in the order indicated in
the <CODE>SetPoints()</CODE> specification. If extra fields are at the end of
each line they are skipped. The first integer field is needed but not
used (this allows you to directly use Monte Carlo output files for
additional <CODE>SetPoints</CODE> simulations).</P><P>

The variable <VAR>&#60;nRuns&#62;</VAR> should be less or equal to the number of
lines (minus one) in the set points file. If a zero is given, all lines
of the file are read. Finally, a comma-separated list of the parameters
to be read in the <VAR>SetPointsFilename</VAR> is given. The format of the
output file of set points simulations is discussed below
(see section <A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A>).</P><P>

Following the <CODE>SetPoints()</CODE> specification, <CODE>Distrib()</CODE>
statements can be given for parameters not already in the list
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>). These parameters will be sampled
accordingly before to performing each simulation. The shape parameters
of the distribution specifications can reference other parameters,
including those of the list.</P><P>

<A NAME="OptimalDesign() specification"></A>
<HR SIZE="6">
<A NAME="SEC39"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC38"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC40"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>OptimalDesign()</CODE> specification </H4>
<!--docid::SEC39::-->
<P>

The "<EM>OptimalDesign</EM>" procedure optimizes the number and location of
observation times for experimental conditions you specify, in order to
minimize the variance of a parameter or an output you designate. It
requires a structural model (see section <A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A>), a
statistical model in the form of a <CODE>likelihood()</CODE> function
(see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>), and a random set of parameter
vectors sampled from a prior distribution (using Monte Carlo or MCMC
simulations) (for example and details, see Bois et al., 1999)
(see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>). The statistical model used should be
quite simple and cannot not use <CODE>Level</CODE> sections (and hence cannot
be hierarchical).</P><P>

The <EM>OptimalDesign</EM> command has the following syntax:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>OptimalDesign("&#60;OutputFilename&#62;", "<ParameterSampleFilename>", 
              &#60;nSamples&#62;, &#60;RandomSeed&#62;, &#60;Style&#62;,
              &#60;identifier&#62;, &#60;identifier&#62;, ...);
</pre></td></tr></table></P><P>

The character strings <VAR>&#60;OutputFilename&#62;</VAR>, and
<VAR>&#60;ParameterSampleFilename&#62;</VAR>, enclosed in double quotes, should be
valid file names for your operating system. If a null-string "" is given
instead of the output file name, the default name
`<TT>simopt.default.out</TT>' will be used.</P><P>

A parameter sample file name must be given (that file must be a text
file). The first line of the file (which typically contains column
headers) is skipped. The number of lines in the file must be less than
or equal to <VAR>&#60;nSamples&#62;</VAR>. The first column of the file should be
integers (typically row numbers), and the following columns (tab- or
space-separated) should be values of the various parameters in the order
indicated in the list at the end of the <CODE>OptimalDesign()</CODE>
specification. If extra fields are at the end of each line they are
skipped. The first integer field is needed but not used (this allows you
to directly use Monte Carlo output files for <CODE>OptimalDesign</CODE>
simulations).</P><P>

The integer <VAR>&#60;nSamples&#62;</VAR> indicates the number of lines to read from
the <VAR>&#60;ParameterSampleFilename&#62;</VAR> file. The seed <VAR>&#60;RandomSeed&#62;</VAR> of
the pseudo-random number generator can be any positive real
number. Seeds between 1.0 and 2147483646.0 are used as is, others are
rescaled silently within those bounds. The directive <VAR>Style</VAR> should
be either the keyword <CODE>Forward</CODE> or the keyword
<CODE>Backward</CODE>. Forward optimization will start from no new data and
will add, sequentially, optimal observation times. Backward optimization
starts with the full set of observation times you propose and delete the
least informative ones, sequentially. We recommand that you try both
options. Finally, a comma-separated list of the parameters to be read in
the <VAR>ParameterSamplFilename</VAR> should be given.</P><P>

The input file must then contain two sets of <CODE>Simulation</CODE>
definitions. You should look at the sample optimal design files provided
in `<TT>mcsim/samples</TT>'.</P><P>

The first set specifies all experimental conditions and the set of
observation times to optimize, for one or several output variables given
in <CODE>Print</CODE> statements. The output times you specify for each output
variable define an array of observation time values that the
optimization algorithm will rank by order of the estimated variance
reduction they permit for variables or parameters you will specify in
the second set of <CODE>Simulation</CODE> definitions. Data will be simulated
for each of the required output. There must be one Data statement per
output specified (the data values are arbitrary). An error model must be
specified for those data, using a <CODE>Likelihood</CODE> statement
(see section <A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>).</P><P>

The second set of <CODE>Simulation</CODE> specifies optimization target
parameters or outputs. The algorithm will select time-points (in the
first section's <CODE>Simulation</CODE> specifications) that minimize the
estimation variance of those parameters or outputs. When a parameter is
targeted no inputs are needed. If you optimize for an output variable
variance (<I>i.e.</I>, for the variance of a model prediction), the
experimental conditions can be very different from those of the
experiment whose conditions you optimize. The link is afforded solely by
the parameters (in the first set you are trying to determine the
conditions that will optimally identify the parameter values
conditioning the predictions -- or trivially, the parameters -- of the
second set)
</P><P>

The format of the output file of design optimization simulations is
quite specific. The first column is an iteration number. At each
iteration one observation point is added (<CODE>Forward</CODE> mode) or
removed (<CODE>Backward</CODE> mode). Each step is therefore conditioned by
the selection of an observation time-point made by the previous
step. The following columns give, for each observation time point you
specify, the average variance of the target outputs or parameters
achieved if this point is added (<CODE>Forward</CODE> mode) or removed
(<CODE>Backward</CODE> mode). Next the chosen time point at this step is given
(the one minimizing average variance), followed by the variance it leads
to (in expectation) and the corresponding standard deviation. The last
column "Utility" is zero, unless you uncomment the function
<CODE>Compute_utility</CODE> and modify its code in `<TT>optdesign.c</TT>' to
compute a utility of your own.</P><P>

<A NAME="Distrib() specification"></A>
<HR SIZE="6">
<A NAME="SEC40"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC39"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC41"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Distrib()</CODE> specification </H4>
<!--docid::SEC40::-->
<P>

The specification of distributions for simple Monte Carlo simulations
is quite straighforward. MCMC simulations require the definition of a
full statistical model and the use of distributions is somewhat more
complex in that case, but the use of <CODE>Distrib()</CODE> is basically the
same.</P><P>

<STRONG>In the context of <CODE>MonteCarlo()</CODE> or <CODE>SetPoints()</CODE>
simulations</STRONG> (see section <A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A>, and <A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A>), one (and only one) <CODE>Distrib()</CODE> specification must
be included for each model parameter to randomly sample. State, input or
output variables cannot be randomly sampled by <CODE>Distrib()</CODE> in this
context. A simulation specification file can include any number of
<CODE>Distrib()</CODE> commands at the global level.</P><P>

<CODE>Distrib()</CODE> specifies the name of the parameter to sample, and its
sampling distribution. Its syntax is:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Distrib(&#60;identifier&#62;, &#60;distribution-name&#62;, [&#60;shape parameters&#62;]);
</pre></td></tr></table></P><P>

The <VAR>&#60;identifier&#62;</VAR> gives the name of the parameter to sample. The
<VAR>&#60;distribution-name&#62;</VAR> and the corresponding <VAR>&#60;shape parameters&#62;</VAR>
indicate the sampling distribution to use (Bernardo and Smith, 1994;
Gelman et al., 1995) (see section <A HREF="mcsim.html#SEC54">Bibliographic References</A>). They are
specified as follow:</P><P>

<UL>

<LI>
<A NAME="IDX146"></A>
<A NAME="IDX147"></A>
<CODE>Beta</CODE>, takes at least two strictly positive real shape parameters:
<VAR>A</VAR> and <VAR>B</VAR>. By default the Beta distribution is defined over
the interval [0;1]. If a range is given for the beta distribution, the
[0;1] interval is mapped onto the specified range.<P>

<LI>
<A NAME="IDX148"></A>
<A NAME="IDX149"></A>
<CODE>Binomial</CODE>, needs two strictly positive numbers: the probability
<VAR>p</VAR> (a real in the interval [0;1]), and the sample size <VAR>N</VAR>, an
integer. If <VAR>N</VAR> is not given as an integer it will be rounded down
during the computations.<P>

<LI>
<A NAME="IDX150"></A>
<A NAME="IDX151"></A>
<A NAME="IDX152"></A>
<A NAME="IDX153"></A>
<CODE>Cauchy</CODE>, takes one strictly positive real number as parameter:
its scale <VAR>s</VAR>.<P>

<LI>
<A NAME="IDX154"></A>
<A NAME="IDX155"></A>
<A NAME="IDX156"></A>
<A NAME="IDX157"></A>
<CODE>Chi2</CODE>, takes one strictly positive real number as parameter:
<VAR>n</VAR>. This distribution is the same as Gamma(<VAR>n</VAR>/2, 1/2).<P>

<LI>
<A NAME="IDX158"></A>
<A NAME="IDX159"></A>
<CODE>Exponential</CODE>, uses one strictly positive real number: the
inverse-scale <VAR>b</VAR>. <P>

<LI>
<A NAME="IDX160"></A>
<A NAME="IDX161"></A>
<CODE>Gamma</CODE>, uses two strictly positive real parameter: the shape and
the inverse scale.<P>

<LI>
<A NAME="IDX162"></A>
<A NAME="IDX163"></A>
<CODE>HalfCauchy</CODE>, takes one strictly positive real number as
parameter: the scale <VAR>s</VAR>. The mode is at zero, on the lower
boundary. The random variates returned are strictly positive.<P>

<LI>
<A NAME="IDX164"></A>
<A NAME="IDX165"></A>
<CODE>HalfNormal</CODE>, takes one reals number as parameter: the standard
deviation, strictly positive.  The mode is at zero, on the lower
boundary. The random variates returned are strictly positive.<P>

<LI>
<A NAME="IDX166"></A>
<A NAME="IDX167"></A>
<A NAME="IDX168"></A>
<A NAME="IDX169"></A>
<CODE>InvGamma</CODE> (inverse gamma distribution), needs two strictly positive
real parameters: the shape and the scale.<P>

<LI>
<A NAME="IDX170"></A>
<A NAME="IDX171"></A>
<CODE>LogNormal</CODE>, takes two reals numbers as parameters: the geometric
mean (exponential of the mean in log-space) and the geometric standard
deviation (exponential, strictly superior to 1, of the standard deviation
in log-space).<P>

<LI>
<A NAME="IDX172"></A>
<A NAME="IDX173"></A>
<CODE>LogNormal_v</CODE>, is the lognormal distribution with the variance (in
log space!) instead of the standard deviation as second parameter. You
can use it to specify a hierarchical model with a conjugate prior on the
variance (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).<P>

<LI>
<A NAME="IDX174"></A>
<A NAME="IDX175"></A>
<CODE>LogUniform</CODE>, with two shape parameters: the minimum and the maximum
of the sampling range (real numbers) in natural space.<P>

<LI>
<A NAME="IDX176"></A>
<A NAME="IDX177"></A>
<CODE>Normal</CODE>, takes two reals numbers as parameters: the mean and the
standard deviation, the latter being strictly positive.<P>

<LI>
<A NAME="IDX178"></A>
<A NAME="IDX179"></A>
<CODE>Normal_v</CODE>, is also the normal distribution with the variance
instead of the standard deviation as second parameter. You can use it to
specify a hierarchical model with a conjugate prior on the variance
(see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).<P>

<LI>
<A NAME="IDX180"></A>
<A NAME="IDX181"></A>
<A NAME="IDX182"></A>
<A NAME="IDX183"></A>
<CODE>Piecewise</CODE>, uses four reals as parameters: the <VAR>minimum</VAR>,
<VAR>A</VAR>, <VAR>B</VAR>, and the <VAR>maximum</VAR>. The distribution has the form
of a truncated triangle, with a plateau between <VAR>A</VAR> and <VAR>B</VAR>. If
A = B,
the distribution is the triangular distribution.<P>

<LI>
<A NAME="IDX184"></A>
<A NAME="IDX185"></A>
<CODE>Poisson</CODE>, needs a strictly positive real: the rate <VAR>A</VAR>.<P>

<LI>
<A NAME="IDX186"></A>
<A NAME="IDX187"></A>
<CODE>StudentT</CODE>, requires three parameters: its number of degrees of
freedom (an integer), its mean, and its standard deviation.<P>

<LI>
<A NAME="IDX188"></A>
<A NAME="IDX189"></A>
<A NAME="IDX190"></A>
<A NAME="IDX191"></A>
<CODE>TruncInvGamma</CODE> (truncated inverse gamma distribution), 
needs four strictly positive
real parameters: the shape, the scale, the minimum and the maximum.<P>

<LI>
<A NAME="IDX192"></A>
<A NAME="IDX193"></A>
<A NAME="IDX194"></A>
<A NAME="IDX195"></A>
<CODE>TruncLogNormal</CODE> (truncated lognormal distribution), uses four real
numbers: the geometric mean and geometric standard deviation (strictly
superior to 1), the minimum and the maximum in natural space. For
example:<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Distrib(Var, TruncLogNormal, 1, 2.718, 0.01, 10)
</pre></td></tr></table></P><P>

samples `<SAMP>Var</SAMP>' such that
log(`<SAMP>Var</SAMP>') is a standardized normal variate of mean log(1)
and standard deviation log(2.718) -
while `<SAMP>Var</SAMP>' is truncated to fall between 0.01 to 10.</P><P>

<LI>
<A NAME="IDX196"></A>
<A NAME="IDX197"></A>
<CODE>TruncLogNormal_v</CODE>, is like the truncated lognormal, except that it
takes the variance (in log space!) instead of the standard deviation as
second parameter. You can use it to specify a hierarchical model with a
conjugate prior on the variance (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).<P>

<LI>
<A NAME="IDX198"></A>
<A NAME="IDX199"></A>
<A NAME="IDX200"></A>
<A NAME="IDX201"></A>
<CODE>TruncNormal</CODE> (truncated normal distribution), takes four real
parameters: the mean, the standard deviation (strictly positive), the
minimum and the maximum.<P>

<LI>
<A NAME="IDX202"></A>
<A NAME="IDX203"></A>
<CODE>TruncNormal_v</CODE>, is like the truncated normal distribution with the
variance instead of the standard deviation as second parameter.<P>

<LI>
<A NAME="IDX204"></A>
<A NAME="IDX205"></A>
<CODE>Uniform</CODE>, with two shape parameters: the minimum and the maximum of
the sampling range (real numbers).<P>

</UL>
<P>

The shape parameters of the above distributions can symbolically
reference other model parameters, even if distributions for these have
already been defined. For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Distrib(A, Normal, 0, 1);
Distrib(B, Normal, A, 2);
</pre></td></tr></table></P><P>

<STRONG>In the context of MCMC sampling</STRONG>, <EM>MCSim</EM> provides extensions of
the above <CODE>Distrib()</CODE> specification syntax.<A NAME="IDX206"></A>
<A NAME="IDX207"></A>
<A NAME="IDX208"></A>
<A NAME="IDX209"></A>
<A NAME="IDX210"></A>
<A NAME="IDX211"></A>
<A NAME="IDX212"></A>
<A NAME="IDX213"></A>
</P><P>

First, when <CODE>Distrib()</CODE> is used to specify the distribution of a
model parameter, that parameter can also appear as a shape
parameter, if a distribution has already been specified for the
parameter at an upper <CODE>Level</CODE> of the file. For example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Level {                      # upper level
  Distrib(A, Normal,   0, 1);
  Distrib(B, InvGamma, 2, 2);
  Level {                    # sub-level
    Distrib(A, Normal_v, A, B);
    ...
  }                          # end sub-level
}                            # end upper level
</pre></td></tr></table></P><P>

In that case, the parameter <VAR>A</VAR>, used for shape specification (as
the mean of a Normal distribution) in the sub-level, refers to the
"<EM>parent</EM>" <VAR>A</VAR> parameter, for which a standard Normal
distribution is defined at the upper <CODE>Level</CODE>. The <EM>sampled</EM>
values of the parent parameters <VAR>A</VAR> and <VAR>B</VAR> will be used as mean
and variance for their "<EM>child</EM>" parameter, <VAR>A</VAR>, when it will be
its turn to be randomly sampled. This forms the basis of the
specification of multilevel (hierarchical) models (see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).</P><P>

Next, in MCMC simulations, you usually assign a probability distribution
(or a likelihood) to the data you are trying to analyze. Typically, your
model's state and/or output variables will attempt to predict some
aspect of the observed data distributions (mean, variance,
<I>etc.</I>). <EM>MCSim</EM> gives you the possibility to specify a distribution for
your data, using model parameters, input, state, or output model
variables, or even other data, to define the distribution shape. This
is achieved through the use of the <CODE>Data()</CODE> and <CODE>Prediction()</CODE>
"<EM>qualifiers</EM>".</P><P>

<CODE>Data()</CODE> can be used at the first position of a <CODE>Distrib()</CODE>
statement, or as a distribution shape parameter. It uses the following
syntax:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Data(&#60;identifier&#62;) 
</pre></td></tr></table></P><P>

where <VAR>&#60;identifier&#62;</VAR> corresponds to a valid input, state or output
model variable for which data are available. Model parameters cannot be
used (but you can assign a simple parameter value to an output variable
in your model definition file and use that output here). The actual data
values need to be given later in the simulation input file through
<CODE>Data()</CODE> specifications (which, in addition to a variable
identifier, give a list of numerical data values, see <A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A>) or in a separate datafile (see section <A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>).</P><P>

Working hand in hand with <CODE>Data()</CODE>, and using the same syntax, the
<CODE>Prediction()</CODE> qualifier can be used to designate actual model
inputs, states and outputs for any shape parameter of a specified
distribution (therefore <CODE>Prediction()</CODE> must appear after the
distribution name). The actual predicted values, matching exactly the
corresponding data, need to be given later in the simulation input file
through <CODE>Print()</CODE> or <CODE>PrintStep()</CODE> specifications
[see section <A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A> and <A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A>).</P><P>

Here are some example of use of <CODE>Data()</CODE> and <CODE>Prediction()</CODE> in
the extended syntax of a <CODE>Distrib()</CODE> specification:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Distrib (Data(y), Normal,   Prediction(y), 0.01);
...
Data (y, 0.1, 2,  5,  3,  9.2);
Print(y, 10,  20, 40, 60, 100);

Distrib (Data(y), Normal,   Prediction(y), Prediction(sigma));
...
Data (y, 1.01, 1.20, 0.97, 0.80, 1.02);
PrintStep(y,     10, 50, 10);
PrintStep(sigma, 10, 50, 10);

Distrib (Data(R), Binomial, Prediction(P), Data(N));
...
Data (R, 0,  2,  5, 5,  8, 9, 10, 10);
Data (N, 10, 10, 9, 10, 9, 9, 11, 10);
Print(P, 10, 20, 30,40, 50,60,70, 80);

</pre></td></tr></table></P><P>

(these could not appear all as such in an input file, they would need to
be embedded in <CODE>Level</CODE> and <CODE>Simulation</CODE> sections.)</P><P>

Last, for more readable input files, two keywords, <CODE>Density()</CODE> and
<CODE>Likelihood()</CODE>, can be used instead of <CODE>Distrib()</CODE>. They are
equivalent to <CODE>Distrib()</CODE> and have the same syntax.</P><P>

<A NAME="SimType() specification"></A>
<HR SIZE="6">
<A NAME="SEC41"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC40"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC32"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>SimType()</CODE> specification </H4>
<!--docid::SEC41::-->
<P>

This specification is now obsolete and should not be used. It is left
for compatibility with old input files. It specifies the type of analysis
to perform. Syntax:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>SimType(&#60;keyword&#62;);
</pre></td></tr></table></P><P>

The following keywords can be used: <CODE>DefaultSim</CODE> (the list of
specified simulations is simulated), <CODE>MonteCarlo</CODE>, <CODE>MCMC</CODE>
(previously <CODE>Gibbs</CODE>), <CODE>SetPoints</CODE>. If <CODE>MonteCarlo</CODE>,
<CODE>MCMC</CODE>, or <CODE>SetPoints</CODE> analyses are requested, additional
specifications are needed (see below).</P><P>

<A NAME="Specifying basic conditions to simulate"></A>
<HR SIZE="6">
<A NAME="SEC42"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC41"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC43"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 6.2.4 Specifying basic conditions to simulate </H3>
<!--docid::SEC42::-->
<P>

Any simulation file must define at least one <CODE>Simulation</CODE>
section. <CODE>Simulation</CODE> sections include particular specifications,
which are presented in the following.</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC44"><CODE>StartTime()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Simulation sections"></A>
<HR SIZE="6">
<A NAME="SEC43"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC44"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Simulation</CODE> sections </H4>
<!--docid::SEC43::-->
<P>

After global specifications, if any, <CODE>Simulation</CODE> sections must be
included in the input file. Expectedly, these sections start with the
keyword <CODE>Simulation</CODE> and are enclosed in curly braces.</P><P>

A <CODE>Simulation</CODE> section can make assignments to any state variable,
input variable or parameter defined in the global section of the model
description file. Output variables cannot receive assignments in
simulation input files.</P><P>

State variables and parameters can only take constant values
(see section <A HREF="mcsim.html#SEC31">6.2.1 General input file syntax</A>). For state variables, this sets the
initial value only. So, for example, in a <CODE>Simulation</CODE> section the
parameter <CODE>Speed</CODE>, if properly defined, can be set using:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Speed = 83.2;
</pre></td></tr></table></P><P>

This overrides any previously assigned values, even if randomly sampled,
for the specified parameter.</P><P>

Inputs can be redefined with input functions (see section <A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A>) or constant values. Input functions can reference other
variables (eventually randomly sampled), as in:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Q_in = PerExp(InMag, 60, 0, RateConst);
</pre></td></tr></table></P><P>

The maximum number of <CODE>Simulation</CODE> sections allowed in an input
file is 200. This can be changed by changing MAX_INSTANCES and
MAX_EXPERIMENTS in the header file `<TT>sim.h</TT>' and recompiling the
program (this requires re-installation).</P><P>

Within a <CODE>Simulation</CODE> section, several additional specifications
can be used:<UL>
<LI>
<CODE>StartTime()</CODE>,
<LI>
<CODE>Print()</CODE>,
<LI>
<CODE>PrintStep()</CODE>,
<LI>
<CODE>Data()</CODE>.
</UL>
<P>

The <CODE>Data()</CODE> specification is used only when a statistical model is
set up and will be covered in the corresponding section of this manual
(<A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>).
</P><P>

<A NAME="StartTime() specification"></A>
<HR SIZE="6">
<A NAME="SEC44"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC43"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC45"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>StartTime()</CODE> specification </H4>
<!--docid::SEC44::-->
<P>

The origin of time for a simulation, if it needs to be defined, can be
set with the <CODE>StartTime()</CODE> specification:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>StartTime(&#60;initial-time&#62;);
</pre></td></tr></table></P><P>

If this specification is not given, a value of zero is used by default.
The final time is automatically computed to match the largest output
time specified in the <CODE>Print()</CODE> or <CODE>PrintStep()</CODE>
statements.</P><P>

<A NAME="Print() specification"></A>
<HR SIZE="6">
<A NAME="SEC45"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC44"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC46"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Print()</CODE> specification </H4>
<!--docid::SEC45::-->
<P>

The value of any model variable or parameter can be requested for output
with <CODE>Print()</CODE> specifications. Their arguments are a
comma-separated list of variable names (at least one and up to 10), and
a comma-separated list of increasing times at which to output their
values:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Print(&#60;identifier1&#62;, &#60;identifier2&#62;, ..., &#60;time1&#62;, &#60;time2&#62;, ...);
</pre></td></tr></table></P><P>

The same output times are used for all the variables specified. The size
of the time list is only limited by the available memory at run
time. The limit of 10 variables names can be increased by changing
MAX_PRINT_VARS in the header file `<TT>sim.h</TT>' and re-installing the
whole software. The number of <CODE>Print()</CODE> statements you can used in
a given <CODE>Simulation</CODE> section is only limited by the available
memory at run time. The same variable or parameter can appear in more
than one <CODE>PrintStep()</CODE> in a given <CODE>Simulation</CODE> section.</P><P>

<A NAME="PrintStep() specification"></A>
<HR SIZE="6">
<A NAME="SEC46"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC45"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC33"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>PrintStep()</CODE> specification </H4>
<!--docid::SEC46::-->
<P>

The value of any model variable or parameter can be also output with
<CODE>PrintStep()</CODE> specifications. They allow dense printing, suitable
for smooth plots, for example. The arguments are the name of only one
variable, the first output time, the last one, and a time
increment:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PrintStep(&#60;identifier&#62;, &#60;start-time&#62;, &#60;end-time&#62;, &#60;time-step&#62;);
</pre></td></tr></table></P><P>

The final time has to be superior to the initial time and the time step
has to be less than the time span between end and start. If the time
step is not an exact divider of the time span the last printing step is
shorter and the last output time is still the end-time specified. The
number of outputs produced is only limited by the memory available at
run time. You can use several <CODE>PrintStep()</CODE>, and the same variable
or parameter can appear in more than one <CODE>PrintStep()</CODE>, in a given
<CODE>Simulation</CODE> section.</P><P>

<A NAME="Setting-up statistical models"></A>
<HR SIZE="6">
<A NAME="SEC47"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC46"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC48"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 6.2.5 Setting-up statistical models </H3>
<!--docid::SEC47::-->
<P>

With <EM>MCSim</EM>, you must define a statistical model to use the <CODE>MCMC()</CODE>
specification. <CODE>MCMC</CODE> simulations will give you a sample from the
joint posterior distribution of the parameters that you designate as
randomly sampled through <CODE>Distrib()</CODE> specifications. You do not
need to specify explicitly that joint posterior distribution (in fact,
in most case, this is impossible). The posterior distribution is
implicitly defined by a statistical model, that is simply a set of
conditional relationship between the parameters and some data.</P><P>

<EM>MCSim</EM> handles multilevel (hierarchical) random effects and mixed effects
statistical models in a Bayesian framework. These models need to be
defined in the simulation specification file, rather than in the
structural model definition file. Yet, due to compilation constraints,
if you need special parameters for your statistical model (<I>e.g.</I>,
variances) you have to declare them in the structural model file, even
if they are not used by the structural model itself.
</P><P>

So, how do we go about specifying a statistical model with <EM>MCSim</EM>? Take
for example the following simple linear regression model:</P><P>

  <VAR>y_i</VAR>  = N(<VAR>Mu_i</VAR>, <VAR>Sigma</VAR>^2),
  <VAR>Mu_i</VAR> = <VAR>Alpha</VAR> + <VAR>Beta</VAR> * (<VAR>x_i</VAR> - <VAR>x_bar</VAR>).
</P><P>

where the observed (<VAR>x</VAR>,<VAR>y</VAR>) pairs are (1,1), (2,3), (3,3),
(4,3) and (5,5). Assume that the parameters <VAR>Alpha</VAR> and <VAR>Beta</VAR>
are given N(0,10000) priors, and that 1/<VAR>Sigma</VAR>^2 is given a
Gamma(1e-2,1e-2) prior.  <VAR>x_bar</VAR> is the average of the above values
for <VAR>x</VAR>.  We want the posterior distributions of <VAR>Alpha</VAR>,
<VAR>Beta</VAR>, and <VAR>Sigma^2</VAR>.</P><P>

The first thing to do is to define a structural (or link) model to
compute <VAR>y</VAR> as a function of <VAR>x</VAR>. Here is such a model (quite
similar to the one distributed with <EM>MCSim</EM> source code
(see section <A HREF="mcsim.html#SEC57">B.1 `<TT>linear.model</TT>'</A>):</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre># ---------------------------------------------
# Model definition file for a linear model
# ---------------------------------------------
Outputs = {y};

# Structural model parameters
Alpha = 0;
Beta = 0;
x_bar = 0;

# Statistical parameter
Sigma2 = 1;

CalcOutputs { y = Alpha + Beta * (t - x_bar); }
# ---------------------------------------------
</pre></td></tr></table></P><P>

The parameters' default values are arbitrary, and could be
anything reasonable. They will be changed or sampled through the input
file. Note that<VAR>Sigma2</VAR>is not used in the model equations, but still
needs to be defined here in order to be part of the statistical
model. On the other hand, 
<VAR>Mu</VAR> is not defined, since we do not really need it.Finally <VAR>x</VAR> is replaced by the time, <CODE>t</CODE>, for convenience.
An alternative would be to define an input `<SAMP>x</SAMP>' and use it instead of 
<CODE>t</CODE>.</P><P>

We now need to write an input file specifying the distribution of
<VAR>y</VAR> (<I>i.e.</I>, the likelihood), and the prior distributions of the
various parameters. Technically, <EM>MCSim</EM> uses Metropolis sampling and you
do not need to worry about issues of conjugacy or log-concavity of your
prior or posterior distributions. Here is what a simulation file with a
statistical model looks like:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre># ---------------------------------------------------------------
# Simulation input file for a linear regression
# ---------------------------------------------------------------
MCMC ("linear.MCMC.out", "", "", 50000, 0, 5, 40000, 63453.1961);
Level {
  Distrib(Alpha,  Normal_v, 0, 10000);
  Distrib(Beta,   Normal_v, 0, 10000);
  Distrib(Sigma2, InvGamma, 0.01, 0.01);
  Likelihood(Data(y), Normal_v, Prediction(y), Sigma2);
  Simulation {
    x_bar = 3.0;
    PrintStep (y, 1, 5, 1);
    Data (y, 1, 3, 3, 3, 5);
  }
} # end Level
End.
# ---------------------------------------------------------------

</pre></td></tr></table></P><P>

The file begins with <CODE>MCMC()</CODE> (see section <A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>). The
keyword <CODE>Level</CODE> comes next.  <CODE>Level</CODE> is used to specify
hierarchical dependences between model parameters. There should be at
least one <CODE>Level</CODE> in every MCMC input file, even for a
non-hierarchical model like the one above. See below for further
discussion of the <CODE>Level</CODE> keyword. You can also look at the MCMC
input files provided as examples with <EM>MCSim</EM> source code.  The
<CODE>Distrib()</CODE> statements define the parameter priors.
<CODE>Normal_v</CODE> specifications are used since we use variances instead
of standard deviations. The inverse-Gamma distribution is used for the
variance component, since the precision is supposed to be
Gamma-distributed. The likelihood is the distribution of the data,
given the model: it is specified by a <CODE>Likelihood()</CODE> specification,
valid for every <VAR>y</VAR> data point. Again, note that the <VAR>Mu</VAR>variable is not used. Instead, the <CODE>Prediction(y)</CODE> specification
designates the linear model output. The distributions and likelihoods
specified are in effect for every sub-level or every <CODE>Simulation</CODE>
section included in the current <CODE>Level</CODE>.</P><P>

The "simulations" to perform, and the corresponding data values, are
specified by a <CODE>Simulation</CODE> section. Only one <CODE>Simulation</CODE>
section is needed here, but several could be specified. In this section,
the value of
<VAR>x_bar</VAR>is provided. The different values of <VAR>x</VAR> (time in our formulation of
the model) can be specified via <CODE>PrintStep()</CODE> (see section <A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A>), since they are equally spaced. More generally,
<CODE>Print()</CODE> can also be used (see section <A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A>). The
data values are given in a <CODE>Data()</CODE> statement (see below).</P><P>

The following paragraphs deal with <CODE>Level</CODE> sections and <CODE>Data()</CODE>
specifications.</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC48"><CODE>Level</CODE> sections</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Level sections"></A>
<HR SIZE="6">
<A NAME="SEC48"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC49"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Level</CODE> sections </H4>
<!--docid::SEC48::-->
<P>

Markov chain Monte Carlo simulations require the definition of a
statistical model structured with "<EM>levels</EM>". Think for example of
the definition of a prior distribution as a top level in a hierarchy,
with the data likelihood being at the lowest level. The hierarchy levels
are defined in <EM>MCSim</EM> with the help of <CODE>Level</CODE> sections. At
least one <CODE>Level</CODE> section must be defined in the simulation input
file (you cannot use <CODE>Level</CODE> in a structural model definition
file). A <CODE>Level</CODE> section starts with the correesponding keyword and
is enclosed in curly braces ('{}'). It can include any number of
sub-levels or <CODE>Simulations</CODE> sections. <CODE>Simulations</CODE> (where the
data are specified) form the lowest level of the hierarchy
(see section <A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>). In terms of structure, <CODE>Simulation</CODE>
sections behave like <CODE>Level</CODE> sections (in particular with regard to
"<EM>cloning</EM>" of random variables, see below) except that they cannot
include further levels. There must be one and only one top <CODE>Level</CODE>
and at most 10 nested sub-levels in the hierarchy. This limit of 10 can
be increased (up to 255) by changing MAX_LEVELS in the header file
`<TT>sim.h</TT>' and re-installing <EM>MCSim</EM>.</P><P>

A <CODE>Level</CODE> can specify or change the sampling distribution of any
model parameter properly defined in the global section of the structural
model description file. These distribution specifications apply to all
sub-levels of the <CODE>Level</CODE> where they take place. For
example:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>
MCMC("samp.out", "", "", 1, 1, 1, 1, 1); # we are in an MCMC context
Level { # this is the top level
  Distrib(A, Uniform, 0, 1);
  Likelihood(Data(y), Normal, Prediction(y), 1);
  Level { # sub-level 1
    Distrib(A, Normal, A, 1);
    Simulation { ... } # simulation 1
    Simulation { ... } # simulation 2
  } # End sub-level 1
} # End top, end file

</pre></td></tr></table></P><P>

A <CODE>Level</CODE> can also make simple assignments to any model parameter
(see section <A HREF="mcsim.html#SEC31">6.2.1 General input file syntax</A>). So, for example, in an
simulation, the parameter <VAR>A</VAR> could be modified with:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>A = 2.0;
</pre></td></tr></table></P><P>

This overrides any previously assigned values for the specified
parameter, even if randomly sampled, and applies to the sub-levels of
the <CODE>Level</CODE> where it take place.</P><P>

An important concept to grasp here is that of parameter
"<EM>cloning</EM>". Cloning automatically creates, using templates, as many
new parameters as you need in your multilevel model. One of the
characteristic feature of multilevel models is the same parameters
appear at several levels. For example, in a random effect model, a
parameter (<I>e.g.</I>, size) will be assumed to be randomly distributed in
a population of individuals. If you have 100 individuals in your
database, your model will have to deal with 100 individual size
parameters and an average size. To spare you the tedium of defining the
same distribution for many parameters, <EM>MCSim</EM> creates an
appropriate number of parameters for your model on the basis of its
level structure. Assume that you have specified a distribution for a
parameter <VAR>A</VAR> at a given level (that we label <VAR>L1</VAR> for
clarity). <EM>MCSim</EM> will automatically create new parameters
("<EM>clones</EM>") with the same distribution as <VAR>A</VAR> to match the
number of immediate sub-levels in <VAR>L1</VAR>. For example, if there are
three sub-levels included in <VAR>L1</VAR>, <EM>MCSim</EM> creates two clones
to form a total of three instances of <VAR>A</VAR> (the original and its
two clones). This convention saves a lot writing and effort
in the long run.</P><P>

In the sample of code given above, the parameter <VAR>A</VAR>, defined at the
top level, will be simply moved to sub-level 1 (cloning is not necessary
since there is only on sub-level directly included in the top level).
Within sub-level 1, the normally-distributed <VAR>A</VAR> will be cloned once
in order to create another normal variate with the same
distribution. Each one of those two will be moved to a lower
<CODE>Simulation</CODE>, where they will be conditioned by the data of that
simulation only. A total of three variables of "type" <VAR>A</VAR> will be
sampled and will be printed in the output file (coded so that the
position in the hierarchy is apparent): the "parent" <VAR>A</VAR>(<VAR>1</VAR>), a
priori uniformly distributed, and two "dependents" <VAR>A</VAR>(<VAR>1.1</VAR>)
and <VAR>A</VAR>(<VAR>1.2</VAR>), <I>a priori</I> normally distributed around
<VAR>A</VAR>(<VAR>1</VAR>).</P><P>

<A NAME="Data() specification"></A>
<HR SIZE="6">
<A NAME="SEC49"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC48"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC42"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC47"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H4> <CODE>Data()</CODE> specification </H4>
<!--docid::SEC49::-->
<P>

Experimental observations of model variables, inputs, outputs, or
parameters, can be specified with the <CODE>Data()</CODE> command. Markov
chain Monte Carlo sampling requires that you specify <CODE>Data()</CODE>
statements (see section <A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>; see section <A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>). The data are then used internally to evaluate
the likelihood function for the model.  The arguments are the name of
the variable for which observations exist, and a comma-separated list
of data values:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>Data(&#60;identifier&#62;, &#60;value1&#62;, &#60;value2&#62;, ...);
</pre></td></tr></table></P><P>

This specification can only be used with a matching <CODE>Print()</CODE> or
<CODE>PrintStep()</CODE> for the same variable (see section <A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A>;
see section <A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A>). You must make sure that there are as
many data values in the <CODE>Data()</CODE> specification as output time
requested in the corresponding <CODE>Print()</CODE> or <CODE>PrintStep()</CODE>. A
data value of "-1" is treated as "missing data" and ignored in
likelihood calculations. The convention "-1" can be changed by changing
INPUT_MISSING_VALUE in the header file `<TT>mc.h</TT>' and
recompiling.</P><P>

<A NAME="Analyzing simulation output"></A>
<HR SIZE="6">
<A NAME="SEC50"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC49"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC51"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 6.3 Analyzing simulation output </H2>
<!--docid::SEC50::-->
<P>

The output from Monte Carlo or <CODE>SetPoints</CODE> simulations is a
tab-delimited text file with one row for each run (i.e., parameter set)
and one column for each parameter and output in the order specified.
Thus each line of the output file is in the following order:</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#60;# of run&#62; &#60;parameters&#62; &#60;outputs for Exp 1&#62; &#60;outputs for Exp2&#62; ...
</pre></td></tr></table></P><P>

The parameters are printed in the order they were sampled or set.
</P><P>

The first line gives the column headers. A variable called <VAR>name</VAR>
requested for output in an simulation <VAR>i</VAR> at a time <VAR>j</VAR> is
labeled <VAR>name_i.j</VAR>.</P><P>

The output of Markov chain Monte Carlo simulations is also a text file
with one row for each run. It displays a column of iteration labels, and
one column for each parameter sampled. The last three columns contain
respectively, the sum of the logarithms of each parameter's density
given its parents' values (`<SAMP>LnPrior</SAMP>'), the logarithm of the data
likelihood (`<SAMP>LnData</SAMP>'), and the sum of the previous two values
(`<SAMP>LnPosterior</SAMP>'). The first line gives the column headers. On this
line, parameters names are tagged with a code identifying their position
in the hierarchy defined by the Level sections. For example, the
second instance of a parameter called <VAR>name</VAR> placed at the fist
level of the hierarchy is labeled <VAR>name</VAR>(<VAR>2</VAR>); the first instance of
the same parameter placed at the second instance of the second level of
the hierarchy is labeled <VAR>name</VAR>(<VAR>2.1</VAR>), etc.</P><P>

The tab-delimited file can easily be imported into your favorite
spreadsheet, graphic or statistical package for further analysis.</P><P>

<A NAME="Error handling"></A>
<HR SIZE="6">
<A NAME="SEC51"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC30"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC50"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 6.4 Error handling </H2>
<!--docid::SEC51::-->
<P>

If integration fails for a <CODE>imulation</CODE> in <CODE>DefaultSim</CODE>
simulations no output is generated for that simulation, and the user is
warned by an error message on the screen. In <CODE>MonteCarlo</CODE> or
<CODE>SetPoints</CODE> simulations, the corresponding simulation line is not
printed, but the iteration number is incremented. Finally, in
MCMC simulations, the parameter for which the data likelihood was
computed is simply not updated (which implicitly forbids the
uncomputable region of the parameter space). In all cases an error
message is given on the screen, or wherever the screen output has been
redirected.</P><P>

<A NAME="Common Pitfalls"></A>
<HR SIZE="6">
<A NAME="SEC52"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC51"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC53"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC28"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC53"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 7. Common Pitfalls </H1>
<!--docid::SEC52::-->
<P>

The following mistakes are particularly easy to make, and sometimes
hard to notice, or understand at first.</P><P>

<UL>
<LI>
Forgetting about type-related arithmetics in C: `<SAMP>1000/882</SAMP>' gives
`<SAMP>1</SAMP>' since it is interpreted as an integer division by the compiler.
To get a floating-point (usual) division use `<SAMP>1000./882.</SAMP>'.<P>

<LI>
Forgetting a semi-colon (';') at the end of statements: the error is
usually detected at the following line(s) where in fact nothing may be
wrong.<P>

</UL>
<P>

<A NAME="XMCSim"></A>
<HR SIZE="6">
<A NAME="SEC53"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC54"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC52"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC54"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 8. XMCSim </H1>
<!--docid::SEC53::-->
<P>

<EM>XMCSim</EM> is a menu-driven interface which automatizes the
compilation and running tasks of <EM>MCSim</EM>. It also offers a
convenient interface to 2-D and 3-D plotting of the simulation
results. Note that you need <CODE>XWindows</CODE>, <CODE>Tcl/Tk</CODE> and
<CODE>wish</CODE> installed to run <EM>XMCSim</EM>. <CODE>xemacs</CODE> is also
recommended.</P><P>

Just type <CODE>xmcsim</CODE> at the command promt. A windows appear, with
a menu bar. Menu items are:</P><P>

<UL>
<LI>
<CODE>File</CODE>, which allows you to choose an existing model file or to
exit the program. Once you have chosen a model file, its file name
appears as a reminder at the bottom of the window.<P>

<LI>
<CODE>Edit</CODE>, which calls <CODE>xemacs</CODE> for you to create a new model
file or edit any file of your choice (for example an input or output
file). Note: if you do not have <CODE>xemacs</CODE> installed you can change
the file `<TT>xmcsim</TT>' to replace the call to <CODE>xemacs</CODE> by a call to
your editor.<P>

<LI>
<CODE>Compile</CODE> has two items: <CODE>Compile model</CODE> will compile
the current model file or prompt you for one and will call <CODE>mod</CODE> to
generate a `<TT>model.c</TT>' file from it; <CODE>Compile mcsim</CODE> will
first call <CODE>mod</CODE> and will then go on to create an executable mcsim
filevia a call to <CODE>makemcsim</CODE> create an executable program.<P>

<LI>
<CODE>Run</CODE> with three items: <CODE>Run</CODE> which will prompt you for
an executable mcsim file, an input file and an output file (the latter
is optional) and will then launch the executable; <CODE>Stop</CODE> will
just stop a running executable; <CODE>Debug</CODE> will produce a
standalone executable with a name starting with `<TT>debugmcsim</TT>' and
will launch <CODE>xemacs</CODE> for you (you will then need to call
<CODE>gdb</CODE> or another debugger by yourself; if you find a way to
start gdb on an executable <I>via</I> xemacs on the command line please
tell me...).<P>

<LI>
<CODE>Plot</CODE> will start an Xgnuplot-based interface to <CODE>gnuplot</CODE>
An <CODE>Help</CODE> menu available there to guide you further in the
arcanes of <CODE>gnuplot</CODE>, but we recommend that you also browse
<CODE>gnuplot</CODE> documentation.<P>

</UL>
<P>

At some point <EM>MCSim</EM> will do symbolic computations, wash dishes,
clothes and cars, and write poems, but for now, that's all folks!</P><P>

<A NAME="Bibliographic References"></A>
<HR SIZE="6">
<A NAME="SEC54"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC53"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC55"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC53"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC55"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> Bibliographic References </H1>
<!--docid::SEC54::-->
<P>

Barry T.M. (1996). Recommendations on the testing and use of
pseudo-random number generators used in Monte Carlo analysis for risk
assessment. Risk Analysis <B>16</B>:93-105.
</P><P>

Bernardo J.M. and Smith A.F.M. (1994). Bayesian Theory. Wiley, New
York.
</P><P>

Bois F.Y., Gelman A., Jiang J., Maszle D., Zeise L. and Alexeef
G. (1996). Population toxicokinetics of tetrachloroethylene. Archives of
Toxicology <B>70</B>:347-355.
</P><P>

Bois F.Y., Smith T.J., Gelman, A., Chang H.Y., Smith
A.E. (1999). Optimal design for a study of butadiene toxicokinetics in
humans. Toxicological Sciences <B>49</B>:213-224.
</P><P>

Bois F.Y., Zeise L. and Tozer T.N. (1990). Precision and
sensitivity analysis of pharmacokinetic models for cancer risk
assessment: tetrachloroethylene in mice, rats and humans. Toxicology and
Applied Pharmacology <B>102</B>:300-315.
</P><P>

Gear C.W. (1971a). Algorithm 407 - DIFSUB for solution of ordinary
differential equations [D2]. Communications of the ACM <B>14</B>:185-190.
</P><P>

Gear C.W. (1971b). The automatic integration of ordinary differential
equations. Communications of the ACM <B>14</B>:176-179.
</P><P>

Gelman A. (1992). Iterative and non-iterative simulation algorithms.
Computing Science and Statistics <B>24</B>:433-438.
</P><P>

Gelman A., Bois F.Y. and Jiang J. (1996). Physiological
pharmacokinetic analysis using population modeling and informative prior
distributions. Journal of the American Statistical Association 
<B>91</B>:1400-1412.
</P><P>

Gelman A., Carlin J.B., Stern H.S. and Rubin D.B. (1995).
Bayesian Data Analysis. Chapman &#38; Hall, London.
</P><P>

Gelman A. and Rubin D.B. (1992). Inference from iterative simulation
using multiple sequences (with discussion). Statistical Science 
<B>7</B>:457-511.
</P><P>

Gilks W.R., Richardson S. and Spiegelhalter D.J. (1996). Markov Chain
Monte Carlo In Practice. Chapman &#38; Hall, London.
</P><P>

Hammersley J.M. and Handscomb D.C. (1964). Monte Carlo Methods.
Chapman and Hall, London.
</P><P>

Manteufel R.D. (1996). Variance-based importance analysis applied to a
complex probabilistic performance assessment. Risk Analysis 
<B>16</B>:587-598.
</P><P>

Park S.K. and Miller K.W. (1988). Random number generators: good
ones are hard to find. Communications of the ACM <B>31</B>:1192-1201.
</P><P>

Press W.H., Flannery B.P., Teukolsky S.A. and Vetterling W.T.
(1989). Numerical Recipes (2nd ed.). Cambridge University Press,
Cambridge.
</P><P>

Smith A.F.M. (1991). Bayesian computational methods. Philosophical
Transactions of the Royal Society of London, Series A <B>337</B>:369-386.
</P><P>

Smith A.F.M. and Roberts G.O. (1993). Bayesian computation via the
Gibbs sampler and related Markov chain Monte Carlo methods. Journal of
the Royal Statistical Society Series B <B>55</B>:3-23.
</P><P>

Vattulainen I., Ala-Nissila T. and Kankaala K. (1994). Physical tests
for random numbers in simulations. Physical Review Letters 
<B>73</B>:2513-2516.
</P><P>

<A NAME="Keywords List"></A>
<HR SIZE="6">
<A NAME="SEC55"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC54"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC54"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> A. Keywords List </H1>
<!--docid::SEC55::-->
<P>

You should avoid using the following reserved keywords when building
your models:</P><P>

<TABLE>

<TR><TD>Beta                         </TD><TD>  LogUniform</TD>
</TR>
<TR><TD>BetaRandom                   </TD><TD>  LogUniformRandom</TD>
</TR>
<TR><TD>Binomial                     </TD><TD>  Lsodes</TD>
</TR>
<TR><TD>BinomialBetaRandom           </TD><TD>  MCMC</TD>
</TR>
<TR><TD>BinomialRandom               </TD><TD>  MonteCarlo</TD>
</TR>
<TR><TD>CDFNormal                    </TD><TD>  NDoses</TD>
</TR>
<TR><TD>CalcOutputs                  </TD><TD>  Normal</TD>
</TR>
<TR><TD>CauchyRandom                 </TD><TD>  NormalRandom</TD>
</TR>
<TR><TD>Chi2                         </TD><TD>  Normal_v</TD>
</TR>
<TR><TD>Chi2Random                   </TD><TD>  OptimalDesign</TD>
</TR>
<TR><TD>Data                         </TD><TD>  OutputFile</TD>
</TR>
<TR><TD>DefaultSim                   </TD><TD>  Outputs</TD>
</TR>
<TR><TD>Density                      </TD><TD>  PerDose</TD>
</TR>
<TR><TD>Distrib                      </TD><TD>  PerExp</TD>
</TR>
<TR><TD>dt                           </TD><TD>  Piecewise</TD>
</TR>
<TR><TD>Dynamics                     </TD><TD>  PiecewiseRandom</TD>
</TR>
<TR><TD>End                          </TD><TD>  Poisson</TD>
</TR>
<TR><TD>Euler                        </TD><TD>  PoissonRandom</TD>
</TR>
<TR><TD>ExpRandom                    </TD><TD>  Prediction</TD>
</TR>
<TR><TD>Experiment                   </TD><TD>  Print</TD>
</TR>
<TR><TD>Exponential                  </TD><TD>  PrintStep</TD>
</TR>
<TR><TD>GGammaRandom                 </TD><TD>  Scale</TD>
</TR>
<TR><TD>Gamma                        </TD><TD>  SetPoints</TD>
</TR>
<TR><TD>GammaRandom                  </TD><TD>  SetSeed</TD>
</TR>
<TR><TD>GetSeed                      </TD><TD>  SimType</TD>
</TR>
<TR><TD>Gibbs                        </TD><TD>  Simulation</TD>
</TR>
<TR><TD>IFN                          </TD><TD>  Spikes</TD>
</TR>
<TR><TD>Initialize                   </TD><TD>  StartTime</TD>
</TR>
<TR><TD>Inputs                       </TD><TD>  States</TD>
</TR>
<TR><TD>Integrate                    </TD><TD>  StudentTRandom</TD>
</TR>
<TR><TD>InvGGammaRandom              </TD><TD>  t</TD>
</TR>
<TR><TD>InvGamma                     </TD><TD>  TruncLogNormal</TD>
</TR>
<TR><TD>Level                        </TD><TD>  TruncLogNormalRandom</TD>
</TR>
<TR><TD>Likelihood                   </TD><TD>  TruncLogNormal_v</TD>
</TR>
<TR><TD>lnDFNormal                   </TD><TD>  TruncNormal</TD>
</TR>
<TR><TD>lnGamma                      </TD><TD>  TruncNormalRandom</TD>
</TR>
<TR><TD>LogNormal                    </TD><TD>  TruncNormal_v</TD>
</TR>
<TR><TD>LogNormalRandom              </TD><TD>  Uniform</TD>
</TR>
<TR><TD>LogNormal_v                  </TD><TD>  UniformRandom</TD>
</TR></TABLE>
 
<P>

<A NAME="Examples"></A>
<HR SIZE="6">
<A NAME="SEC56"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC55"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC57"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC55"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> B. Examples </H1>
<!--docid::SEC56::-->
<P>

You will find here some examples of model description files and 
simulation input files.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC57">B.1 `<TT>linear.model</TT>'</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a simple algebraic model</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC58">B.2 `<TT>1cpt.model</TT>': A sample model description file</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a one-compartment pharmacokinetic model</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC59">B.3 `<TT>perc.model</TT>': A sample model description file</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a multi-compartment pharmacokinetic model</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="mcsim.html#SEC60">B.4 `<TT>perc.lsodes.in</TT>'</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">a sample simulation input file</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="linear.model"></A>
<HR SIZE="6">
<A NAME="SEC57"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC58"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> B.1 `<TT>linear.model</TT>' </H2>
<!--docid::SEC57::-->
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre># Linear Model with a random component
# y = A + B * time + N(0,SD_true)
# Setting SD_true to zero gives the deterministic version
#---------------------------------------------------------

# Outputs
Outputs = {y};

# Model Parameters
A = 0;
B = 1;
SD_true = 0;
SD_esti = 0;

CalcOutputs { y = A + B * t + NormalRandom(0,SD_true); } 
</pre></td></tr></table></P><P>

<A NAME="1cpt.model"></A>
<HR SIZE="6">
<A NAME="SEC58"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC57"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC59"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> B.2 `<TT>1cpt.model</TT>': A sample model description file </H2>
<!--docid::SEC58::-->
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre># One Compartment Model
# First order input and output
#---------------------------------------------------------

# Inputs
Inputs = {Dose};

# Outputs
Outputs = {C_central, AUC, ln_C_central, ln_AUC,
           SD_C_computed, SD_A_computed};

# Model Parameters
ka = 1;
ke = 0.5;
F  = 1;
V  = 2;

# Statistical Parameters
SDb_ka = 0;
SDw_ka = 0;
SDb_ke = 0;
SDw_ke = 0;
SDb_V  = 0;
min_F  = 0;
max_F  = 0;
SD_C_central = 0;
SD_AUC       = 0;
CV_C_cen     = 0;
CV_AUC       = 0;
CV_C_cen_true = 0;
CV_AUC_true   = 0;


# Calculate Outputs
CalcOutputs {

  # algebraic equation for C_central
  C_central = (ka != ke ?
               (exp(-ke * t) - exp(-ka * t)) * 
               F * ka * Dose / (V * (ka - ke))):
               exp(-ka * t) * ka * t * F * Dose / V);

  # algebraic equation for AUC
  AUC = (ka != ke ?
         ((1 - exp(-ke * t)) / ke - (1 - exp(-ka * t)) / ka) * F * ka * Dose / 
         (V * (ka - ke))):
         F * Dose * (1 - (1 + ka * t) * exp(-ka * t)) / (V * ke));

  C_central = C_central + NormalRandom(0, C_central * CV_C_cen_true);
  AUC       = AUC + NormalRandom(0, AUC * CV_AUC_true);

  ln_C_central = (C_central &#62; 0 ? log (C_central) : -100);
  ln_AUC = (AUC &#62; 0 ? log (AUC) : -100);

  SD_C_computed = (C_central &#62; 0 ? C_central * CV_C_cen : 1e-10);
  SD_A_computed = (AUC &#62; 0 ? AUC * CV_AUC : 1e-10);

} # End of output calculations
</pre></td></tr></table></P><P>

<A NAME="perc.model"></A>
<HR SIZE="6">
<A NAME="SEC59"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC58"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC60"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> B.3 `<TT>perc.model</TT>': A sample model description file </H2>
<!--docid::SEC59::-->
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#---------------------------------------------------------
# perc.model
# A four compartment model of Tetrachloroethylene (PERC)
# and total metabolites.
#---------------------------------------------------------
# States are quantities of PERC and metabolite formed, they can be output

States = {Q_fat,        # Quantity of PERC in the fat
          Q_wp,         #   ...   in the well-perfused compartment
          Q_pp,         #   ...   in the poorly-perfused compartment
          Q_liv,        #   ...   in the liver
          Q_exh,        #   ...   exhaled
          Qmet};        # Quantity of metabolite formed


# Extra outputs are concentrations at various points

Outputs = {C_liv,               # mg/l in the liver
           C_alv,               # ... in the alveolar air
           C_exh,               # ... in the exhaled air
           C_ven,               # ... in the venous blood
           Pct_metabolized,     # % of the dose metabolized
           C_exh_ug};           # ug/l in the exhaled air

Inputs = {C_inh}                # Concentration inhaled

# Constants
# Conversions from/to ppm: 72 ppm = .488 mg/l

PPM_per_mg_per_l = 72.0 / 0.488;
mg_per_l_per_PPM = 1/PPM_per_mg_per_l;

#---------------------------------------------------------
# Nominal values for parameters
# Units:
# Volumes: liter
# Vmax:    mg / minute
# Weights: kg
# Km:      mg / minute
# Time:    minute
# Flows:   liter / minute
#---------------------------------------------------------

InhMag = 0.0;
Period = 0.0;
Exposure = 0.0;

C_inh = PerDose (InhMag, Period, 0.0, Exposure);

LeanBodyWt = 55;    # lean body weight

# Percent mass of tissues with ranges shown

Pct_M_fat  = .16;   # % total body mass
Pct_LM_liv = .03;   # liver, % of lean mass
Pct_LM_wp  = .17;   # well perfused tissue, % of lean mass
Pct_LM_pp  = .70;   # poorly perfused tissue, will be recomputed in scale

# Percent blood flows to tissues

Pct_Flow_fat = .09;
Pct_Flow_liv = .34;
Pct_Flow_wp  = .50; # will be recomputed in scale
Pct_Flow_pp  = .07;

# Tissue/blood partition coeficients

PC_fat = 144;
PC_liv = 4.6;
PC_wp  = 8.7;
PC_pp  = 1.4;
PC_art = 12.0;

Flow_pul   = 8.0;    # Pulmonary ventilation rate (minute volume)
Vent_Perf = 1.14;    # ventilation over perfusion ratio

sc_Vmax = .0026;     # scaling coeficient of body weight for Vmax

Km = 1.0;  

# The following parameters are calculated from the above values in 
# the Scale section before the start of each simulation.
# They are left uninitialized here.

BodyWt = 0;

V_fat = 0;           # Actual volume of tissues
V_liv = 0;
V_wp  = 0;
V_pp  = 0;

Flow_fat = 0;        # Actual blood flows through tissues
Flow_liv = 0;
Flow_wp  = 0;
Flow_pp  = 0;

Flow_tot = 0;        # Total blood flow
Flow_alv = 0;        # Alveolar ventilation rate

Vmax = 0;            # kg/minute


#---------------------------------------------------------
# Dynamics
# Define the dynamics of the simulation. This section is
# calculated with each integration step. It includes
# specification of differential equations.
#---------------------------------------------------------

Dynamics {

# Venous blood concentrations at the organ exit

Cout_fat = Q_fat / (V_fat * PC_fat);
Cout_wp  = Q_wp  / (V_wp  * PC_wp);
Cout_pp  = Q_pp  / (V_pp  * PC_pp);
Cout_liv = Q_liv / (V_liv * PC_liv);

# Sum of Flow * Concentration for all compartments

dQ_ven = Flow_fat * Cout_fat + Flow_wp * Cout_wp
         + Flow_pp * Cout_pp + Flow_liv * Cout_liv;

# Venous blood concentration

C_ven =  dQ_ven / Flow_tot;

# Arterial blood concentration
# Convert input given in ppm to mg/l to match other units

C_art = (Flow_alv * C_inh / PPM_per_mg_per_l +  dQ_ven) / 
        (Flow_tot + Flow_alv / PC_art);

# Alveolar air concentration

C_alv = C_art / PC_art;

# Exhaled air concentration
  
C_exh = 0.7 * C_alv + 0.3 * C_inh / PPM_per_mg_per_l;

# Differentials

dt (Q_exh) = Flow_alv * C_alv;
dt (Q_fat) = Flow_fat * (C_art - Cout_fat);
dt (Q_wp)  = Flow_wp  * (C_art - Cout_wp);
dt (Q_pp)  = Flow_pp  * (C_art - Cout_pp);

# Quantity metabolized in liver

dQmet_liv = Vmax * Q_liv / (Km + Q_liv);
dt (Q_liv) = Flow_liv * (C_art - Cout_liv) - dQmet_liv;

# Metabolite formation

dt (Qmet)  = dQmet_liv;

} # End of Dynamics


#---------------------------------------------------------
# Scale
# Scale certain model parameters and resolve dependencies
# between parameters. Generally the scaling involves a
# change of units, or conversion from percentage to actual
# units.
#---------------------------------------------------------

Scale {

# Volumes scaled to actual volumes

BodyWt = LeanBodyWt/(1 - Pct_M_fat);

V_fat = Pct_M_fat  * BodyWt/0.92;        # density of fat = 0.92 g/ml
V_liv = Pct_LM_liv * LeanBodyWt;
V_wp  = Pct_LM_wp  * LeanBodyWt;
V_pp  = 0.9 * LeanBodyWt - V_liv - V_wp; # 10% bones

# Calculate Flow_alv from total pulmonary flow

Flow_alv = Flow_pul * 0.7;

# Calculate total blood flow from the alveolar ventilation rate and 
# the V/P ratio.

Flow_tot = Flow_alv / Vent_Perf;
 
# Calculate actual blood flows from total flow and percent flows 

Flow_fat = Pct_Flow_fat * Flow_tot;
Flow_liv = Pct_Flow_liv * Flow_tot;
Flow_pp  = Pct_Flow_pp  * Flow_tot;
Flow_wp  = Flow_tot - Flow_fat - Flow_liv - Flow_pp;

# Vmax (mass/time) for Michaelis-Menten metabolism is scaled
# by multiplication of bdw^0.7 

Vmax = sc_Vmax * exp (0.7 * log (LeanBodyWt));

} # End of model scaling


#---------------------------------------------------------
# CalcOutputs 
# The following outputs are only calculated just before values
# are saved.  They are not calculated with each integration step.
#---------------------------------------------------------

CalcOutputs {

# Fraction of TCE metabolized per day

Pct_metabolized = (InhMag ?
                   Qmet / (1440 * Flow_alv * InhMag * mg_per_l_per_PPM) :
                   0);

C_exh_ug  = C_exh * 1000; # milli to micrograms

} # End of output calculation
</pre></td></tr></table></P><P>

<A NAME="perc.lsodes.in"></A>
<HR SIZE="6">
<A NAME="SEC60"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC59"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> B.4 `<TT>perc.lsodes.in</TT>' </H2>
<!--docid::SEC60::-->
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#---------------------------------------------------------
# perc.lsodes.in
#
#---------------------------------------------------------

Integrate (Lsodes, 1e-4, 1e-6, 1);


#---------------------------------------------------------
# The following is a simulation of one of Dr. Monster's
# exposure experiments described in "Kinetics of Tetracholoroethylene 
# in Volunteers; Influence of Exposure Concentration and Work Load," 
# A.C. Monster, G. Boersma, and H. Steenweg, 
# Int. Arch. Occup. Environ. Health, v42, 1989, pp303-309
#
# The paper documents measurements of levels of TCE in blood and
# exhaled air for a group of 6 subjects exposed to 
# different concentrations of PERC in air.
#
# Inhalation is specified as a dose of magnitude InhMag for the
# given Exposure time.
#
# Inhalation is given in ppm
#---------------------------------------------------------

Simulation {

InhMag = 72;            # ppm
Period = 1e10;          # Only one dose
Exposure = 240;         # 4 hour exposure

# measurements before end of exposure and at [5' 30'] 2hr 18 42 67 91 139 163

Print (C_exh_ug, 239.9 245 270 360 1320 2760 4260 5700 8580 10020 );
Print (C_ven, 239.9 360 1320 2760 4260 5700 8580 10020 );

}

END.
</pre></td></tr></table></P><P>

<A NAME="Concept Index"></A>
<HR SIZE="6">
<A NAME="SEC61"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC60"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC56"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> Concept Index </H1>
<!--docid::SEC61::-->
     
<table><tr><th valign=top>Jump to: &nbsp; </th><td><A HREF="mcsim.html#cp_'" style="text-decoration:none"><b>'</b></A>
 &nbsp; 
<BR>
<A HREF="mcsim.html#cp_A" style="text-decoration:none"><b>A</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_B" style="text-decoration:none"><b>B</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_C" style="text-decoration:none"><b>C</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_D" style="text-decoration:none"><b>D</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_E" style="text-decoration:none"><b>E</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_F" style="text-decoration:none"><b>F</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_G" style="text-decoration:none"><b>G</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_H" style="text-decoration:none"><b>H</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_I" style="text-decoration:none"><b>I</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_K" style="text-decoration:none"><b>K</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_L" style="text-decoration:none"><b>L</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_M" style="text-decoration:none"><b>M</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_N" style="text-decoration:none"><b>N</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_O" style="text-decoration:none"><b>O</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_P" style="text-decoration:none"><b>P</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_Q" style="text-decoration:none"><b>Q</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_R" style="text-decoration:none"><b>R</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_S" style="text-decoration:none"><b>S</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_T" style="text-decoration:none"><b>T</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_U" style="text-decoration:none"><b>U</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_V" style="text-decoration:none"><b>V</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_W" style="text-decoration:none"><b>W</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_X" style="text-decoration:none"><b>X</b></A>
 &nbsp; 
</td></tr></table><br><P></P>
<TABLE border=0>
<TR><TD></TD><TH ALIGN=LEFT>Index Entry</TH><TH ALIGN=LEFT> Section</TH></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_'"></A>'</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX28">'!=' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX9">'#' sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX38">'-' (hyphen) sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX22">':' sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX11">';' sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX29">'&#60;' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX32">'&#60;=' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX31">'&#60;&#62;' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX15">'=' sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX27">'==' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX30">'&#62;' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX33">'&#62;=' operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX21">'?' sign</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX37">'[]' (square brackets) notation</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX136">'_' (underscore) in templates</A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX40">'_' (underscore) vector notation</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_A"></A>A</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Algebraic models</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC50">Analyzing simulation output</A></TD><TD valign=top><A HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX35">Arrays</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX14">Assignment</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_B"></A>B</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX146"><CODE>Beta</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX45"><CODE>BetaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC54">Bibliographic references</A></TD><TD valign=top><A HREF="mcsim.html#SEC54">Bibliographic References</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX148"><CODE>Binomial</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX48"><CODE>BinomialBetaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX51"><CODE>BinomialRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX10">Blank lines</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_C"></A>C</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC25"><CODE>CalcOutputs</CODE>, output section</A></TD><TD valign=top><A HREF="mcsim.html#SEC25">5.3.9 Output calculations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX150"><CODE>Cauchy</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX151">Cauchy distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX54"><CODE>CauchyRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX57"><CODE>CDFNormal()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX155">Chi-square distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX154"><CODE>Chi2</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX61"><CODE>Chi2Random()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX20">Colon conditional assignment</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX8">Comments</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC52">Common pitfalls</A></TD><TD valign=top><A HREF="mcsim.html#SEC52">7. Common Pitfalls</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX26">Comparison operators</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX134"><CODE>Compartment</CODE> keyword</A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX65">Complementary error function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX23">Conditional assignment</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX60">Cumulative density function, Normal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_D"></A>D</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX206"><CODE>Data()</CODE> qualifier, for use in <CODE>Distrib()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX1">Default</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC13">Defining models</A></TD><TD valign=top><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX86">Density function, Normal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX212"><CODE>Density()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX132">Derivative specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Differential models</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Discrete-time models</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX147">Distribution, <CODE>Beta</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX149">Distribution, <CODE>Binomial</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX152">Distribution, <CODE>Cauchy</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX153">Distribution, Cauchy</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX157">Distribution, Chi-square</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX156">Distribution, <CODE>Chi2</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX159">Distribution, <CODE>Exponential</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX161">Distribution, <CODE>Gamma</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX163">Distribution, <CODE>HalfCauchy</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX165">Distribution, <CODE>HalfNormal</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX168">Distribution, inverse-gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX169">Distribution, <CODE>InvGamma</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX171">Distribution, <CODE>Lognormal</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX173">Distribution, <CODE>Lognormal_v</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX175">Distribution, <CODE>Loguniform</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX177">Distribution, <CODE>Normal</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX179">Distribution, <CODE>Normal_v</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX181">Distribution, <CODE>Piecewise</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX185">Distribution, <CODE>Poisson</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX187">Distribution, <CODE>StudentT</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX183">Distribution, triangular</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX190">Distribution, truncated inverse-gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX195">Distribution, truncated lognormal</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX201">Distribution, truncated normal</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX191">Distribution, <CODE>TruncInvGamma</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX193">Distribution, <CODE>TruncLogNormal</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX197">Distribution, <CODE>Trunclognormal_v</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX199">Distribution, <CODE>TruncNormal</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX203">Distribution, <CODE>Truncnormal_v</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX205">Distribution, <CODE>Uniform</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX131"><CODE>Dt()</CODE> operator</A></TD><TD valign=top><A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC24">Dynamics section</A></TD><TD valign=top><A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_E"></A>E</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX64"><CODE>erfc()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX66">Error function, complementary</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC51">Error handling</A></TD><TD valign=top><A HREF="mcsim.html#SEC51">6.4 Error handling</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Euler</CODE> integrator</A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX7">Examples</A></TD><TD valign=top><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC56">Examples</A></TD><TD valign=top><A HREF="mcsim.html#SEC56">B. Examples</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC43"><CODE>Experiment</CODE> sections</A></TD><TD valign=top><A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX6">Experimental design optimization</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX158"><CODE>Exponential</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX68"><CODE>ExpRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_F"></A>F</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX46">Function, <CODE>BetaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX49">Function, <CODE>BinomialBetaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX52">Function, <CODE>BinomialRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX55">Function, <CODE>CauchyRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX58">Function, <CODE>CDFNormal()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX62">Function, <CODE>Chi2Random()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX67">Function, <CODE>erfc()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX69">Function, <CODE>ExpRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX72">Function, <CODE>GammaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX75">Function, <CODE>GetSeed()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX78">Function, <CODE>GGammaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC22">Function, Inline, in line</A></TD><TD valign=top><A HREF="mcsim.html#SEC22">5.3.6 In line functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX19">Function, input</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX81">Function, <CODE>InvGGammaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX84">Function, <CODE>lnDFNormal()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX88">Function, <CODE>lnGamma()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX91">Function, <CODE>LogNormalRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX94">Function, <CODE>LogUniformRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX128">Function, <CODE>NDoses()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX143">Function, <CODE>NDoses()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX97">Function, <CODE>NormalRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX124">Function, <CODE>PerDose()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX139">Function, <CODE>PerDose()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX126">Function, <CODE>PerExp()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX141">Function, <CODE>PerExp()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX100">Function, <CODE>PiecewiseRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX103">Function, <CODE>PoissonRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX106">Function, <CODE>SetSeed()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX17">Function, special</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX130">Function, <CODE>Spikes()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX145">Function, <CODE>Spikes()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX109">Function, <CODE>StudentTRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX112">Function, <CODE>TruncInvGGammaRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX115">Function, <CODE>TruncLogNormalRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX118">Function, <CODE>TruncNormalRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX121">Function, <CODE>UniformRandom()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC21">Functions, input</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC32">Functions, input</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC20">Functions, special</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_G"></A>G</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX160"><CODE>Gamma</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX89">Gamma function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX71"><CODE>GammaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC31">General input file syntax</A></TD><TD valign=top><A HREF="mcsim.html#SEC31">6.2.1 General input file syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX74"><CODE>GetSeed()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX77"><CODE>GGammaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC33">Global specifications</A></TD><TD valign=top><A HREF="mcsim.html#SEC33">6.2.3 Global specifications</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_H"></A>H</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX162"><CODE>HalfCauchy</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX164"><CODE>HalfNormal</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_I"></A>I</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC23">Initialize, initialization section,</A></TD><TD valign=top><A HREF="mcsim.html#SEC23">5.3.7 Model initialization</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC22">Inline, in line functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC22">5.3.6 In line functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX18">Input functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC21">Input functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC32">Input functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX43">Input variables</A></TD><TD valign=top><A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC6">Installation</A></TD><TD valign=top><A HREF="mcsim.html#SEC6">3. Installation</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35">Integration routine, <CODE>Euler</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35">Integration routine, <CODE>Lsodes</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX133">Integration variable</A></TD><TD valign=top><A HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX167">Inverse-gamma distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX166"><CODE>InvGamma</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX80"><CODE>InvGGammaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_K"></A>K</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX135">Keyword, <CODE>Compartment</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC55">Keywords list</A></TD><TD valign=top><A HREF="mcsim.html#SEC55">A. Keywords List</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_L"></A>L</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC48"><CODE>Level</CODE> sections</A></TD><TD valign=top><A HREF="mcsim.html#SEC48"><CODE>Level</CODE> sections</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC1">License</A></TD><TD valign=top><A HREF="mcsim.html#SEC1">1. Software License</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX210"><CODE>Likelihood()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX83"><CODE>lnDFNormal()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX87"><CODE>lnGamma()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX24">Logical tests</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX170"><CODE>Lognormal</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX172"><CODE>LogNormal_v</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX90"><CODE>LogNormalRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX174"><CODE>LogUniform</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX93"><CODE>LogUniformRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Lsodes</CODE> integrator</A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_M"></A>M</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC5">Major changes in version 5.3.0</A></TD><TD valign=top><A HREF="mcsim.html#SEC5">2.3 Major changes introduced with version 5.3.0</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC15"><CODE>makemcsim</CODE> script</A></TD><TD valign=top><A HREF="mcsim.html#SEC15">5.2 Using <CODE>makemcsim</CODE> to fully process model files</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX4">Markov-chain Monte Carlo simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC37">Markov-chain Monte Carlo simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX3"><CODE>MCMC</CODE> simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC</CODE> simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC16"><CODE>mod</CODE> syntax</A></TD><TD valign=top><A HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC14"><CODE>mod</CODE> usage</A></TD><TD valign=top><A HREF="mcsim.html#SEC14">5.1 Using <CODE>mod</CODE> to preprocess model description files</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC13">Model definition files</A></TD><TD valign=top><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Model types</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Models, algebraic</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Models, differential</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Models, discrete-time</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC47">Models, statistical</A></TD><TD valign=top><A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX2">Monte Carlo simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC36">Monte Carlo simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_N"></A>N</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX127"><CODE>NDoses()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX142"><CODE>NDoses()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX59">Normal cumulative density function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX85">Normal density function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX176"><CODE>Normal</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX178"><CODE>Normal_v</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX96"><CODE>NormalRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_O"></A>O</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC25">Output specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC25">5.3.9 Output calculations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX44">Output variables</A></TD><TD valign=top><A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC2">Overview</A></TD><TD valign=top><A HREF="mcsim.html#SEC2">2. Overview</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_P"></A>P</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC18">Parameter declaration</A></TD><TD valign=top><A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC23">Parameter scaling</A></TD><TD valign=top><A HREF="mcsim.html#SEC23">5.3.7 Model initialization</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX123"><CODE>PerDose()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX138"><CODE>PerDose()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX125"><CODE>PerExp()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX140"><CODE>PerExp()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX180"><CODE>Piecewise</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX99"><CODE>PiecewiseRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC52">Pitfalls</A></TD><TD valign=top><A HREF="mcsim.html#SEC52">7. Common Pitfalls</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX184"><CODE>Poisson</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX102"><CODE>PoissonRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX208"><CODE>Prediction()</CODE> qualifier, for use in <CODE>Distrib()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_Q"></A>Q</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX207">Qualifier, <CODE>Data()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX209">Qualifier, <CODE>Prediction()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_R"></A>R</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX47">Random number, beta</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX53">Random number, binomial</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX50">Random number, binomial-beta</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX56">Random number, Cauchy</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX63">Random number, Chi-squared</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX70">Random number, exponential</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX73">Random number, gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX79">Random number, general-gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX82">Random number, inverse-gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX92">Random number, lognormal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX95">Random number, loguniform</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX98">Random number, normal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX101">Random number, piecewise</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX104">Random number, Poisson</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX110">Random number, Student <I>t</I></A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX113">Random number, truncated inverse-gamma</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX116">Random number, truncated lognormal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX119">Random number, truncated normal</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX122">Random number, uniform</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX76">Random seed, reading its value</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX107">Random seed, setting its value</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC55">Reserved keywords</A></TD><TD valign=top><A HREF="mcsim.html#SEC55">A. Keywords List</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC28">Running simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC28">6. Running Simulations</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_S"></A>S</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC27">SBML models</A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC23">Scale, scaling section</A></TD><TD valign=top><A HREF="mcsim.html#SEC23">5.3.7 Model initialization</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX12">Semi-colon</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX5"><CODE>SetPoints</CODE> simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC4">2.2 Types of simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX105"><CODE>SetSeed()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC47">Setting-up statistical models</A></TD><TD valign=top><A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC13">Setting-up structural models</A></TD><TD valign=top><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC41"><CODE>SimType()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC41"><CODE>SimType()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC28">Simulation definition files</A></TD><TD valign=top><A HREF="mcsim.html#SEC28">6. Running Simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC30">Simulation file, syntax</A></TD><TD valign=top><A HREF="mcsim.html#SEC30">6.2 Syntax of the simulation definition file</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A></TD><TD valign=top><A HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC1">Software license</A></TD><TD valign=top><A HREF="mcsim.html#SEC1">1. Software License</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX16">Special functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC20">Special functions</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC49">Specification, <CODE>Data()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX213">Specification, <CODE>Density()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC40">Specification, <CODE>Distrib()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC35">Specification, <CODE>Integrate()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX211">Specification, <CODE>Likelihood()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC37">Specification, <CODE>MCMC()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC36">Specification, <CODE>MonteCarlo()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC39">Specification, <CODE>OptimalDesign()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC34">Specification, <CODE>OutputFile()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC45">Specification, <CODE>Print()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC46">Specification, <CODE>PrintStep()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC38">Specification, <CODE>SetPoints()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC41">Specification, <CODE>SimType()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC41"><CODE>SimType()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC44">Specification, <CODE>StartTime()</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC44"><CODE>StartTime()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC33">Specifications, global</A></TD><TD valign=top><A HREF="mcsim.html#SEC33">6.2.3 Global specifications</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC28">Specifying simulations</A></TD><TD valign=top><A HREF="mcsim.html#SEC28">6. Running Simulations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX129"><CODE>Spikes()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC21">5.3.5 Input functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX144"><CODE>Spikes()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX36">Square brackets</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC44"><CODE>StartTime()</CODE> specification</A></TD><TD valign=top><A HREF="mcsim.html#SEC44"><CODE>StartTime()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX42">State variables</A></TD><TD valign=top><A HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC47">Statistical models</A></TD><TD valign=top><A HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC13">Structural models</A></TD><TD valign=top><A HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC19">Structural models</A></TD><TD valign=top><A HREF="mcsim.html#SEC19">5.3.3 Model types</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX186"><CODE>StudentT</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX108"><CODE>StudentTRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC26">Style</A></TD><TD valign=top><A HREF="mcsim.html#SEC26">5.3.10 Comments on style</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC16">Syntax for <CODE>mod</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC30">Syntax of simulation files</A></TD><TD valign=top><A HREF="mcsim.html#SEC30">6.2 Syntax of the simulation definition file</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_T"></A>T</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC27">Template models</A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX25">Tests, logical</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX182">Triangular distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX189">Truncated Inverse-gamma distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX194">Truncated lognormal distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX200">Truncated normal distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX188"><CODE>TruncInvGamma</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX111"><CODE>TruncInvGGammaRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX192"><CODE>TruncLogNormal</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX196"><CODE>TruncLogNormal_v</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX114"><CODE>TruncLogNormalRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX198"><CODE>TruncNormal</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX202"><CODE>TruncNormal_v</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX117"><CODE>TruncNormalRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_U"></A>U</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX41">Underscore syntax for vectors</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX137">Underscore use for template models</A></TD><TD valign=top><A HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX204"><CODE>Uniform</CODE> distribution</A></TD><TD valign=top><A HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX120"><CODE>UniformRandom()</CODE> function</A></TD><TD valign=top><A HREF="mcsim.html#SEC20">5.3.4 Special functions</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_V"></A>V</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX13">Variable names</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX39">Vectorization</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#IDX34">Vectors</A></TD><TD valign=top><A HREF="mcsim.html#SEC17">5.3.1 General syntax</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_W"></A>W</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC12">Working Through an Example</A></TD><TD valign=top><A HREF="mcsim.html#SEC12">4. Working Through an Example</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
<TR><TH><A NAME="cp_X"></A>X</TH><TD></TD><TD></TD></TR>
<TR><TD></TD><TD valign=top><A HREF="mcsim.html#SEC53"><CODE>xmcsim</CODE></A></TD><TD valign=top><A HREF="mcsim.html#SEC53">8. XMCSim</A></TD></TR>
<TR><TD COLSPAN=3> <HR></TD></TR>
</TABLE><P></P><table><tr><th valign=top>Jump to: &nbsp; </th><td><A HREF="mcsim.html#cp_'" style="text-decoration:none"><b>'</b></A>
 &nbsp; 
<BR>
<A HREF="mcsim.html#cp_A" style="text-decoration:none"><b>A</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_B" style="text-decoration:none"><b>B</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_C" style="text-decoration:none"><b>C</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_D" style="text-decoration:none"><b>D</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_E" style="text-decoration:none"><b>E</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_F" style="text-decoration:none"><b>F</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_G" style="text-decoration:none"><b>G</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_H" style="text-decoration:none"><b>H</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_I" style="text-decoration:none"><b>I</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_K" style="text-decoration:none"><b>K</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_L" style="text-decoration:none"><b>L</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_M" style="text-decoration:none"><b>M</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_N" style="text-decoration:none"><b>N</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_O" style="text-decoration:none"><b>O</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_P" style="text-decoration:none"><b>P</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_Q" style="text-decoration:none"><b>Q</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_R" style="text-decoration:none"><b>R</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_S" style="text-decoration:none"><b>S</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_T" style="text-decoration:none"><b>T</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_U" style="text-decoration:none"><b>U</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_V" style="text-decoration:none"><b>V</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_W" style="text-decoration:none"><b>W</b></A>
 &nbsp; 
<A HREF="mcsim.html#cp_X" style="text-decoration:none"><b>X</b></A>
 &nbsp; 
</td></tr></table><br>     
<HR SIZE="6">
<A NAME="SEC_Contents"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1>Table of Contents</H1>
<BLOCKQUOTE>
<A NAME="TOC1" HREF="mcsim.html#SEC1">1. Software License</A>
<BR>
<A NAME="TOC2" HREF="mcsim.html#SEC2">2. Overview</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC3" HREF="mcsim.html#SEC3">2.1 General procedure</A>
<BR>
<A NAME="TOC4" HREF="mcsim.html#SEC4">2.2 Types of simulations</A>
<BR>
<A NAME="TOC5" HREF="mcsim.html#SEC5">2.3 Major changes introduced with version 5.3.0</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC6" HREF="mcsim.html#SEC6">3. Installation</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC7" HREF="mcsim.html#SEC7">3.1 System requirements</A>
<BR>
<A NAME="TOC8" HREF="mcsim.html#SEC8">3.2 Distribution</A>
<BR>
<A NAME="TOC9" HREF="mcsim.html#SEC9">3.3 Machine-specific installation</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC10" HREF="mcsim.html#SEC10">3.3.1 Unix and GNU/Linux operating systems</A>
<BR>
<A NAME="TOC11" HREF="mcsim.html#SEC11">3.3.2 Other operating systems</A>
<BR>
</BLOCKQUOTE>
</BLOCKQUOTE>
<A NAME="TOC12" HREF="mcsim.html#SEC12">4. Working Through an Example</A>
<BR>
<A NAME="TOC13" HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC14" HREF="mcsim.html#SEC14">5.1 Using <CODE>mod</CODE> to preprocess model description files</A>
<BR>
<A NAME="TOC15" HREF="mcsim.html#SEC15">5.2 Using <CODE>makemcsim</CODE> to fully process model files</A>
<BR>
<A NAME="TOC16" HREF="mcsim.html#SEC16">5.3 Syntax of the model description file</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC17" HREF="mcsim.html#SEC17">5.3.1 General syntax</A>
<BR>
<A NAME="TOC18" HREF="mcsim.html#SEC18">5.3.2 Global variable declarations</A>
<BR>
<A NAME="TOC19" HREF="mcsim.html#SEC19">5.3.3 Model types</A>
<BR>
<A NAME="TOC20" HREF="mcsim.html#SEC20">5.3.4 Special functions</A>
<BR>
<A NAME="TOC21" HREF="mcsim.html#SEC21">5.3.5 Input functions</A>
<BR>
<A NAME="TOC22" HREF="mcsim.html#SEC22">5.3.6 In line functions</A>
<BR>
<A NAME="TOC23" HREF="mcsim.html#SEC23">5.3.7 Model initialization</A>
<BR>
<A NAME="TOC24" HREF="mcsim.html#SEC24">5.3.8 Dynamics section</A>
<BR>
<A NAME="TOC25" HREF="mcsim.html#SEC25">5.3.9 Output calculations</A>
<BR>
<A NAME="TOC26" HREF="mcsim.html#SEC26">5.3.10 Comments on style</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC27" HREF="mcsim.html#SEC27">5.4 Reading SBML models and applying a template</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC28" HREF="mcsim.html#SEC28">6. Running Simulations</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC29" HREF="mcsim.html#SEC29">6.1 Using the compiled program</A>
<BR>
<A NAME="TOC30" HREF="mcsim.html#SEC30">6.2 Syntax of the simulation definition file</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC31" HREF="mcsim.html#SEC31">6.2.1 General input file syntax</A>
<BR>
<A NAME="TOC32" HREF="mcsim.html#SEC32">6.2.2 Input functions (revisited)</A>
<BR>
<A NAME="TOC33" HREF="mcsim.html#SEC33">6.2.3 Global specifications</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC34" HREF="mcsim.html#SEC34"><CODE>OutputFile()</CODE> specification</A>
<BR>
<A NAME="TOC35" HREF="mcsim.html#SEC35"><CODE>Integrate()</CODE> specification</A>
<BR>
<A NAME="TOC36" HREF="mcsim.html#SEC36"><CODE>MonteCarlo()</CODE> specification</A>
<BR>
<A NAME="TOC37" HREF="mcsim.html#SEC37"><CODE>MCMC()</CODE> specification</A>
<BR>
<A NAME="TOC38" HREF="mcsim.html#SEC38"><CODE>SetPoints()</CODE> specification</A>
<BR>
<A NAME="TOC39" HREF="mcsim.html#SEC39"><CODE>OptimalDesign()</CODE> specification</A>
<BR>
<A NAME="TOC40" HREF="mcsim.html#SEC40"><CODE>Distrib()</CODE> specification</A>
<BR>
<A NAME="TOC41" HREF="mcsim.html#SEC41"><CODE>SimType()</CODE> specification</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC42" HREF="mcsim.html#SEC42">6.2.4 Specifying basic conditions to simulate</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC43" HREF="mcsim.html#SEC43"><CODE>Simulation</CODE> sections</A>
<BR>
<A NAME="TOC44" HREF="mcsim.html#SEC44"><CODE>StartTime()</CODE> specification</A>
<BR>
<A NAME="TOC45" HREF="mcsim.html#SEC45"><CODE>Print()</CODE> specification</A>
<BR>
<A NAME="TOC46" HREF="mcsim.html#SEC46"><CODE>PrintStep()</CODE> specification</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC47" HREF="mcsim.html#SEC47">6.2.5 Setting-up statistical models</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC48" HREF="mcsim.html#SEC48"><CODE>Level</CODE> sections</A>
<BR>
<A NAME="TOC49" HREF="mcsim.html#SEC49"><CODE>Data()</CODE> specification</A>
<BR>
</BLOCKQUOTE>
</BLOCKQUOTE>
<A NAME="TOC50" HREF="mcsim.html#SEC50">6.3 Analyzing simulation output</A>
<BR>
<A NAME="TOC51" HREF="mcsim.html#SEC51">6.4 Error handling</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC52" HREF="mcsim.html#SEC52">7. Common Pitfalls</A>
<BR>
<A NAME="TOC53" HREF="mcsim.html#SEC53">8. XMCSim</A>
<BR>
<A NAME="TOC54" HREF="mcsim.html#SEC54">Bibliographic References</A>
<BR>
<A NAME="TOC55" HREF="mcsim.html#SEC55">A. Keywords List</A>
<BR>
<A NAME="TOC56" HREF="mcsim.html#SEC56">B. Examples</A>
<BR>
<BLOCKQUOTE>
<A NAME="TOC57" HREF="mcsim.html#SEC57">B.1 `<TT>linear.model</TT>'</A>
<BR>
<A NAME="TOC58" HREF="mcsim.html#SEC58">B.2 `<TT>1cpt.model</TT>': A sample model description file</A>
<BR>
<A NAME="TOC59" HREF="mcsim.html#SEC59">B.3 `<TT>perc.model</TT>': A sample model description file</A>
<BR>
<A NAME="TOC60" HREF="mcsim.html#SEC60">B.4 `<TT>perc.lsodes.in</TT>'</A>
<BR>
</BLOCKQUOTE>
<A NAME="TOC61" HREF="mcsim.html#SEC61">Concept Index</A>
<BR>
</BLOCKQUOTE>
<HR SIZE=1>
<A NAME="SEC_OVERVIEW"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1>Short Table of Contents</H1>
<BLOCKQUOTE>
<A NAME="TOC1" HREF="mcsim.html#SEC1">1. Software License</A>
<BR>
<A NAME="TOC2" HREF="mcsim.html#SEC2">2. Overview</A>
<BR>
<A NAME="TOC6" HREF="mcsim.html#SEC6">3. Installation</A>
<BR>
<A NAME="TOC12" HREF="mcsim.html#SEC12">4. Working Through an Example</A>
<BR>
<A NAME="TOC13" HREF="mcsim.html#SEC13">5. Setting-up Structural Models</A>
<BR>
<A NAME="TOC28" HREF="mcsim.html#SEC28">6. Running Simulations</A>
<BR>
<A NAME="TOC52" HREF="mcsim.html#SEC52">7. Common Pitfalls</A>
<BR>
<A NAME="TOC53" HREF="mcsim.html#SEC53">8. XMCSim</A>
<BR>
<A NAME="TOC54" HREF="mcsim.html#SEC54">Bibliographic References</A>
<BR>
<A NAME="TOC55" HREF="mcsim.html#SEC55">A. Keywords List</A>
<BR>
<A NAME="TOC56" HREF="mcsim.html#SEC56">B. Examples</A>
<BR>
<A NAME="TOC61" HREF="mcsim.html#SEC61">Concept Index</A>
<BR>

</BLOCKQUOTE>
<HR SIZE=1>
<A NAME="SEC_About"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC61">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="mcsim.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1>About this document</H1>
This document was generated 
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>
<P></P>  
The buttons in the navigation panels have the following meaning:
<P></P>
<table border = "1">
<TR>
<TH> Button </TH>
<TH> Name </TH>
<TH> Go to </TH>
<TH> From 1.2.3 go to</TH>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ &lt; ] </TD>
<TD ALIGN="CENTER">
Back
</TD>
<TD>
previous section in reading order
</TD>
<TD>
1.2.2
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ &gt; ] </TD>
<TD ALIGN="CENTER">
Forward
</TD>
<TD>
next section in reading order
</TD>
<TD>
1.2.4
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ &lt;&lt; ] </TD>
<TD ALIGN="CENTER">
FastBack
</TD>
<TD>
previous or up-and-previous section 
</TD>
<TD>
1.1
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ Up ] </TD>
<TD ALIGN="CENTER">
Up
</TD>
<TD>
up section
</TD>
<TD>
1.2
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ &gt;&gt; ] </TD>
<TD ALIGN="CENTER">
FastForward
</TD>
<TD>
next or up-and-next section
</TD>
<TD>
1.3
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [Top] </TD>
<TD ALIGN="CENTER">
Top
</TD>
<TD>
cover (top) of document
</TD>
<TD>
 &nbsp; 
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [Contents] </TD>
<TD ALIGN="CENTER">
Contents
</TD>
<TD>
table of contents
</TD>
<TD>
 &nbsp; 
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [Index] </TD>
<TD ALIGN="CENTER">
Index
</TD>
<TD>
concept index
</TD>
<TD>
 &nbsp; 
</TD>
</TR>
<TR>
<TD ALIGN="CENTER">
 [ ? ] </TD>
<TD ALIGN="CENTER">
About
</TD>
<TD>
this page
</TD>
<TD>
 &nbsp; 
</TD>
</TR>
</TABLE>
<P></P>
where the <STRONG> Example </STRONG> assumes that the current position 
is at <STRONG> Subsubsection One-Two-Three </STRONG> of a document of 
the following structure:
<UL>
<LI> 1. Section One  </LI>
<UL>
<LI>1.1 Subsection One-One</LI>
<UL>
<LI> ... </LI>
</UL>
<LI>1.2 Subsection One-Two</LI>
<UL>
<LI>1.2.1 Subsubsection One-Two-One
</LI><LI>1.2.2 Subsubsection One-Two-Two
</LI><LI>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp; <STRONG>
&lt;== Current Position </STRONG>
</LI><LI>1.2.4 Subsubsection One-Two-Four
</LI></UL>
<LI>1.3 Subsection One-Three</LI>
<UL>
<LI> ... </LI>
</UL>
<LI>1.4 Subsection One-Four</LI>
</UL>
</UL>

<HR SIZE=1>
<BR>  
<FONT SIZE="-1">
This document was generated
by <I>Frederic Bois</I> on <I>January, 11  2009</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>
</FONT>

</BODY>
</HTML>
